
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>cpystal.analysis.thermal_conduction &#8212; cpystal  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/alabaster.css" />
    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
   
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <h1>Source code for cpystal.analysis.thermal_conduction</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;`cpystal.analysis.thermal_conduction` is a module for the analysis of thermal conduction.</span>

<span class="sd">Functions:</span>
<span class="sd">    `cal_Debye_specific_heat`</span>
<span class="sd">    `cal_thermal_conductivity`</span>
<span class="sd">    `cal_dTx`</span>
<span class="sd">    `cal_kxx`</span>

<span class="sd">Classes:</span>
<span class="sd">    `RawDataExpander`</span>
<span class="sd">    `ExpDataExpander`</span>
<span class="sd">    `ExpDataExpanderSeebeck`</span>
<span class="sd">    `RemakeExpFromRaw`</span>
<span class="sd">    `RemakeExpFromRawSeebeck`</span>
<span class="sd">    `AATTPMD`</span>
<span class="sd">    `HistoryOfTTM`</span>
<span class="sd">    `ThermalDiffusionSimulation`</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">annotations</span>

<span class="kn">from</span> <span class="nn">bisect</span> <span class="kn">import</span> <span class="n">bisect_left</span>
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">import</span> <span class="nn">glob</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Any</span>

<span class="kn">from</span> <span class="nn">matplotlib.backends.backend_tkagg</span> <span class="kn">import</span> <span class="n">FigureCanvasTkAgg</span><span class="p">,</span> <span class="n">NavigationToolbar2Tk</span> <span class="c1"># type: ignore</span>
<span class="kn">import</span> <span class="nn">matplotlib.animation</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span> <span class="c1"># type: ignore</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">numpy.typing</span> <span class="k">as</span> <span class="nn">npt</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">integrate</span><span class="p">,</span> <span class="n">optimize</span> <span class="c1"># type: ignore</span>
<span class="kn">import</span> <span class="nn">tkinter</span> <span class="k">as</span> <span class="nn">tk</span>
<span class="kn">import</span> <span class="nn">tqdm</span>

<span class="kn">from</span> <span class="nn">..core</span> <span class="kn">import</span> <span class="n">Crystal</span><span class="p">,</span> <span class="n">PhysicalConstant</span>


<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">14</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.family&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Arial&#39;</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;xtick.direction&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;in&#39;</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;ytick.direction&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;in&#39;</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;legend.framealpha&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>


<div class="viewcode-block" id="cal_Debye_specific_heat"><a class="viewcode-back" href="../../../cpystal.analysis.html#cpystal.analysis.thermal_conduction.cal_Debye_specific_heat">[docs]</a><span class="k">def</span> <span class="nf">cal_Debye_specific_heat</span><span class="p">(</span><span class="n">T</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">TD</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">num_atom_per_formula_unit</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculating Debye mol specific heat.</span>

<span class="sd">    Args:</span>
<span class="sd">        T (float): Temperature (K).</span>
<span class="sd">        TD (float): Debye temperature (K).</span>
<span class="sd">        num_atom_per_formula_unit (int): Number of atom in a formula unit.</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">        (float): Debye mol specific heat (JK^-1mol^-1).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">fD</span><span class="p">(</span><span class="n">t</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="k">def</span> <span class="nf">integrand</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
            <span class="k">return</span> <span class="mf">0.</span> <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="mf">0.</span> <span class="k">else</span> <span class="n">x</span><span class="o">**</span><span class="mi">4</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sinh</span><span class="p">(</span><span class="n">x</span><span class="o">/</span><span class="mf">2.</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
        <span class="k">return</span> <span class="mf">0.</span> <span class="k">if</span> <span class="n">t</span> <span class="o">==</span> <span class="mf">0.</span> <span class="k">else</span> <span class="p">(</span><span class="mi">3</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span> <span class="o">*</span> <span class="n">t</span><span class="o">**</span><span class="mi">3</span> <span class="o">*</span> <span class="n">integrate</span><span class="o">.</span><span class="n">quad</span><span class="p">(</span><span class="n">integrand</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">1.</span><span class="o">/</span><span class="n">t</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">R</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">PhysicalConstant</span><span class="p">()</span><span class="o">.</span><span class="n">R</span> <span class="c1"># 気体定数 [JK^-1mol^-1]</span>
    <span class="k">return</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">R</span> <span class="o">*</span> <span class="n">num_atom_per_formula_unit</span> <span class="o">*</span> <span class="n">fD</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">TD</span><span class="p">)</span></div>

<div class="viewcode-block" id="cal_thermal_conductivity"><a class="viewcode-back" href="../../../cpystal.analysis.html#cpystal.analysis.thermal_conduction.cal_thermal_conductivity">[docs]</a><span class="k">def</span> <span class="nf">cal_thermal_conductivity</span><span class="p">(</span><span class="n">material</span><span class="p">:</span> <span class="n">Crystal</span><span class="p">,</span> <span class="n">T</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">TD</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">l</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculating thermal conductivity of phonon based on Debye model.</span>

<span class="sd">    Args:</span>
<span class="sd">        material (Crystal): Crystal instance.</span>
<span class="sd">        T (float): Temperature (K).</span>
<span class="sd">        TD (float): Debye temperature (K).</span>
<span class="sd">        l (float): Mean free path (cm).</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">        (float): Thermal conductivity of phonon based on Debye model (WK^-1m^-1).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">n</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">material</span><span class="o">.</span><span class="n">num_atom_per_formula_unit</span>
    <span class="n">v</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">material</span><span class="o">.</span><span class="n">cal_phonon_velocity</span><span class="p">(</span><span class="n">TD</span><span class="p">)</span> <span class="c1"># cm/s</span>
    <span class="n">C_mol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">cal_Debye_specific_heat</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">TD</span><span class="o">=</span><span class="n">TD</span><span class="p">,</span> <span class="n">num_atom_per_formula_unit</span><span class="o">=</span><span class="n">n</span><span class="p">)</span> <span class="c1"># J/K/mol</span>
    <span class="n">c</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">C_mol</span> <span class="o">*</span> <span class="n">n</span> <span class="o">/</span> <span class="p">(</span><span class="n">material</span><span class="o">.</span><span class="n">V</span> <span class="o">*</span> <span class="n">material</span><span class="o">.</span><span class="n">NA</span> <span class="o">/</span> <span class="n">material</span><span class="o">.</span><span class="n">fu_per_unit_cell</span><span class="p">)</span> <span class="c1"># J/K/cm^3</span>
    <span class="k">return</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3</span> <span class="o">*</span> <span class="n">c</span> <span class="o">*</span> <span class="n">v</span> <span class="o">*</span> <span class="n">l</span> <span class="o">*</span> <span class="mf">100.</span> <span class="c1"># W/Km</span></div>

<div class="viewcode-block" id="cal_dTx"><a class="viewcode-back" href="../../../cpystal.analysis.html#cpystal.analysis.thermal_conduction.cal_dTx">[docs]</a><span class="k">def</span> <span class="nf">cal_dTx</span><span class="p">(</span>
        <span class="n">Q</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">lx</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">w</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">t</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">kxx</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculating temperature difference due to heat current.</span>

<span class="sd">    Note:</span>
<span class="sd">        dTx = (Q/wt) * (lx/kxx)</span>

<span class="sd">    Args:</span>
<span class="sd">        Q (float): Heater power (mW).</span>
<span class="sd">        lx (float): Length between thermocouples (um).</span>
<span class="sd">        w (float): Width of the sample (um).</span>
<span class="sd">        t (float): Thickness of the sample (um).</span>
<span class="sd">        kxx (float): Thermal conductivity (W/Km).</span>

<span class="sd">    Returns:</span>
<span class="sd">        (float): dTx (K).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">Q</span> <span class="o">/</span> <span class="p">(</span><span class="n">w</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">*</span> <span class="n">lx</span> <span class="o">/</span> <span class="n">kxx</span> <span class="o">*</span> <span class="mf">1000.0</span></div>

<div class="viewcode-block" id="cal_kxx"><a class="viewcode-back" href="../../../cpystal.analysis.html#cpystal.analysis.thermal_conduction.cal_kxx">[docs]</a><span class="k">def</span> <span class="nf">cal_kxx</span><span class="p">(</span>
        <span class="n">Q</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">lx</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">w</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">t</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">dTx</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculating temperature difference due to heat current.</span>

<span class="sd">    Note:</span>
<span class="sd">        dTx = (Q/wt) * (lx/kxx)</span>

<span class="sd">    Args:</span>
<span class="sd">        Q (float): Heater power (mW).</span>
<span class="sd">        lx (float): Length between thermocouples (um).</span>
<span class="sd">        w (float): Width of the sample (um).</span>
<span class="sd">        t (float): Thickness of the sample (um).</span>
<span class="sd">        dTx (float): dTx (K).</span>

<span class="sd">    Returns:</span>
<span class="sd">        (float): Thermal conductivity (W/Km).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">Q</span> <span class="o">/</span> <span class="p">(</span><span class="n">w</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">*</span> <span class="n">lx</span> <span class="o">/</span> <span class="n">dTx</span> <span class="o">*</span> <span class="mf">1000.0</span></div>


<div class="viewcode-block" id="RawDataExpander"><a class="viewcode-back" href="../../../cpystal.analysis.html#cpystal.analysis.thermal_conduction.RawDataExpander">[docs]</a><span class="k">class</span> <span class="nc">RawDataExpander</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;This is a class for extending thermal properties data measured by Labview-controlled PPMS. </span>
<span class="sd">    </span>
<span class="sd">    Attributes:</span>
<span class="sd">        filename (str): Input file name of data (if necessary, add file path to the head). The suffix of `filename` may be &quot;.txt&quot;.</span>
<span class="sd">        full_contents (list[str]): Full contents of the loaded file splitted into lines.</span>
<span class="sd">        names (list[str]): All the name of experiments.</span>
<span class="sd">        Time (list[float]): Time when the measurement is conducted (sec).</span>
<span class="sd">        PPMSTemp (list[float]): PPMS temperature (K).</span>
<span class="sd">        Field (list[float]): Magnetic field (Oe).</span>
<span class="sd">        HeaterCurrent (list[float]): Heater current (mA).</span>
<span class="sd">        Q (list[float]): Heater power (mW).</span>
<span class="sd">        Angle (list[float]): Angle (degree).</span>
<span class="sd">        V1 (list[list[float]]): Ch1 complex voltage [Re, Im] (V), otherwise Cernox temperature and resistivity [T (K), R (Ohm)]</span>
<span class="sd">        V2 (list[list[float]]): Ch2 complex voltage [Re, Im] (V).</span>
<span class="sd">        V3 (list[list[float]]): Ch3 complex voltage [Re, Im] (V).</span>
<span class="sd">        V4 (list[list[float]]): Ch4 complex voltage [Re, Im] (V).</span>
<span class="sd">        V5 (list[list[float]]): Ch5 complex voltage [Re, Im] (V).</span>
<span class="sd">        V6 (list[list[float]]): Ch6 complex voltage [Re, Im] (V).</span>
<span class="sd">        CernoxTemp (list[float]): Cernox temperature (K). By default, calculated from V1.</span>
<span class="sd">        TC_TS (list[list[float]]): list of temperature dependence of thermocouple seebeck coefficient, [temperature (K), S (V/K)].</span>
<span class="sd">        S_TC (list[float]): Seebeck coefficient (V/K).</span>
<span class="sd">        dTx (list[float]): Temperature differnce of x-direction (K). By default, calculated from V2.</span>
<span class="sd">        dTy (list[float]): Temperature differnce of y-direction (K), By default, calculated from V3.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">filename_Seebeck</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initializer of this class.</span>

<span class="sd">        Args:</span>
<span class="sd">            filename (str): Input file name of data (if necessary, add file path to the head). The suffix of `filename` may be &quot;.txt&quot;.</span>
<span class="sd">            filename_Seebeck (str): Input file name of thermocouple S vs T data (if necessary, add file path to the head). The suffix of `filename` may be &quot;.txt&quot;.</span>

<span class="sd">        Note:</span>
<span class="sd">            Raw data format example:</span>
<span class="sd">            &#39;&#39;&#39;</span>
<span class="sd">            Start time: yyyy/mm/dd hh:mm:ss</span>
<span class="sd">            Sample Parameter:</span>
<span class="sd">            Length (um) of Tx:  2200.000000</span>
<span class="sd">            Length (um) of Ty:   701.000000</span>
<span class="sd">            Length (um) of Vx:   0.000000</span>
<span class="sd">            Length (um) of Vy:   0.000000</span>
<span class="sd">            Sample Width (um):   701.000000</span>
<span class="sd">            Sample Thickness (um):   82.500000</span>
<span class="sd">            Index	Time (s)	PPMS Temperature (K)	Field (Oe)	Angle (deg)	Heater Current (mA)	Ch1 Vx (V)[or Cernox Temperature (K)]	Ch1 Vy (V)[or Cernox Resistance (K)]	Ch2 Vx (V)	Ch2 Vy (V)	Ch3 Vx (V)	Ch3 Vx (V)	Ch4 Vx (V)	Ch4 Vx (V)	Ch5 Vx (V)	Ch5 Vy (V)	Ch6 Vx (V)	Ch6 Vy (V)	</span>
<span class="sd">            0.0000000000E+0	1.2200832367E-2	1.2499940000E+1	-6.6000000000E-2	0.0000000000E+0	0.0000000000E+0	1.2613500000E+1	-2.6852900000E+2	1.8073239800E-6	1.8073239800E-6	1.3243287300E-6	1.3243287300E-6	0.0000000000E+0	0.0000000000E+0	0.0000000000E+0	0.0000000000E+0	0.0000000000E+0	0.0000000000E+0	</span>
<span class="sd">            ...</span>
<span class="sd">            &#39;&#39;&#39;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">filename</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_operated_filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">filename</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">filename_Seebeck</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">filename_Seebeck</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">full_contents</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">TC_TS</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="n">filename_Seebeck</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()[</span><span class="mi">1</span><span class="p">:]:</span>
                <span class="n">s</span><span class="p">,</span><span class="n">t</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TC_TS</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">t</span><span class="p">,</span><span class="n">s</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">TC_TS</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TC_TS</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># 温度順にソート</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">header_length</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">15</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">StartTime</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;[^\d]+?:&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_contents</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span> <span class="s1">&#39;%Y/%m/</span><span class="si">%d</span><span class="s1"> %H:%M:%S&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">LTx</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;.+:&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_contents</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">LTy</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;.+:&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_contents</span><span class="p">[</span><span class="mi">3</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">LVx</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;.+:&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_contents</span><span class="p">[</span><span class="mi">4</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">LVy</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;.+:&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_contents</span><span class="p">[</span><span class="mi">5</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Width</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;.+:&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_contents</span><span class="p">[</span><span class="mi">6</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Thickness</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;.+:&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_contents</span><span class="p">[</span><span class="mi">7</span><span class="p">]))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">Time</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PPMSTemp</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Field</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Angle</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">HeaterCurrent</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">V1</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">V2</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">V3</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">V4</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">V5</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">V6</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Q</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1000.</span>

        <span class="n">idx</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">header_length</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">row</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_contents</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
                <span class="n">ind</span><span class="p">,</span> <span class="n">ti</span><span class="p">,</span> <span class="n">temp</span><span class="p">,</span> <span class="n">field</span><span class="p">,</span> <span class="n">angle</span><span class="p">,</span> <span class="n">cur</span><span class="p">,</span> <span class="o">*</span><span class="n">values</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="n">row</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
                <span class="n">v1re</span><span class="p">,</span> <span class="n">v1im</span><span class="p">,</span> <span class="n">v2re</span><span class="p">,</span> <span class="n">v2im</span><span class="p">,</span> <span class="n">v3re</span><span class="p">,</span> <span class="n">v3im</span><span class="p">,</span> <span class="n">v4re</span><span class="p">,</span> <span class="n">v4im</span><span class="p">,</span> <span class="n">v5re</span><span class="p">,</span> <span class="n">v5im</span><span class="p">,</span> <span class="n">v6re</span><span class="p">,</span> <span class="n">v6im</span> <span class="o">=</span> <span class="n">values</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="n">idx</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Time</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ti</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">PPMSTemp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Field</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">field</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Angle</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">HeaterCurrent</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cur</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Q</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="o">*</span><span class="n">cur</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mf">1000.</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">V1</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">v1re</span><span class="p">,</span><span class="n">v1im</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">V2</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">v2re</span><span class="p">,</span><span class="n">v2im</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">V3</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">v3re</span><span class="p">,</span><span class="n">v3im</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">V4</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">v4re</span><span class="p">,</span><span class="n">v4im</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">V5</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">v5re</span><span class="p">,</span><span class="n">v5im</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">V6</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">v6re</span><span class="p">,</span><span class="n">v6im</span><span class="p">])</span>        

        <span class="bp">self</span><span class="o">.</span><span class="n">S_TC</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">t</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PPMSTemp</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">Seebeck_at_T</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">S_TC</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Seebeck_at_T</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">PPMSTemp</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">PPMSTemp</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">S_TC</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Seebeck_at_T</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
    
<div class="viewcode-block" id="RawDataExpander.check_same_condition"><a class="viewcode-back" href="../../../cpystal.analysis.html#cpystal.analysis.thermal_conduction.RawDataExpander.check_same_condition">[docs]</a>    <span class="k">def</span> <span class="nf">check_same_condition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">RawDataExpander</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">LTx</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">LTx</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">LTy</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">LTy</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">LVx</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">LVx</span> <span class="ow">and</span> \
            <span class="bp">self</span><span class="o">.</span><span class="n">LVy</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">LVy</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">Width</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">Width</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">Thickness</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">Thickness</span> <span class="ow">and</span> \
                <span class="bp">self</span><span class="o">.</span><span class="n">cernox_name</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">cernox_name</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">attr_cor_to_V</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">attr_cor_to_V</span></div>
    
    <span class="k">def</span> <span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">RawDataExpander</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">RawDataExpander</span><span class="p">:</span>
        <span class="n">new</span><span class="p">:</span> <span class="n">RawDataExpander</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">filename_Seebeck</span><span class="p">)</span>
        <span class="n">new</span><span class="o">.</span><span class="n">kxxkxy_mode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cernox_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">attr_cor_to_V</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_same_condition</span><span class="p">(</span><span class="n">other</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">StartTime</span> <span class="o">&lt;</span> <span class="n">other</span><span class="o">.</span><span class="n">StartTime</span><span class="p">:</span>
                <span class="n">new</span><span class="o">.</span><span class="n">_operated_filename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="o">+</span> <span class="n">other</span><span class="o">.</span><span class="n">filename</span>
                <span class="n">new</span><span class="o">.</span><span class="n">Time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Time</span> <span class="o">+</span> <span class="p">[</span><span class="n">t</span> <span class="o">+</span> <span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">StartTime</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">StartTime</span><span class="p">)</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">()</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">other</span><span class="o">.</span><span class="n">Time</span><span class="p">]</span>
                <span class="n">new</span><span class="o">.</span><span class="n">PPMSTemp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">PPMSTemp</span> <span class="o">+</span> <span class="n">other</span><span class="o">.</span><span class="n">PPMSTemp</span>
                <span class="n">new</span><span class="o">.</span><span class="n">Field</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Field</span> <span class="o">+</span> <span class="n">other</span><span class="o">.</span><span class="n">Field</span>
                <span class="n">new</span><span class="o">.</span><span class="n">Angle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Angle</span> <span class="o">+</span> <span class="n">other</span><span class="o">.</span><span class="n">Angle</span>
                <span class="n">new</span><span class="o">.</span><span class="n">HeaterCurrent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">HeaterCurrent</span> <span class="o">+</span> <span class="n">other</span><span class="o">.</span><span class="n">HeaterCurrent</span>
                <span class="n">new</span><span class="o">.</span><span class="n">CernoxTemp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CernoxTemp</span> <span class="o">+</span> <span class="n">other</span><span class="o">.</span><span class="n">CernoxTemp</span>
                <span class="n">new</span><span class="o">.</span><span class="n">V1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">V1</span> <span class="o">+</span> <span class="n">other</span><span class="o">.</span><span class="n">V1</span>
                <span class="n">new</span><span class="o">.</span><span class="n">V2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">V2</span> <span class="o">+</span> <span class="n">other</span><span class="o">.</span><span class="n">V2</span>
                <span class="n">new</span><span class="o">.</span><span class="n">V3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">V3</span> <span class="o">+</span> <span class="n">other</span><span class="o">.</span><span class="n">V3</span>
                <span class="n">new</span><span class="o">.</span><span class="n">V4</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">V4</span> <span class="o">+</span> <span class="n">other</span><span class="o">.</span><span class="n">V4</span>
                <span class="n">new</span><span class="o">.</span><span class="n">V5</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">V5</span> <span class="o">+</span> <span class="n">other</span><span class="o">.</span><span class="n">V5</span>
                <span class="n">new</span><span class="o">.</span><span class="n">V6</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">V6</span> <span class="o">+</span> <span class="n">other</span><span class="o">.</span><span class="n">V6</span>
                <span class="n">new</span><span class="o">.</span><span class="n">Q</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Q</span> <span class="o">+</span> <span class="n">other</span><span class="o">.</span><span class="n">Q</span>
                <span class="n">new</span><span class="o">.</span><span class="n">S_TC</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">S_TC</span> <span class="o">+</span> <span class="n">other</span><span class="o">.</span><span class="n">S_TC</span>
                <span class="n">new</span><span class="o">.</span><span class="n">dTx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dTx</span> <span class="o">+</span> <span class="n">other</span><span class="o">.</span><span class="n">dTx</span>
                <span class="n">new</span><span class="o">.</span><span class="n">dTy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dTy</span> <span class="o">+</span> <span class="n">other</span><span class="o">.</span><span class="n">dTy</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">new</span><span class="o">.</span><span class="n">_operated_filename</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">filename</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">filename</span>
                <span class="n">new</span><span class="o">.</span><span class="n">Time</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">Time</span> <span class="o">+</span> <span class="p">[</span><span class="n">t</span> <span class="o">+</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">StartTime</span><span class="o">-</span><span class="n">other</span><span class="o">.</span><span class="n">StartTime</span><span class="p">)</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">()</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Time</span><span class="p">]</span>
                <span class="n">new</span><span class="o">.</span><span class="n">PPMSTemp</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">PPMSTemp</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">PPMSTemp</span>
                <span class="n">new</span><span class="o">.</span><span class="n">Field</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">Field</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">Field</span>
                <span class="n">new</span><span class="o">.</span><span class="n">Angle</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">Angle</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">Angle</span>
                <span class="n">new</span><span class="o">.</span><span class="n">HeaterCurrent</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">HeaterCurrent</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">HeaterCurrent</span>
                <span class="n">new</span><span class="o">.</span><span class="n">CernoxTemp</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">CernoxTemp</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">CernoxTemp</span>
                <span class="n">new</span><span class="o">.</span><span class="n">V1</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">V1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">V1</span>
                <span class="n">new</span><span class="o">.</span><span class="n">V2</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">V2</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">V2</span>
                <span class="n">new</span><span class="o">.</span><span class="n">V3</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">V3</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">V3</span>
                <span class="n">new</span><span class="o">.</span><span class="n">V4</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">V4</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">V4</span>
                <span class="n">new</span><span class="o">.</span><span class="n">V5</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">V5</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">V5</span>
                <span class="n">new</span><span class="o">.</span><span class="n">V6</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">V6</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">V6</span>
                <span class="n">new</span><span class="o">.</span><span class="n">Q</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">Q</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">Q</span>
                <span class="n">new</span><span class="o">.</span><span class="n">S_TC</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">S_TC</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">S_TC</span>
                <span class="n">new</span><span class="o">.</span><span class="n">dTx</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">dTx</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">dTx</span>
                <span class="n">new</span><span class="o">.</span><span class="n">dTy</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">dTy</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">dTy</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">LTx</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">LTx</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">LTy</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">LTy</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">LVx</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">LVx</span><span class="p">,</span> \
            <span class="bp">self</span><span class="o">.</span><span class="n">LVy</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">LVy</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Width</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">Width</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Thickness</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">Thickness</span><span class="p">,</span> \
                <span class="bp">self</span><span class="o">.</span><span class="n">cernox_name</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">cernox_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">attr_cor_to_V</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">attr_cor_to_V</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">new</span>
    
    <span class="k">def</span> <span class="nf">_set_CernoxTemp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cernox_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">TR</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">X173409_logRlogT_table</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[(</span><span class="mf">3.29314</span> <span class="o">-</span> <span class="mf">1.42456</span><span class="o">*</span><span class="n">log10t</span> <span class="o">+</span> <span class="mf">0.867728</span><span class="o">*</span><span class="n">log10t</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mf">0.324371</span><span class="o">*</span><span class="n">log10t</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="mf">0.0380185</span><span class="o">*</span><span class="n">log10t</span><span class="o">**</span><span class="mi">4</span><span class="p">,</span> <span class="n">log10t</span><span class="p">)</span> <span class="k">for</span> <span class="n">log10t</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="mf">1.5</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="mi">320</span><span class="p">),</span><span class="mi">100000</span><span class="p">)]</span>
        <span class="n">X173079_logRlogT_table</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[(</span><span class="mf">3.29639174</span> <span class="o">-</span> <span class="mf">1.34578352</span><span class="o">*</span><span class="n">log10t</span> <span class="o">+</span> <span class="mf">0.79354379</span><span class="o">*</span><span class="n">log10t</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mf">0.29893059</span><span class="o">*</span><span class="n">log10t</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="mf">0.03486926</span><span class="o">*</span><span class="n">log10t</span><span class="o">**</span><span class="mi">4</span><span class="p">,</span> <span class="n">log10t</span><span class="p">)</span> <span class="k">for</span> <span class="n">log10t</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="mf">1.5</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="mi">320</span><span class="p">),</span><span class="mi">100000</span><span class="p">)]</span>

        <span class="k">def</span> <span class="nf">binary_search_X173409</span><span class="p">(</span><span class="n">target</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
            <span class="n">log_target</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>
            <span class="n">ok</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">ng</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">X173409_logRlogT_table</span><span class="p">)</span>
            <span class="k">while</span> <span class="nb">abs</span><span class="p">(</span><span class="n">ok</span><span class="o">-</span><span class="n">ng</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">ng</span><span class="o">+</span><span class="n">ok</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span>
                <span class="k">if</span> <span class="n">X173409_logRlogT_table</span><span class="p">[</span><span class="n">mid</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">log_target</span><span class="p">:</span>
                    <span class="n">ok</span> <span class="o">=</span> <span class="n">mid</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">ng</span> <span class="o">=</span> <span class="n">mid</span>
            <span class="k">if</span> <span class="n">ok</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">X173409_logRlogT_table</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">ok</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">X173409_logRlogT_table</span><span class="p">)</span><span class="o">-</span><span class="mi">2</span>
            <span class="n">logT</span> <span class="o">=</span> <span class="n">X173409_logRlogT_table</span><span class="p">[</span><span class="n">ok</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">X173409_logRlogT_table</span><span class="p">[</span><span class="n">ok</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">X173409_logRlogT_table</span><span class="p">[</span><span class="n">ok</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="n">X173409_logRlogT_table</span><span class="p">[</span><span class="n">ok</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">X173409_logRlogT_table</span><span class="p">[</span><span class="n">ok</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="p">(</span><span class="n">log_target</span><span class="o">-</span><span class="n">X173409_logRlogT_table</span><span class="p">[</span><span class="n">ok</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">return</span> <span class="mi">10</span><span class="o">**</span><span class="n">logT</span>
        <span class="k">def</span> <span class="nf">binary_search_X173079</span><span class="p">(</span><span class="n">target</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
            <span class="n">log_target</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>
            <span class="n">ok</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">ng</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">X173079_logRlogT_table</span><span class="p">)</span>
            <span class="k">while</span> <span class="nb">abs</span><span class="p">(</span><span class="n">ok</span><span class="o">-</span><span class="n">ng</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">ng</span><span class="o">+</span><span class="n">ok</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span>
                <span class="k">if</span> <span class="n">X173079_logRlogT_table</span><span class="p">[</span><span class="n">mid</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">log_target</span><span class="p">:</span>
                    <span class="n">ok</span> <span class="o">=</span> <span class="n">mid</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">ng</span> <span class="o">=</span> <span class="n">mid</span>
            <span class="k">if</span> <span class="n">ok</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">X173079_logRlogT_table</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">ok</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">X173079_logRlogT_table</span><span class="p">)</span><span class="o">-</span><span class="mi">2</span>
            <span class="n">logT</span> <span class="o">=</span> <span class="n">X173079_logRlogT_table</span><span class="p">[</span><span class="n">ok</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">X173079_logRlogT_table</span><span class="p">[</span><span class="n">ok</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">X173079_logRlogT_table</span><span class="p">[</span><span class="n">ok</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="n">X173079_logRlogT_table</span><span class="p">[</span><span class="n">ok</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">X173079_logRlogT_table</span><span class="p">[</span><span class="n">ok</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="p">(</span><span class="n">log_target</span><span class="o">-</span><span class="n">X173079_logRlogT_table</span><span class="p">[</span><span class="n">ok</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">return</span> <span class="mi">10</span><span class="o">**</span><span class="n">logT</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">CernoxTemp</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">cernox_name</span> <span class="o">==</span> <span class="s2">&quot;X173409&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">CernoxTemp</span> <span class="o">=</span> <span class="p">[</span><span class="n">binary_search_X173409</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">resis</span><span class="p">))</span> <span class="k">for</span> <span class="n">temp</span><span class="p">,</span> <span class="n">resis</span> <span class="ow">in</span> <span class="n">TR</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">cernox_name</span> <span class="o">==</span> <span class="s2">&quot;X173079&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">CernoxTemp</span> <span class="o">=</span> <span class="p">[</span><span class="n">binary_search_X173079</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">resis</span><span class="p">))</span> <span class="k">for</span> <span class="n">temp</span><span class="p">,</span> <span class="n">resis</span> <span class="ow">in</span> <span class="n">TR</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;cernox name is invalid.&quot;</span><span class="p">)</span>

<div class="viewcode-block" id="RawDataExpander.kxxkxy_mode"><a class="viewcode-back" href="../../../cpystal.analysis.html#cpystal.analysis.thermal_conduction.RawDataExpander.kxxkxy_mode">[docs]</a>    <span class="k">def</span> <span class="nf">kxxkxy_mode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cernox_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;X173409&quot;</span><span class="p">,</span> <span class="n">attr_cor_to_V</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            cernox_name (str): Cernox name. (&quot;X173409&quot; or &quot;X173079&quot;)</span>
<span class="sd">            attr_cor_to_V (list[int] | None): Correspondence between attributes [Cernox_Temp, dTx, dTy] and 0-indexed voltage number. Defaults to [0,1,2].</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">attr_cor_to_V</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">attr_cor_to_V</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
        <span class="n">Voltages</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">V1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">V2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">V3</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">V4</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">V5</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">V6</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cernox_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">cernox_name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">attr_cor_to_V</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">attr_cor_to_V</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_CernoxTemp</span><span class="p">(</span><span class="n">cernox_name</span><span class="p">,</span> <span class="n">Voltages</span><span class="p">[</span><span class="n">attr_cor_to_V</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dTx</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span><span class="o">/</span><span class="n">s</span> <span class="k">for</span> <span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">_</span><span class="p">),</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">Voltages</span><span class="p">[</span><span class="n">attr_cor_to_V</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="bp">self</span><span class="o">.</span><span class="n">S_TC</span><span class="p">)]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dTy</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span><span class="o">/</span><span class="n">s</span> <span class="k">for</span> <span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">_</span><span class="p">),</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">Voltages</span><span class="p">[</span><span class="n">attr_cor_to_V</span><span class="p">[</span><span class="mi">2</span><span class="p">]],</span> <span class="bp">self</span><span class="o">.</span><span class="n">S_TC</span><span class="p">)]</span></div>

<div class="viewcode-block" id="RawDataExpander.SxxSxy_mode"><a class="viewcode-back" href="../../../cpystal.analysis.html#cpystal.analysis.thermal_conduction.RawDataExpander.SxxSxy_mode">[docs]</a>    <span class="k">def</span> <span class="nf">SxxSxy_mode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cernox_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;X173409&quot;</span><span class="p">,</span> <span class="n">attr_cor_to_V</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            cernox_name (str): Cernox name. (&quot;X173409&quot; or &quot;X173079&quot;)</span>
<span class="sd">            attr_cor_to_V (list[int] | None): Correspondence between attributes [Cernox_Temp, dTx, dVx, dVy] and 1-indexed voltage number. Defaults to [1,2,3,4].</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">attr_cor_to_V</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">attr_cor_to_V</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">attr_cor_to_V</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">attr_cor_to_V</span><span class="p">]</span>
        <span class="n">Voltages</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">V1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">V2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">V3</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">V4</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">V5</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">V6</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cernox_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">cernox_name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">attr_cor_to_V</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">attr_cor_to_V</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_CernoxTemp</span><span class="p">(</span><span class="n">cernox_name</span><span class="p">,</span> <span class="n">Voltages</span><span class="p">[</span><span class="n">attr_cor_to_V</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dTx</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span><span class="o">/</span><span class="n">s</span> <span class="k">for</span> <span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">_</span><span class="p">),</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">Voltages</span><span class="p">[</span><span class="n">attr_cor_to_V</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="bp">self</span><span class="o">.</span><span class="n">S_TC</span><span class="p">)]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dVx</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span> <span class="k">for</span> <span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">_</span><span class="p">)</span> <span class="ow">in</span> <span class="n">Voltages</span><span class="p">[</span><span class="n">attr_cor_to_V</span><span class="p">[</span><span class="mi">2</span><span class="p">]]]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dVy</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span> <span class="k">for</span> <span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">_</span><span class="p">)</span> <span class="ow">in</span> <span class="n">Voltages</span><span class="p">[</span><span class="n">attr_cor_to_V</span><span class="p">[</span><span class="mi">3</span><span class="p">]]]</span></div>

<div class="viewcode-block" id="RawDataExpander.Seebeck_at_T"><a class="viewcode-back" href="../../../cpystal.analysis.html#cpystal.analysis.thermal_conduction.RawDataExpander.Seebeck_at_T">[docs]</a>    <span class="k">def</span> <span class="nf">Seebeck_at_T</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TC_TS</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">T</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">TC_TS</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]):</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="n">S_at_T</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TC_TS</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">TC_TS</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">T</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">TC_TS</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span>
                <span class="n">S_at_T</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">TC_TS</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TC_TS</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">TC_TS</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TC_TS</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">TC_TS</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="p">(</span><span class="n">T</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">TC_TS</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                <span class="k">break</span>
        <span class="k">if</span> <span class="n">S_at_T</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span>
        <span class="k">return</span> <span class="n">S_at_T</span></div>

<div class="viewcode-block" id="RawDataExpander.graph_CenoxTemp_vs_Time"><a class="viewcode-back" href="../../../cpystal.analysis.html#cpystal.analysis.thermal_conduction.RawDataExpander.graph_CenoxTemp_vs_Time">[docs]</a>    <span class="k">def</span> <span class="nf">graph_CenoxTemp_vs_Time</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">title</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">14</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.family&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Arial&#39;</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;xtick.direction&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;in&#39;</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;ytick.direction&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;in&#39;</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;legend.framealpha&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;legend.fontsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">8</span>

        <span class="n">figsize</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
        <span class="n">fig</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">Figure</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">wspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

        <span class="n">ax</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">Subplot</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Time</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">CernoxTemp</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;Time (sec)&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;Cernox Temperature (K)&quot;</span><span class="p">)</span>
        <span class="c1">#ax.legend()</span>
        <span class="c1">#ax.set_xlim((0,max(self.PPMSTemp)))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>

<div class="viewcode-block" id="RawDataExpander.graph_PPMSTemp_hist"><a class="viewcode-back" href="../../../cpystal.analysis.html#cpystal.analysis.thermal_conduction.RawDataExpander.graph_PPMSTemp_hist">[docs]</a>    <span class="k">def</span> <span class="nf">graph_PPMSTemp_hist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time1</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">time2</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">bins</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">14</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.family&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Arial&#39;</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;xtick.direction&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;in&#39;</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;ytick.direction&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;in&#39;</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;legend.framealpha&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;legend.fontsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">8</span>

        <span class="n">figsize</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
        <span class="n">fig</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">Figure</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">wspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

        <span class="n">ax</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">Subplot</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">get_xaxis</span><span class="p">()</span><span class="o">.</span><span class="n">get_major_formatter</span><span class="p">()</span><span class="o">.</span><span class="n">set_useOffset</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">idx1</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">bisect_left</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Time</span><span class="p">,</span> <span class="n">time1</span><span class="p">)</span>
        <span class="n">idx2</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">bisect_left</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Time</span><span class="p">,</span> <span class="n">time2</span><span class="p">)</span>
        <span class="n">offset</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">CernoxTemp</span><span class="p">[</span><span class="n">idx1</span><span class="p">:</span><span class="n">idx2</span><span class="p">])</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">CernoxTemp</span><span class="p">[</span><span class="n">idx1</span><span class="p">:</span><span class="n">idx2</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">([</span><span class="n">val</span><span class="o">-</span><span class="n">offset</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">CernoxTemp</span><span class="p">[</span><span class="n">idx1</span><span class="p">:</span><span class="n">idx2</span><span class="p">]],</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;orange&quot;</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">clip_on</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">rwidth</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;Cernox Temperature (K)&quot;</span><span class="p">)</span>
        <span class="c1">#ax.legend()</span>
        <span class="c1">#ax.set_xlim((0,max(self.PPMSTemp)))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">fr</span><span class="s2">&quot;t = </span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Time</span><span class="p">[</span><span class="n">idx1</span><span class="p">])</span><span class="si">}</span><span class="s2">s ~ </span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Time</span><span class="p">[</span><span class="n">idx2</span><span class="p">])</span><span class="si">}</span><span class="s2">s (count:</span><span class="si">{</span><span class="n">idx2</span><span class="o">-</span><span class="n">idx1</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">)</span><span class="se">\</span>
<span class="s2">            $T_</span><span class="se">{{</span><span class="s2">ave</span><span class="se">}}</span><span class="s2">=</span><span class="si">{</span><span class="n">offset</span><span class="si">:</span><span class="s2">.6g</span><span class="si">}</span><span class="s2">\pm</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">CernoxTemp</span><span class="p">[</span><span class="n">idx1</span><span class="p">:</span><span class="n">idx2</span><span class="p">])</span><span class="si">:</span><span class="s2">.2g</span><span class="si">}</span><span class="s2">$ K&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.92</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.07</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;+$T_</span><span class="si">{ave}</span><span class="s2">$&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span> <span class="n">transform</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>
    
<div class="viewcode-block" id="RawDataExpander.graph_four_data_all"><a class="viewcode-back" href="../../../cpystal.analysis.html#cpystal.analysis.thermal_conduction.RawDataExpander.graph_four_data_all">[docs]</a>    <span class="k">def</span> <span class="nf">graph_four_data_all</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        0 &lt; t &lt; end での全データを一堂に会する</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">fig</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">Figure</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">wspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

        <span class="n">ax1</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">Subplot</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">411</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
        <span class="n">ax2</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">Subplot</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">412</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
        <span class="n">ax3</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">Subplot</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">413</span><span class="p">)</span>
        <span class="n">ax3</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
        <span class="n">ax3</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
        <span class="n">ax4</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">Subplot</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">414</span><span class="p">)</span>
        <span class="n">ax4</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
        <span class="n">ax4</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>

        <span class="c1">#ax1.plot(self.Time, self.Field, marker=&#39;o&#39;, color=&quot;blue&quot;, markersize=2)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Time</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">CernoxTemp</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;orange&quot;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="c1">#ax1.set_xlabel(xlabel=r&quot;Time (sec)&quot;)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$T_{\mathrm</span><span class="si">{Cernox}</span><span class="s2">}$ (K)&quot;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticklabels</span><span class="p">([])</span> <span class="c1"># 目盛を削除</span>
        
        <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Time</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dTx</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="c1">#ax2.set_xlabel(xlabel=r&quot;Time (sec)&quot;)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$\Delta T_</span><span class="si">{x}</span><span class="s2">$ (K)&quot;</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticklabels</span><span class="p">([])</span> <span class="c1"># 目盛を削除</span>

        <span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Time</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dTy</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="c1">#ax3.set_xlabel(xlabel=r&quot;Time (sec)&quot;)</span>
        <span class="n">ax3</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$\Delta T_</span><span class="si">{y}</span><span class="s2">$ (K)&quot;</span><span class="p">)</span>
        <span class="n">ax3</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticklabels</span><span class="p">([])</span> <span class="c1"># 目盛を削除</span>

        <span class="n">ax4</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Time</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Q</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">ax4</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;Time (sec)&quot;</span><span class="p">)</span>
        <span class="n">ax4</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$Q$ (mW)&quot;</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;./fig/four_data_all.png&quot;</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>     </div>

<div class="viewcode-block" id="RawDataExpander.graph_four_data"><a class="viewcode-back" href="../../../cpystal.analysis.html#cpystal.analysis.thermal_conduction.RawDataExpander.graph_four_data">[docs]</a>    <span class="k">def</span> <span class="nf">graph_four_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t1</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">t2</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        t1 &lt; t &lt; t2 での全データを一堂に会する</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">idx1</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">bisect_left</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Time</span><span class="p">,</span> <span class="n">t1</span><span class="p">)</span>
        <span class="n">idx2</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">bisect_left</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Time</span><span class="p">,</span> <span class="n">t2</span><span class="p">)</span>
        <span class="n">fig</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">Figure</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">wspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

        <span class="n">ax1</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">Subplot</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">411</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
        <span class="n">ax2</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">Subplot</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">412</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
        <span class="n">ax3</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">Subplot</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">413</span><span class="p">)</span>
        <span class="n">ax3</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
        <span class="n">ax3</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
        <span class="n">ax4</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">Subplot</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">414</span><span class="p">)</span>
        <span class="n">ax4</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
        <span class="n">ax4</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>

        <span class="c1">#ax1.plot(self.Time, self.Field, marker=&#39;o&#39;, color=&quot;blue&quot;, markersize=2)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Time</span><span class="p">[</span><span class="n">idx1</span><span class="p">:</span><span class="n">idx2</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">CernoxTemp</span><span class="p">[</span><span class="n">idx1</span><span class="p">:</span><span class="n">idx2</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;orange&quot;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="c1">#ax1.set_xlabel(xlabel=r&quot;Time (sec)&quot;)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$T_{\mathrm</span><span class="si">{Cernox}</span><span class="s2">}$ (K)&quot;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticklabels</span><span class="p">([])</span> <span class="c1"># 目盛を削除</span>
        
        <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Time</span><span class="p">[</span><span class="n">idx1</span><span class="p">:</span><span class="n">idx2</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">dTx</span><span class="p">[</span><span class="n">idx1</span><span class="p">:</span><span class="n">idx2</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="c1">#ax2.set_xlabel(xlabel=r&quot;Time (sec)&quot;)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$\Delta T_</span><span class="si">{x}</span><span class="s2">$ (K)&quot;</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticklabels</span><span class="p">([])</span> <span class="c1"># 目盛を削除</span>

        <span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Time</span><span class="p">[</span><span class="n">idx1</span><span class="p">:</span><span class="n">idx2</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">dTy</span><span class="p">[</span><span class="n">idx1</span><span class="p">:</span><span class="n">idx2</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="c1">#ax3.set_xlabel(xlabel=r&quot;Time (sec)&quot;)</span>
        <span class="n">ax3</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$\Delta T_</span><span class="si">{y}</span><span class="s2">$ (K)&quot;</span><span class="p">)</span>
        <span class="n">ax3</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticklabels</span><span class="p">([])</span> <span class="c1"># 目盛を削除</span>

        <span class="n">ax4</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Time</span><span class="p">[</span><span class="n">idx1</span><span class="p">:</span><span class="n">idx2</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">Q</span><span class="p">[</span><span class="n">idx1</span><span class="p">:</span><span class="n">idx2</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">ax4</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;Time (sec)&quot;</span><span class="p">)</span>
        <span class="n">ax4</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$Q$ (mW)&quot;</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;./fig/four_data_</span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">t1</span><span class="p">)</span><span class="si">}</span><span class="s2">to</span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">t2</span><span class="p">)</span><span class="si">}</span><span class="s2">.png&quot;</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>     </div></div>


<div class="viewcode-block" id="ExpDataExpander"><a class="viewcode-back" href="../../../cpystal.analysis.html#cpystal.analysis.thermal_conduction.ExpDataExpander">[docs]</a><span class="k">class</span> <span class="nc">ExpDataExpander</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">filename_Seebeck</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">filename</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_operated_filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">filename</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">filename_Seebeck</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">filename_Seebeck</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">full_contents</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">TC_TS</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="n">filename_Seebeck</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()[</span><span class="mi">1</span><span class="p">:]:</span>
                <span class="n">s</span><span class="p">,</span><span class="n">t</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TC_TS</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">t</span><span class="p">,</span><span class="n">s</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">TC_TS</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TC_TS</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># 温度順にソート</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">header_length</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">14</span>

        <span class="n">filename_raw</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Exp&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;Raw&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="n">filename_raw</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">len_Index</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">())</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">header_length</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">len_Index</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="mi">9</span><span class="o">+</span><span class="mi">7</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">StartTime</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;[^\d]+?:&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_contents</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span> <span class="s1">&#39;%Y/%m/</span><span class="si">%d</span><span class="s1"> %H:%M:%S&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">LTx</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;.+:&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_contents</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">LTy</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;.+:&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_contents</span><span class="p">[</span><span class="mi">3</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">LVx</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;.+:&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_contents</span><span class="p">[</span><span class="mi">4</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">LVy</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;.+:&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_contents</span><span class="p">[</span><span class="mi">5</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Width</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;.+:&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_contents</span><span class="p">[</span><span class="mi">6</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Thickness</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;.+:&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_contents</span><span class="p">[</span><span class="mi">7</span><span class="p">]))</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">Index</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">T_PPMS</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Field</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Current</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">T_Cernox</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dVx</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dVy</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dTx</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dTy</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">dTx0</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dTy0</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dTx1</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dTy1</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">errdTx</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">errdTy</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">errdTx0</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">errdTy0</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">errdTx1</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">errdTy1</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">idx</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">header_length</span>
        <span class="k">while</span> <span class="n">idx</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">full_contents</span><span class="p">):</span>
            <span class="n">row</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_contents</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">row</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;#&quot;</span><span class="p">):</span>
                <span class="n">idx</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">continue</span>
            <span class="n">row</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;#.*&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">row</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">sidx0</span><span class="p">,</span> <span class="n">eidx0</span><span class="p">,</span> <span class="n">aveT_PPMS0</span><span class="p">,</span> <span class="n">errT_PPMS0</span><span class="p">,</span> <span class="n">aveH0</span><span class="p">,</span> <span class="n">errH0</span><span class="p">,</span> <span class="n">aveCurrent0</span><span class="p">,</span> <span class="n">errCurrent0</span><span class="p">,</span> <span class="n">aveT_Cernox0</span><span class="p">,</span> <span class="n">errT_Cernox0</span><span class="p">,</span> <span class="n">aveVx0</span><span class="p">,</span> <span class="n">errVx0</span><span class="p">,</span> <span class="n">aveVy0</span><span class="p">,</span> <span class="n">errVy0</span><span class="p">,</span> \
                <span class="n">sidx1</span><span class="p">,</span> <span class="n">eidx1</span><span class="p">,</span> <span class="n">aveT_PPMS1</span><span class="p">,</span> <span class="n">errT_PPMS1</span><span class="p">,</span> <span class="n">aveH1</span><span class="p">,</span> <span class="n">errH1</span><span class="p">,</span> <span class="n">aveCurrent1</span><span class="p">,</span> <span class="n">errCurrent1</span><span class="p">,</span> <span class="n">aveT_Cernox1</span><span class="p">,</span> <span class="n">errT_Cernox1</span><span class="p">,</span> <span class="n">aveVx1</span><span class="p">,</span> <span class="n">errVx1</span><span class="p">,</span> <span class="n">aveVy1</span><span class="p">,</span> <span class="n">errVy1</span><span class="p">,</span> <span class="n">dTx</span><span class="p">,</span> <span class="n">errdTx</span><span class="p">,</span> <span class="n">kxx</span><span class="p">,</span> <span class="o">*</span><span class="n">errkxx</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="n">row</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="n">idx</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">continue</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Index</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="nb">int</span><span class="p">(</span><span class="n">sidx0</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">eidx0</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">sidx1</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">eidx1</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">T_PPMS</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">aveT_PPMS1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Field</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">aveH1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Current</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">aveCurrent1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">T_Cernox</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">aveT_Cernox1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dVx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">aveVx1</span><span class="o">-</span><span class="n">aveVx0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dVy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">aveVy1</span><span class="o">-</span><span class="n">aveVy0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dTx</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">aveVx1</span><span class="o">-</span><span class="n">aveVx0</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">Seebeck_at_T</span><span class="p">(</span><span class="n">aveT_PPMS1</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dTy</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">aveVy1</span><span class="o">-</span><span class="n">aveVy0</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">Seebeck_at_T</span><span class="p">(</span><span class="n">aveT_PPMS1</span><span class="p">))</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">dTx0</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">aveVx0</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">Seebeck_at_T</span><span class="p">(</span><span class="n">aveT_PPMS0</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dTy0</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">aveVy0</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">Seebeck_at_T</span><span class="p">(</span><span class="n">aveT_PPMS0</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dTx1</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">aveVx1</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">Seebeck_at_T</span><span class="p">(</span><span class="n">aveT_PPMS1</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dTy1</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">aveVy1</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">Seebeck_at_T</span><span class="p">(</span><span class="n">aveT_PPMS1</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">errdTx0</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">errVx0</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">Seebeck_at_T</span><span class="p">(</span><span class="n">aveT_PPMS0</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">errdTy0</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">errVy0</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">Seebeck_at_T</span><span class="p">(</span><span class="n">aveT_PPMS0</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">errdTx1</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">errVx1</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">Seebeck_at_T</span><span class="p">(</span><span class="n">aveT_PPMS1</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">errdTy1</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">errVy1</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">Seebeck_at_T</span><span class="p">(</span><span class="n">aveT_PPMS1</span><span class="p">))</span>

            <span class="c1"># print(errVx0/ self.Seebeck_at_T(aveT_PPMS1), errVx1/ self.Seebeck_at_T(aveT_PPMS1), errVy0/ self.Seebeck_at_T(aveT_PPMS1), errVy1/ self.Seebeck_at_T(aveT_PPMS1), (errVx0**2+errVx1**2)**0.5 / self.Seebeck_at_T(aveT_PPMS1), (errVy0**2+errVy1**2)**0.5 / self.Seebeck_at_T(aveT_PPMS1))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">errdTx</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">errVx0</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">errVx1</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">Seebeck_at_T</span><span class="p">(</span><span class="n">aveT_PPMS1</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">errdTy</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">errVy0</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">errVy1</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">Seebeck_at_T</span><span class="p">(</span><span class="n">aveT_PPMS1</span><span class="p">))</span>
            <span class="n">idx</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1000.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kxx</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">Width</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">Thickness</span> <span class="o">/</span> <span class="p">(</span><span class="n">dt</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">LTx</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">dt</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Current</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">dTx</span><span class="p">)]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">errkxx</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">k</span> <span class="o">*</span> <span class="n">edtx</span> <span class="o">/</span> <span class="n">dtx</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">dtx</span><span class="p">,</span><span class="n">edtx</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kxx</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">dTx</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">errdTx</span><span class="p">)]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Q</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">1000</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Current</span><span class="p">]</span> <span class="c1"># mW</span>
    
<div class="viewcode-block" id="ExpDataExpander.check_same_condition"><a class="viewcode-back" href="../../../cpystal.analysis.html#cpystal.analysis.thermal_conduction.ExpDataExpander.check_same_condition">[docs]</a>    <span class="k">def</span> <span class="nf">check_same_condition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">ExpDataExpander</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">LTx</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">LTx</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">LTy</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">LTy</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">LVx</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">LVx</span> <span class="ow">and</span> \
            <span class="bp">self</span><span class="o">.</span><span class="n">LVy</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">LVy</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">Width</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">Width</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">Thickness</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">Thickness</span></div>
    
    <span class="k">def</span> <span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">ExpDataExpander</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ExpDataExpander</span><span class="p">:</span>
        <span class="n">new</span><span class="p">:</span> <span class="n">ExpDataExpander</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">filename_Seebeck</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_same_condition</span><span class="p">(</span><span class="n">other</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">StartTime</span> <span class="o">&lt;</span> <span class="n">other</span><span class="o">.</span><span class="n">StartTime</span><span class="p">:</span>
                <span class="n">new</span><span class="o">.</span><span class="n">_operated_filename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="o">+</span> <span class="n">other</span><span class="o">.</span><span class="n">filename</span>
                <span class="n">new</span><span class="o">.</span><span class="n">StartTime</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">StartTime</span>
                <span class="n">new</span><span class="o">.</span><span class="n">len_Index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">len_Index</span> <span class="o">+</span> <span class="n">other</span><span class="o">.</span><span class="n">len_Index</span>
                <span class="n">new</span><span class="o">.</span><span class="n">Index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Index</span> <span class="o">+</span> <span class="p">[(</span><span class="n">s0</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">len_Index</span><span class="p">,</span> <span class="n">e0</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">len_Index</span><span class="p">,</span> <span class="n">s1</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">len_Index</span><span class="p">,</span> <span class="n">e1</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">len_Index</span><span class="p">)</span> <span class="k">for</span> <span class="p">(</span><span class="n">s0</span><span class="p">,</span><span class="n">e0</span><span class="p">,</span><span class="n">s1</span><span class="p">,</span><span class="n">e1</span><span class="p">)</span> <span class="ow">in</span> <span class="n">other</span><span class="o">.</span><span class="n">Index</span><span class="p">]</span>
                <span class="n">new</span><span class="o">.</span><span class="n">T_PPMS</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">T_PPMS</span> <span class="o">+</span> <span class="n">other</span><span class="o">.</span><span class="n">T_PPMS</span>
                <span class="n">new</span><span class="o">.</span><span class="n">Field</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Field</span> <span class="o">+</span> <span class="n">other</span><span class="o">.</span><span class="n">Field</span>
                <span class="n">new</span><span class="o">.</span><span class="n">Current</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Current</span> <span class="o">+</span> <span class="n">other</span><span class="o">.</span><span class="n">Current</span>
                <span class="n">new</span><span class="o">.</span><span class="n">T_Cernox</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">T_Cernox</span> <span class="o">+</span> <span class="n">other</span><span class="o">.</span><span class="n">T_Cernox</span>
                <span class="n">new</span><span class="o">.</span><span class="n">dVx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dVx</span> <span class="o">+</span> <span class="n">other</span><span class="o">.</span><span class="n">dVx</span>
                <span class="n">new</span><span class="o">.</span><span class="n">dVy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dVy</span> <span class="o">+</span> <span class="n">other</span><span class="o">.</span><span class="n">dVy</span>
                <span class="n">new</span><span class="o">.</span><span class="n">dTx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dTx</span> <span class="o">+</span> <span class="n">other</span><span class="o">.</span><span class="n">dTx</span>
                <span class="n">new</span><span class="o">.</span><span class="n">dTy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dTy</span> <span class="o">+</span> <span class="n">other</span><span class="o">.</span><span class="n">dTy</span>
                <span class="n">new</span><span class="o">.</span><span class="n">dTx0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dTx0</span> <span class="o">+</span> <span class="n">other</span><span class="o">.</span><span class="n">dTx0</span>
                <span class="n">new</span><span class="o">.</span><span class="n">dTy0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dTy0</span> <span class="o">+</span> <span class="n">other</span><span class="o">.</span><span class="n">dTy0</span>
                <span class="n">new</span><span class="o">.</span><span class="n">dTx1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dTx1</span> <span class="o">+</span> <span class="n">other</span><span class="o">.</span><span class="n">dTx1</span>
                <span class="n">new</span><span class="o">.</span><span class="n">dTy1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dTy1</span> <span class="o">+</span> <span class="n">other</span><span class="o">.</span><span class="n">dTy1</span>
                <span class="n">new</span><span class="o">.</span><span class="n">errdTx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">errdTx</span> <span class="o">+</span> <span class="n">other</span><span class="o">.</span><span class="n">errdTx</span>
                <span class="n">new</span><span class="o">.</span><span class="n">errdTy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">errdTy</span> <span class="o">+</span> <span class="n">other</span><span class="o">.</span><span class="n">errdTy</span>
                <span class="n">new</span><span class="o">.</span><span class="n">errdTx0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">errdTx0</span> <span class="o">+</span> <span class="n">other</span><span class="o">.</span><span class="n">errdTx0</span>
                <span class="n">new</span><span class="o">.</span><span class="n">errdTy0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">errdTy0</span> <span class="o">+</span> <span class="n">other</span><span class="o">.</span><span class="n">errdTy0</span>
                <span class="n">new</span><span class="o">.</span><span class="n">errdTx1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">errdTx1</span> <span class="o">+</span> <span class="n">other</span><span class="o">.</span><span class="n">errdTx1</span>
                <span class="n">new</span><span class="o">.</span><span class="n">errdTy1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">errdTy1</span> <span class="o">+</span> <span class="n">other</span><span class="o">.</span><span class="n">errdTy1</span>
                <span class="n">new</span><span class="o">.</span><span class="n">kxx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">kxx</span> <span class="o">+</span> <span class="n">other</span><span class="o">.</span><span class="n">kxx</span>
                <span class="n">new</span><span class="o">.</span><span class="n">errkxx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">errkxx</span> <span class="o">+</span> <span class="n">other</span><span class="o">.</span><span class="n">errkxx</span>
                <span class="n">new</span><span class="o">.</span><span class="n">Q</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Q</span> <span class="o">+</span> <span class="n">other</span><span class="o">.</span><span class="n">Q</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">new</span><span class="o">.</span><span class="n">_operated_filename</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">filename</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">filename</span>
                <span class="n">new</span><span class="o">.</span><span class="n">StartTime</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">StartTime</span>
                <span class="n">new</span><span class="o">.</span><span class="n">len_Index</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">len_Index</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">len_Index</span>
                <span class="n">new</span><span class="o">.</span><span class="n">Index</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">Index</span> <span class="o">+</span> <span class="p">[(</span><span class="n">s0</span><span class="o">+</span><span class="n">other</span><span class="o">.</span><span class="n">len_Index</span><span class="p">,</span> <span class="n">e0</span><span class="o">+</span><span class="n">other</span><span class="o">.</span><span class="n">len_Index</span><span class="p">,</span> <span class="n">s1</span><span class="o">+</span><span class="n">other</span><span class="o">.</span><span class="n">len_Index</span><span class="p">,</span> <span class="n">e1</span><span class="o">+</span><span class="n">other</span><span class="o">.</span><span class="n">len_Index</span><span class="p">)</span> <span class="k">for</span> <span class="p">(</span><span class="n">s0</span><span class="p">,</span><span class="n">e0</span><span class="p">,</span><span class="n">s1</span><span class="p">,</span><span class="n">e1</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Index</span><span class="p">]</span>
                <span class="n">new</span><span class="o">.</span><span class="n">T_PPMS</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">T_PPMS</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">T_PPMS</span>
                <span class="n">new</span><span class="o">.</span><span class="n">Field</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">Field</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">Field</span>
                <span class="n">new</span><span class="o">.</span><span class="n">Current</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">Current</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">Current</span>
                <span class="n">new</span><span class="o">.</span><span class="n">T_Cernox</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">T_Cernox</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">T_Cernox</span>
                <span class="n">new</span><span class="o">.</span><span class="n">dVx</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">dVx</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">dVx</span>
                <span class="n">new</span><span class="o">.</span><span class="n">dVy</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">dVy</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">dVy</span>
                <span class="n">new</span><span class="o">.</span><span class="n">dTx</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">dTx</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">dTx</span>
                <span class="n">new</span><span class="o">.</span><span class="n">dTy</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">dTy</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">dTy</span>
                <span class="n">new</span><span class="o">.</span><span class="n">dTx0</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">dTx0</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">dTx0</span>
                <span class="n">new</span><span class="o">.</span><span class="n">dTy0</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">dTy0</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">dTy0</span>
                <span class="n">new</span><span class="o">.</span><span class="n">dTx1</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">dTx1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">dTx1</span>
                <span class="n">new</span><span class="o">.</span><span class="n">dTy1</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">dTy1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">dTy1</span>
                <span class="n">new</span><span class="o">.</span><span class="n">errdTx</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">errdTx</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">errdTx</span>
                <span class="n">new</span><span class="o">.</span><span class="n">errdTy</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">errdTy</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">errdTy</span>
                <span class="n">new</span><span class="o">.</span><span class="n">errdTx0</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">errdTx0</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">errdTx0</span>
                <span class="n">new</span><span class="o">.</span><span class="n">errdTy0</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">errdTy0</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">errdTy0</span>
                <span class="n">new</span><span class="o">.</span><span class="n">errdTx1</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">errdTx1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">errdTx1</span>
                <span class="n">new</span><span class="o">.</span><span class="n">errdTy1</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">errdTy1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">errdTy1</span>
                <span class="n">new</span><span class="o">.</span><span class="n">kxx</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">kxx</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">kxx</span>
                <span class="n">new</span><span class="o">.</span><span class="n">errkxx</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">errkxx</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">errkxx</span>
                <span class="n">new</span><span class="o">.</span><span class="n">Q</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">Q</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">Q</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">new</span>

<div class="viewcode-block" id="ExpDataExpander.Seebeck_at_T"><a class="viewcode-back" href="../../../cpystal.analysis.html#cpystal.analysis.thermal_conduction.ExpDataExpander.Seebeck_at_T">[docs]</a>    <span class="k">def</span> <span class="nf">Seebeck_at_T</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TC_TS</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">T</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">TC_TS</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]):</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="n">S_at_T</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TC_TS</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">TC_TS</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">T</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">TC_TS</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span>
                <span class="n">S_at_T</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">TC_TS</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TC_TS</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">TC_TS</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TC_TS</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">TC_TS</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="p">(</span><span class="n">T</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">TC_TS</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                <span class="k">break</span>
        <span class="k">if</span> <span class="n">S_at_T</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span>
        <span class="k">return</span> <span class="n">S_at_T</span></div>

<div class="viewcode-block" id="ExpDataExpander.symmetrize"><a class="viewcode-back" href="../../../cpystal.analysis.html#cpystal.analysis.thermal_conduction.ExpDataExpander.symmetrize">[docs]</a>    <span class="k">def</span> <span class="nf">symmetrize</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]:</span>
        <span class="n">N</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Field</span><span class="p">)</span>
        <span class="n">lamxx</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">Width</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">Thickness</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="n">dt</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">LTx</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">dt</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Current</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">dTx</span><span class="p">)]</span>
        <span class="n">lamyx</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">Width</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">Thickness</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="n">dt</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">LTy</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">dt</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Current</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">dTy</span><span class="p">)]</span>
        <span class="n">lamxx_err</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">Width</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">Thickness</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="n">edt</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">LTx</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">edt</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Current</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">errdTx</span><span class="p">)]</span>
        <span class="n">lamyx_err</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">Width</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">Thickness</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="n">edt</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">LTy</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">edt</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Current</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">errdTy</span><span class="p">)]</span>

        <span class="c1"># symmetrize</span>
        <span class="n">lamxx_symm</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[(</span><span class="n">lamxx</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">lamxx</span><span class="p">[</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">i</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)]</span>
        <span class="n">lamxx_symm_err</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">lamxx_err</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">lamxx_err</span><span class="p">[</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)]</span>

        <span class="n">H_</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">N</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">H_</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="n">h</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Field</span><span class="p">[</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">:][::</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">Field</span><span class="p">[</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="p">:]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">H_</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="n">h</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Field</span><span class="p">[</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="p">:][::</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">Field</span><span class="p">[</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="p">:]</span>

        <span class="n">lamyx_symm</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[(</span><span class="n">lamyx</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">lamyx</span><span class="p">[</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">i</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)]</span>
        <span class="n">lamyx_symm_err</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">lamyx_err</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">lamyx_err</span><span class="p">[</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)]</span>
        <span class="n">kxx</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">lx</span> <span class="o">/</span> <span class="p">(</span><span class="n">lx</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">ly</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">lx</span><span class="p">,</span><span class="n">ly</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">lamxx_symm</span><span class="p">,</span><span class="n">lamyx_symm</span><span class="p">)]</span>
        <span class="n">kxy</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">ly</span> <span class="o">/</span> <span class="p">(</span><span class="n">lx</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">ly</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">lx</span><span class="p">,</span><span class="n">ly</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">lamxx_symm</span><span class="p">,</span><span class="n">lamyx_symm</span><span class="p">)]</span>
        <span class="n">kxx_err</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(((</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">-</span><span class="n">y</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">x_err</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">*</span><span class="n">y_err</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">((</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">y</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">x_err</span><span class="p">,</span><span class="n">y_err</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">lamxx_symm</span><span class="p">,</span><span class="n">lamyx_symm</span><span class="p">,</span><span class="n">lamxx_symm_err</span><span class="p">,</span><span class="n">lamyx_symm_err</span><span class="p">)]</span>
        <span class="n">kxy_err</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">*</span><span class="n">x_err</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">((</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">-</span><span class="n">y</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">y_err</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">((</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">y</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">x_err</span><span class="p">,</span><span class="n">y_err</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">lamxx_symm</span><span class="p">,</span><span class="n">lamyx_symm</span><span class="p">,</span><span class="n">lamxx_symm_err</span><span class="p">,</span><span class="n">lamyx_symm_err</span><span class="p">)]</span>
        <span class="k">return</span> <span class="n">H_</span><span class="p">,</span> <span class="n">kxx</span><span class="p">,</span> <span class="n">kxy</span><span class="p">,</span> <span class="n">kxx_err</span><span class="p">,</span> <span class="n">kxy_err</span></div>
    
<div class="viewcode-block" id="ExpDataExpander.symmetrize_positive_half"><a class="viewcode-back" href="../../../cpystal.analysis.html#cpystal.analysis.thermal_conduction.ExpDataExpander.symmetrize_positive_half">[docs]</a>    <span class="k">def</span> <span class="nf">symmetrize_positive_half</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]:</span>
        <span class="n">H_</span><span class="p">,</span> <span class="n">kxx</span><span class="p">,</span> <span class="n">kxy</span><span class="p">,</span> <span class="n">kxx_err</span><span class="p">,</span> <span class="n">kxy_err</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">symmetrize</span><span class="p">()</span>
        <span class="n">N</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">H_</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">H_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">H_</span><span class="p">[</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="p">:],</span> <span class="n">kxx</span><span class="p">[</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="p">:],</span> <span class="n">kxy</span><span class="p">[</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="p">:],</span> <span class="n">kxx_err</span><span class="p">[</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="p">:],</span> <span class="n">kxy_err</span><span class="p">[</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="p">:]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">H_</span><span class="p">[:(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">kxx</span><span class="p">[:(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">kxy</span><span class="p">[:(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">kxx_err</span><span class="p">[:(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">kxy_err</span><span class="p">[:(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span></div>
    
<div class="viewcode-block" id="ExpDataExpander.symmetrize_dT"><a class="viewcode-back" href="../../../cpystal.analysis.html#cpystal.analysis.thermal_conduction.ExpDataExpander.symmetrize_dT">[docs]</a>    <span class="k">def</span> <span class="nf">symmetrize_dT</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]:</span>
        <span class="n">N</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Field</span><span class="p">)</span>
        <span class="n">dTx_symm</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">dTx</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">dTx</span><span class="p">[</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">i</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)]</span>
        <span class="n">dTx_symm_err</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">errdTx</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">errdTx</span><span class="p">[</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)]</span>
        
        <span class="n">H_</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">N</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">H_</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="n">h</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Field</span><span class="p">[</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">:][::</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">Field</span><span class="p">[</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="p">:]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">H_</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="n">h</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Field</span><span class="p">[</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="p">:][::</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">Field</span><span class="p">[</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="p">:]</span>

        <span class="n">dTy_symm</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">dTy</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">dTy</span><span class="p">[</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">i</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)]</span>
        <span class="n">dTy_symm_err</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">errdTy</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">errdTy</span><span class="p">[</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)]</span>
        <span class="k">return</span> <span class="n">H_</span><span class="p">,</span> <span class="n">dTx_symm</span><span class="p">,</span> <span class="n">dTy_symm</span><span class="p">,</span> <span class="n">dTx_symm_err</span><span class="p">,</span> <span class="n">dTy_symm_err</span></div></div>


<div class="viewcode-block" id="ExpDataExpanderSeebeck"><a class="viewcode-back" href="../../../cpystal.analysis.html#cpystal.analysis.thermal_conduction.ExpDataExpanderSeebeck">[docs]</a><span class="k">class</span> <span class="nc">ExpDataExpanderSeebeck</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">filename_Seebeck</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">filename</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">full_contents</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">TC_TS</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="n">filename_Seebeck</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()[</span><span class="mi">1</span><span class="p">:]:</span>
                <span class="n">s</span><span class="p">,</span><span class="n">t</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TC_TS</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">t</span><span class="p">,</span><span class="n">s</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">TC_TS</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TC_TS</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># 温度順にソート</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">header_length</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">14</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">StartTime</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;[^\d]+?:&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_contents</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span> <span class="s1">&#39;%Y/%m/</span><span class="si">%d</span><span class="s1"> %H:%M:%S&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">LTx</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;.+:&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_contents</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">LTy</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;.+:&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_contents</span><span class="p">[</span><span class="mi">3</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">LVx</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;.+:&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_contents</span><span class="p">[</span><span class="mi">4</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">LVy</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;.+:&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_contents</span><span class="p">[</span><span class="mi">5</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Width</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;.+:&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_contents</span><span class="p">[</span><span class="mi">6</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Thickness</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;.+:&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_contents</span><span class="p">[</span><span class="mi">7</span><span class="p">]))</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">Index</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">T_PPMS</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Field</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Current</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">T_Cernox</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dVx</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dTx</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dTx0</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dTx1</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">errdTx</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">errdTx0</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">errdTx1</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">Ex</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Ey</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Ex0</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Ey0</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Ex1</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Ey1</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">errEx</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">errEy</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">errEx0</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">errEy0</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">errEx1</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">errEy1</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">Sxx</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">errSxx</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>


        <span class="n">idx</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">header_length</span>
        <span class="k">while</span> <span class="n">idx</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">full_contents</span><span class="p">):</span>
            <span class="n">row</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_contents</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">row</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;#&quot;</span><span class="p">):</span>
                <span class="n">idx</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">continue</span>
            <span class="n">row</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;#.*&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">row</span><span class="p">)</span>

            <span class="n">sidx0</span><span class="p">,</span> <span class="n">eidx0</span><span class="p">,</span> <span class="n">aveT_PPMS0</span><span class="p">,</span> <span class="n">errT_PPMS0</span><span class="p">,</span> <span class="n">aveH0</span><span class="p">,</span> <span class="n">errH0</span><span class="p">,</span> <span class="n">aveCurrent0</span><span class="p">,</span> <span class="n">errCurrent0</span><span class="p">,</span> <span class="n">aveT_Cernox0</span><span class="p">,</span> <span class="n">errT_Cernox0</span><span class="p">,</span> <span class="n">aveVx0</span><span class="p">,</span> <span class="n">errVx0</span><span class="p">,</span> <span class="n">aveEx0</span><span class="p">,</span> <span class="n">errEx0</span><span class="p">,</span> <span class="n">aveEy0</span><span class="p">,</span> <span class="n">errEy0</span><span class="p">,</span> \
            <span class="n">sidx1</span><span class="p">,</span> <span class="n">eidx1</span><span class="p">,</span> <span class="n">aveT_PPMS1</span><span class="p">,</span> <span class="n">errT_PPMS1</span><span class="p">,</span> <span class="n">aveH1</span><span class="p">,</span> <span class="n">errH1</span><span class="p">,</span> <span class="n">aveCurrent1</span><span class="p">,</span> <span class="n">errCurrent1</span><span class="p">,</span> <span class="n">aveT_Cernox1</span><span class="p">,</span> <span class="n">errT_Cernox1</span><span class="p">,</span> <span class="n">aveVx1</span><span class="p">,</span> <span class="n">errVx1</span><span class="p">,</span> <span class="n">aveEx1</span><span class="p">,</span> <span class="n">errEx1</span><span class="p">,</span> <span class="n">aveEy1</span><span class="p">,</span> <span class="n">errEy1</span><span class="p">,</span> <span class="n">_dTx</span><span class="p">,</span> <span class="n">_errdTx</span><span class="p">,</span> <span class="n">_Sxx</span><span class="p">,</span> <span class="n">_errSxx</span><span class="p">,</span> <span class="n">_Sxy</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="n">row</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Index</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="nb">int</span><span class="p">(</span><span class="n">sidx0</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">eidx0</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">sidx1</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">eidx1</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">T_PPMS</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">aveT_PPMS1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Field</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">aveH1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Current</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">aveCurrent1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">T_Cernox</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">aveT_Cernox1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dVx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">aveVx1</span><span class="o">-</span><span class="n">aveVx0</span><span class="p">)</span>
            <span class="n">dTx</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="p">(</span><span class="n">aveVx1</span><span class="o">-</span><span class="n">aveVx0</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">Seebeck_at_T</span><span class="p">(</span><span class="n">aveT_PPMS1</span><span class="p">)</span>
            <span class="n">errdTx</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="p">(</span><span class="n">errVx0</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">errVx1</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">Seebeck_at_T</span><span class="p">(</span><span class="n">aveT_PPMS1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dTx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dTx</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">errdTx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">errdTx</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dTx0</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">aveVx0</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">Seebeck_at_T</span><span class="p">(</span><span class="n">aveT_PPMS0</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dTx1</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">aveVx1</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">Seebeck_at_T</span><span class="p">(</span><span class="n">aveT_PPMS1</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">errdTx0</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">errVx0</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">Seebeck_at_T</span><span class="p">(</span><span class="n">aveT_PPMS0</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">errdTx1</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">errVx1</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">Seebeck_at_T</span><span class="p">(</span><span class="n">aveT_PPMS1</span><span class="p">))</span>

            <span class="n">Ex</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">aveEx1</span><span class="o">-</span><span class="n">aveEx0</span>
            <span class="n">Ey</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">aveEy1</span><span class="o">-</span><span class="n">aveEy0</span>
            <span class="n">errEx</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="p">(</span><span class="n">errEx0</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">errEx1</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span>
            <span class="n">errEy</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="p">(</span><span class="n">errEy0</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">errEy1</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Ex</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Ex</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Ey</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Ey</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">errEx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">errEx</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">errEy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">errEy</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">Ex0</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">aveEx0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Ex1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">aveEx1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Ey0</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">aveEy0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Ey1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">aveEy1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">errEx0</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">errEx0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">errEx1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">errEx1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">errEy0</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">errEy0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">errEy1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">errEy1</span><span class="p">)</span>
            
            <span class="c1"># self.Sxx.append(Sxx)</span>
            <span class="c1"># self.errSxx.append(errSxx)</span>
            <span class="n">Sxx</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">Ex</span> <span class="o">/</span> <span class="n">dTx</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">LVx</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">LTx</span> <span class="o">*</span> <span class="mf">1e6</span> <span class="c1"># (uV/K)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Sxx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Sxx</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">errSxx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">Sxx</span><span class="p">)</span> <span class="o">*</span> <span class="p">((</span><span class="n">errEx</span><span class="o">/</span><span class="n">Ex</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">errdTx</span><span class="o">/</span><span class="n">dTx</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span><span class="p">)</span>
            <span class="n">idx</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1000.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kxx</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">Width</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">Thickness</span> <span class="o">/</span> <span class="p">(</span><span class="n">dt</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">LTx</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">dt</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Current</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">dTx</span><span class="p">)]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">errkxx</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">k</span> <span class="o">*</span> <span class="n">edtx</span> <span class="o">/</span> <span class="n">dtx</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">dtx</span><span class="p">,</span><span class="n">edtx</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kxx</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">dTx</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">errdTx</span><span class="p">)]</span>

<div class="viewcode-block" id="ExpDataExpanderSeebeck.Seebeck_at_T"><a class="viewcode-back" href="../../../cpystal.analysis.html#cpystal.analysis.thermal_conduction.ExpDataExpanderSeebeck.Seebeck_at_T">[docs]</a>    <span class="k">def</span> <span class="nf">Seebeck_at_T</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TC_TS</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">T</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">TC_TS</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]):</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="n">S_at_T</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TC_TS</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">TC_TS</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">T</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">TC_TS</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span>
                <span class="n">S_at_T</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">TC_TS</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TC_TS</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">TC_TS</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TC_TS</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">TC_TS</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="p">(</span><span class="n">T</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">TC_TS</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                <span class="k">break</span>
        <span class="k">if</span> <span class="n">S_at_T</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span>
        <span class="k">return</span> <span class="n">S_at_T</span></div>

<div class="viewcode-block" id="ExpDataExpanderSeebeck.symmetrize"><a class="viewcode-back" href="../../../cpystal.analysis.html#cpystal.analysis.thermal_conduction.ExpDataExpanderSeebeck.symmetrize">[docs]</a>    <span class="k">def</span> <span class="nf">symmetrize</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]:</span>
        <span class="n">N</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Field</span><span class="p">)</span>
        <span class="n">kxx_symm</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">kxx</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">kxx</span><span class="p">[</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">i</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)]</span>
        <span class="n">kxx_symm_err</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">errkxx</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">errkxx</span><span class="p">[</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)]</span>

        <span class="n">Sxx_symm</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">Sxx</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">Sxx</span><span class="p">[</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">i</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)]</span>
        <span class="n">Sxx_symm_err</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">errSxx</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">errSxx</span><span class="p">[</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)]</span>

        <span class="n">Sxy_no_symm</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">ey</span><span class="o">/</span><span class="n">dtx</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">LVy</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">LTx</span> <span class="o">*</span> <span class="mf">1e6</span> <span class="k">for</span> <span class="n">ey</span><span class="p">,</span><span class="n">dtx</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Ey</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">dTx</span><span class="p">)]</span> <span class="c1"># (uV/K)</span>
        <span class="n">Sxy_no_symm_err</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="nb">abs</span><span class="p">(</span><span class="n">sxy</span><span class="p">)</span> <span class="o">*</span> <span class="p">((</span><span class="n">eey</span><span class="o">/</span><span class="n">ey</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">edtx</span><span class="o">/</span><span class="n">dtx</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span> <span class="k">for</span> <span class="n">sxy</span><span class="p">,</span><span class="n">ey</span><span class="p">,</span><span class="n">eey</span><span class="p">,</span><span class="n">dtx</span><span class="p">,</span><span class="n">edtx</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">Sxy_no_symm</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ex</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">errEx</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dTx</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">errdTx</span><span class="p">)]</span>
        <span class="n">H_</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">N</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">H_</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="n">h</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Field</span><span class="p">[</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">:][::</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">Field</span><span class="p">[</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="p">:]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">H_</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="n">h</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Field</span><span class="p">[</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="p">:][::</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">Field</span><span class="p">[</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="p">:]</span>
        <span class="n">Sxy_symm</span> <span class="o">=</span> <span class="p">[(</span><span class="n">Sxy_no_symm</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">Sxy_no_symm</span><span class="p">[</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">i</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)]</span>
        <span class="n">Sxy_symm_err</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Sxy_no_symm_err</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">Sxy_no_symm_err</span><span class="p">[</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)]</span>

        <span class="k">return</span> <span class="n">H_</span><span class="p">,</span> <span class="n">kxx_symm</span><span class="p">,</span> <span class="n">kxx_symm_err</span><span class="p">,</span> <span class="n">Sxx_symm</span><span class="p">,</span> <span class="n">Sxx_symm_err</span><span class="p">,</span> <span class="n">Sxy_symm</span><span class="p">,</span> <span class="n">Sxy_symm_err</span></div>
    
<div class="viewcode-block" id="ExpDataExpanderSeebeck.symmetrize_positive_half"><a class="viewcode-back" href="../../../cpystal.analysis.html#cpystal.analysis.thermal_conduction.ExpDataExpanderSeebeck.symmetrize_positive_half">[docs]</a>    <span class="k">def</span> <span class="nf">symmetrize_positive_half</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]:</span>
        <span class="n">H_</span><span class="p">,</span> <span class="n">kxx</span><span class="p">,</span> <span class="n">kxx_err</span><span class="p">,</span> <span class="n">Sxx</span><span class="p">,</span> <span class="n">Sxx_err</span><span class="p">,</span> <span class="n">Sxy</span><span class="p">,</span> <span class="n">Sxy_err</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">symmetrize</span><span class="p">()</span>
        <span class="n">N</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">H_</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">H_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">H_</span><span class="p">[</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="p">:],</span> <span class="n">kxx</span><span class="p">[</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="p">:],</span> <span class="n">kxx_err</span><span class="p">[</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="p">:],</span> <span class="n">Sxx</span><span class="p">[</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="p">:],</span> <span class="n">Sxx_err</span><span class="p">[</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="p">:],</span> <span class="n">Sxy</span><span class="p">[</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="p">:],</span> <span class="n">Sxy_err</span><span class="p">[</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="p">:]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">H_</span><span class="p">[:(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">kxx</span><span class="p">[:(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">kxx_err</span><span class="p">[:(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">Sxx</span><span class="p">[:(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">Sxx_err</span><span class="p">[:(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">Sxy</span><span class="p">[:(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">Sxy_err</span><span class="p">[:(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span></div>
    
<div class="viewcode-block" id="ExpDataExpanderSeebeck.symmetrize_dT"><a class="viewcode-back" href="../../../cpystal.analysis.html#cpystal.analysis.thermal_conduction.ExpDataExpanderSeebeck.symmetrize_dT">[docs]</a>    <span class="k">def</span> <span class="nf">symmetrize_dT</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]:</span>
        <span class="n">N</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Field</span><span class="p">)</span>
        <span class="n">dTx_symm</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">dTx</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">dTx</span><span class="p">[</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">i</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)]</span>
        <span class="n">dTx_symm_err</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">errdTx</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">errdTx</span><span class="p">[</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)]</span>

        <span class="n">H_</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">N</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">H_</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="n">h</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Field</span><span class="p">[</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">:][::</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">Field</span><span class="p">[</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="p">:]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">H_</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="n">h</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Field</span><span class="p">[</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="p">:][::</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">Field</span><span class="p">[</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="p">:]</span>
        <span class="k">return</span> <span class="n">H_</span><span class="p">,</span> <span class="n">dTx_symm</span><span class="p">,</span> <span class="n">dTx_symm_err</span></div></div>


<div class="viewcode-block" id="RemakeExpFromRaw"><a class="viewcode-back" href="../../../cpystal.analysis.html#cpystal.analysis.thermal_conduction.RemakeExpFromRaw">[docs]</a><span class="k">class</span> <span class="nc">RemakeExpFromRaw</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">filename_Seebeck</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">cernox_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;X173409&quot;</span><span class="p">,</span> <span class="n">attr_cor_to_V</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">filename</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">TC_TS</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="n">filename_Seebeck</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()[</span><span class="mi">1</span><span class="p">:]:</span>
                <span class="n">s</span><span class="p">,</span><span class="n">t</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TC_TS</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">t</span><span class="p">,</span><span class="n">s</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">TC_TS</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TC_TS</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># 温度順にソート</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="p">:</span> <span class="n">RawDataExpander</span> <span class="o">=</span> <span class="n">RawDataExpander</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">filename_Seebeck</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="o">.</span><span class="n">kxxkxy_mode</span><span class="p">(</span><span class="n">cernox_name</span><span class="p">,</span> <span class="n">attr_cor_to_V</span><span class="p">)</span>
        <span class="n">filename_exp</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Raw&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;Exp&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ExpData</span><span class="p">:</span> <span class="n">ExpDataExpander</span> <span class="o">=</span> <span class="n">ExpDataExpander</span><span class="p">(</span><span class="n">filename_exp</span><span class="p">,</span> <span class="n">filename_Seebeck</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">StartTime</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="o">.</span><span class="n">StartTime</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">LTx</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="o">.</span><span class="n">LTx</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">LTy</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="o">.</span><span class="n">LTy</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">LVx</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="o">.</span><span class="n">LVx</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">LVy</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="o">.</span><span class="n">LVy</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Width</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="o">.</span><span class="n">Width</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Thickness</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="o">.</span><span class="n">Thickness</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">Index</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ExpData</span><span class="o">.</span><span class="n">Index</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">T_PPMS</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Field</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Current</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">T_Cernox</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dVx</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dVy</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dTx</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dTy</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dTx0</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dTy0</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dTx1</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dTy1</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">errdTx</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">errdTy</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1000.0</span>
        <span class="k">for</span> <span class="n">sidx0</span><span class="p">,</span> <span class="n">eidx0</span><span class="p">,</span> <span class="n">sidx1</span><span class="p">,</span> <span class="n">eidx1</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Index</span><span class="p">:</span>
            <span class="n">tp0</span><span class="p">,</span> <span class="n">etp0</span><span class="p">,</span> <span class="n">h0</span><span class="p">,</span> <span class="n">eh0</span><span class="p">,</span> <span class="n">cur0</span><span class="p">,</span> <span class="n">ecur0</span><span class="p">,</span> <span class="n">tc0</span><span class="p">,</span> <span class="n">etc0</span><span class="p">,</span> <span class="n">vx0</span><span class="p">,</span> <span class="n">evx0</span><span class="p">,</span> <span class="n">vy0</span><span class="p">,</span> <span class="n">evy0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ave_std</span><span class="p">(</span><span class="n">eidx0</span><span class="o">-</span><span class="mi">59</span><span class="p">,</span> <span class="n">eidx0</span><span class="p">)</span>
            <span class="n">tp1</span><span class="p">,</span> <span class="n">etp1</span><span class="p">,</span> <span class="n">h1</span><span class="p">,</span> <span class="n">eh1</span><span class="p">,</span> <span class="n">cur1</span><span class="p">,</span> <span class="n">ecur1</span><span class="p">,</span> <span class="n">tc1</span><span class="p">,</span> <span class="n">etc1</span><span class="p">,</span> <span class="n">vx1</span><span class="p">,</span> <span class="n">evx1</span><span class="p">,</span> <span class="n">vy1</span><span class="p">,</span> <span class="n">evy1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ave_std</span><span class="p">(</span><span class="n">eidx1</span><span class="o">-</span><span class="mi">59</span><span class="p">,</span> <span class="n">eidx1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">T_PPMS</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tp1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Field</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">h1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Current</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cur1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">T_Cernox</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tc1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dVx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vx1</span><span class="o">-</span><span class="n">vx0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dVy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vy1</span><span class="o">-</span><span class="n">vy0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dTx</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">vx1</span><span class="o">-</span><span class="n">vx0</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">Seebeck_at_T</span><span class="p">(</span><span class="n">tp1</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dTy</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">vy1</span><span class="o">-</span><span class="n">vy0</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">Seebeck_at_T</span><span class="p">(</span><span class="n">tp1</span><span class="p">))</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">dTx0</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">vx0</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">Seebeck_at_T</span><span class="p">(</span><span class="n">tp0</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dTy0</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">vy0</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">Seebeck_at_T</span><span class="p">(</span><span class="n">tp0</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dTx1</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">vx1</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">Seebeck_at_T</span><span class="p">(</span><span class="n">tp1</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dTy1</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">vy1</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">Seebeck_at_T</span><span class="p">(</span><span class="n">tp1</span><span class="p">))</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">errdTx</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">evx0</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">evx1</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">Seebeck_at_T</span><span class="p">(</span><span class="n">tp1</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">errdTy</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">evy0</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">evy1</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">Seebeck_at_T</span><span class="p">(</span><span class="n">tp1</span><span class="p">))</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">kxx</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">Width</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">Thickness</span> <span class="o">/</span> <span class="p">(</span><span class="n">dt</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">LTx</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">dt</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Current</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">dTx</span><span class="p">)]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">errkxx</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">k</span> <span class="o">*</span> <span class="n">edtx</span> <span class="o">/</span> <span class="n">dtx</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">dtx</span><span class="p">,</span><span class="n">edtx</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kxx</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">dTx</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">errdTx</span><span class="p">)]</span>


<div class="viewcode-block" id="RemakeExpFromRaw.ave_std"><a class="viewcode-back" href="../../../cpystal.analysis.html#cpystal.analysis.thermal_conduction.RemakeExpFromRaw.ave_std">[docs]</a>    <span class="k">def</span> <span class="nf">ave_std</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sidx</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">eidx</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="o">...</span><span class="p">]:</span>
        <span class="n">slc</span><span class="p">:</span> <span class="nb">slice</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">sidx</span><span class="p">,</span> <span class="n">eidx</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">attr_cor_to_V</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="o">.</span><span class="n">attr_cor_to_V</span>
        <span class="n">aveT_PPMS</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="o">.</span><span class="n">PPMSTemp</span><span class="p">[</span><span class="n">slc</span><span class="p">])</span>
        <span class="n">errT_PPMS</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="o">.</span><span class="n">PPMSTemp</span><span class="p">[</span><span class="n">slc</span><span class="p">])</span>
        <span class="n">aveH</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="o">.</span><span class="n">Field</span><span class="p">[</span><span class="n">slc</span><span class="p">])</span>
        <span class="n">errH</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="o">.</span><span class="n">Field</span><span class="p">[</span><span class="n">slc</span><span class="p">])</span>
        <span class="n">aveCurrent</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="o">.</span><span class="n">HeaterCurrent</span><span class="p">[</span><span class="n">slc</span><span class="p">])</span>
        <span class="n">errCurrent</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="o">.</span><span class="n">HeaterCurrent</span><span class="p">[</span><span class="n">slc</span><span class="p">])</span>
        <span class="n">aveT_Cernox</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="o">.</span><span class="n">CernoxTemp</span><span class="p">[</span><span class="n">slc</span><span class="p">])</span>
        <span class="n">errT_Cernox</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="o">.</span><span class="n">CernoxTemp</span><span class="p">[</span><span class="n">slc</span><span class="p">])</span>
        <span class="n">Vs</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="o">.</span><span class="n">V1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="o">.</span><span class="n">V2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="o">.</span><span class="n">V3</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="o">.</span><span class="n">V4</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="o">.</span><span class="n">V5</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="o">.</span><span class="n">V6</span><span class="p">]</span>
        <span class="n">aveVx</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">Vs</span><span class="p">[</span><span class="n">attr_cor_to_V</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="n">slc</span><span class="p">])</span>
        <span class="n">errVx</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">Vs</span><span class="p">[</span><span class="n">attr_cor_to_V</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="n">slc</span><span class="p">])</span>
        <span class="n">aveVy</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">Vs</span><span class="p">[</span><span class="n">attr_cor_to_V</span><span class="p">[</span><span class="mi">2</span><span class="p">]][</span><span class="n">slc</span><span class="p">])</span>
        <span class="n">errVy</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">Vs</span><span class="p">[</span><span class="n">attr_cor_to_V</span><span class="p">[</span><span class="mi">2</span><span class="p">]][</span><span class="n">slc</span><span class="p">])</span>
        <span class="c1"># print(&quot;######&quot;)</span>
        <span class="c1"># print(aveT_PPMS, errT_PPMS, aveH, errH, aveCurrent, errCurrent, aveT_Cernox, errT_Cernox, aveVx, errVx, aveVy, errVy)</span>
        <span class="c1"># print(&quot;+++++++&quot;)</span>
        <span class="k">return</span> <span class="n">aveT_PPMS</span><span class="p">,</span> <span class="n">errT_PPMS</span><span class="p">,</span> <span class="n">aveH</span><span class="p">,</span> <span class="n">errH</span><span class="p">,</span> <span class="n">aveCurrent</span><span class="p">,</span> <span class="n">errCurrent</span><span class="p">,</span> <span class="n">aveT_Cernox</span><span class="p">,</span> <span class="n">errT_Cernox</span><span class="p">,</span> <span class="n">aveVx</span><span class="p">,</span> <span class="n">errVx</span><span class="p">,</span> <span class="n">aveVy</span><span class="p">,</span> <span class="n">errVy</span></div>

<div class="viewcode-block" id="RemakeExpFromRaw.Seebeck_at_T"><a class="viewcode-back" href="../../../cpystal.analysis.html#cpystal.analysis.thermal_conduction.RemakeExpFromRaw.Seebeck_at_T">[docs]</a>    <span class="k">def</span> <span class="nf">Seebeck_at_T</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TC_TS</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">T</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">TC_TS</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]):</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="n">S_at_T</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TC_TS</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">TC_TS</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">T</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">TC_TS</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span>
                <span class="n">S_at_T</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">TC_TS</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TC_TS</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">TC_TS</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TC_TS</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">TC_TS</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="p">(</span><span class="n">T</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">TC_TS</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                <span class="k">break</span>
        <span class="k">if</span> <span class="n">S_at_T</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span>
        <span class="k">return</span> <span class="n">S_at_T</span></div>

<div class="viewcode-block" id="RemakeExpFromRaw.symmetrize"><a class="viewcode-back" href="../../../cpystal.analysis.html#cpystal.analysis.thermal_conduction.RemakeExpFromRaw.symmetrize">[docs]</a>    <span class="k">def</span> <span class="nf">symmetrize</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]:</span>
        <span class="n">N</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Field</span><span class="p">)</span>
        <span class="n">lamxx</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">Width</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">Thickness</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="n">dt</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">LTx</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">dt</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Current</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">dTx</span><span class="p">)]</span>
        <span class="n">lamyx</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">Width</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">Thickness</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="n">dt</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">LTy</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">dt</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Current</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">dTy</span><span class="p">)]</span>
        <span class="n">lamxx_err</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">Width</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">Thickness</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="n">edt</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">LTx</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">edt</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Current</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">errdTx</span><span class="p">)]</span>
        <span class="n">lamyx_err</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">Width</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">Thickness</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="n">edt</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">LTy</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">edt</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Current</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">errdTy</span><span class="p">)]</span>

        <span class="c1"># symmetrize</span>
        <span class="n">lamxx_symm</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[(</span><span class="n">lamxx</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">lamxx</span><span class="p">[</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">i</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)]</span>
        <span class="n">lamxx_symm_err</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">lamxx_err</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">lamxx_err</span><span class="p">[</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)]</span>

        <span class="n">H_</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">N</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">H_</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="n">h</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Field</span><span class="p">[</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">:][::</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">Field</span><span class="p">[</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="p">:]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">H_</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="n">h</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Field</span><span class="p">[</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="p">:][::</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">Field</span><span class="p">[</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="p">:]</span>

        <span class="n">lamyx_symm</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[(</span><span class="n">lamyx</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">lamyx</span><span class="p">[</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">i</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)]</span>
        <span class="n">lamyx_symm_err</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">lamyx_err</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">lamyx_err</span><span class="p">[</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)]</span>
        <span class="n">kxx</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">lx</span> <span class="o">/</span> <span class="p">(</span><span class="n">lx</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">ly</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">lx</span><span class="p">,</span><span class="n">ly</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">lamxx_symm</span><span class="p">,</span><span class="n">lamyx_symm</span><span class="p">)]</span>
        <span class="n">kxy</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">ly</span> <span class="o">/</span> <span class="p">(</span><span class="n">lx</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">ly</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">lx</span><span class="p">,</span><span class="n">ly</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">lamxx_symm</span><span class="p">,</span><span class="n">lamyx_symm</span><span class="p">)]</span>
        <span class="n">kxx_err</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(((</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">-</span><span class="n">y</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">x_err</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">*</span><span class="n">y_err</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">((</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">y</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">x_err</span><span class="p">,</span><span class="n">y_err</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">lamxx_symm</span><span class="p">,</span><span class="n">lamyx_symm</span><span class="p">,</span><span class="n">lamxx_symm_err</span><span class="p">,</span><span class="n">lamyx_symm_err</span><span class="p">)]</span>
        <span class="n">kxy_err</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">*</span><span class="n">x_err</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">((</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">-</span><span class="n">y</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">y_err</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">((</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">y</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">x_err</span><span class="p">,</span><span class="n">y_err</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">lamxx_symm</span><span class="p">,</span><span class="n">lamyx_symm</span><span class="p">,</span><span class="n">lamxx_symm_err</span><span class="p">,</span><span class="n">lamyx_symm_err</span><span class="p">)]</span>
        <span class="k">return</span> <span class="n">H_</span><span class="p">,</span> <span class="n">kxx</span><span class="p">,</span> <span class="n">kxy</span><span class="p">,</span> <span class="n">kxx_err</span><span class="p">,</span> <span class="n">kxy_err</span></div>
    
<div class="viewcode-block" id="RemakeExpFromRaw.symmetrize_positive_half"><a class="viewcode-back" href="../../../cpystal.analysis.html#cpystal.analysis.thermal_conduction.RemakeExpFromRaw.symmetrize_positive_half">[docs]</a>    <span class="k">def</span> <span class="nf">symmetrize_positive_half</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]:</span>
        <span class="n">H_</span><span class="p">,</span> <span class="n">kxx</span><span class="p">,</span> <span class="n">kxy</span><span class="p">,</span> <span class="n">kxx_err</span><span class="p">,</span> <span class="n">kxy_err</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">symmetrize</span><span class="p">()</span>
        <span class="n">N</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">H_</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">H_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">H_</span><span class="p">[</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="p">:],</span> <span class="n">kxx</span><span class="p">[</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="p">:],</span> <span class="n">kxy</span><span class="p">[</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="p">:],</span> <span class="n">kxx_err</span><span class="p">[</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="p">:],</span> <span class="n">kxy_err</span><span class="p">[</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="p">:]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">H_</span><span class="p">[:(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">kxx</span><span class="p">[:(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">kxy</span><span class="p">[:(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">kxx_err</span><span class="p">[:(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">kxy_err</span><span class="p">[:(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span></div>
    
<div class="viewcode-block" id="RemakeExpFromRaw.symmetrize_dT"><a class="viewcode-back" href="../../../cpystal.analysis.html#cpystal.analysis.thermal_conduction.RemakeExpFromRaw.symmetrize_dT">[docs]</a>    <span class="k">def</span> <span class="nf">symmetrize_dT</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]:</span>
        <span class="n">N</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Field</span><span class="p">)</span>
        <span class="n">dTx_symm</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">dTx</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">dTx</span><span class="p">[</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">i</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)]</span>
        <span class="n">dTx_symm_err</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">errdTx</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">errdTx</span><span class="p">[</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)]</span>
        
        <span class="n">H_</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">N</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">H_</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="n">h</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Field</span><span class="p">[</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">:][::</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">Field</span><span class="p">[</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="p">:]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">H_</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="n">h</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Field</span><span class="p">[</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="p">:][::</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">Field</span><span class="p">[</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="p">:]</span>

        <span class="n">dTy_symm</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">dTy</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">dTy</span><span class="p">[</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">i</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)]</span>
        <span class="n">dTy_symm_err</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">errdTy</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">errdTy</span><span class="p">[</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)]</span>
        <span class="k">return</span> <span class="n">H_</span><span class="p">,</span> <span class="n">dTx_symm</span><span class="p">,</span> <span class="n">dTy_symm</span><span class="p">,</span> <span class="n">dTx_symm_err</span><span class="p">,</span> <span class="n">dTy_symm_err</span></div>


<div class="viewcode-block" id="RemakeExpFromRaw.make_new_exp_data_file"><a class="viewcode-back" href="../../../cpystal.analysis.html#cpystal.analysis.thermal_conduction.RemakeExpFromRaw.make_new_exp_data_file">[docs]</a>    <span class="k">def</span> <span class="nf">make_new_exp_data_file</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">filename_new</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Raw&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;NewExp&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename_new</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ExpData</span><span class="o">.</span><span class="n">full_contents</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="o">.</span><span class="n">header_length</span><span class="p">]))</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">sidx0</span><span class="p">,</span> <span class="n">eidx0</span><span class="p">,</span> <span class="n">sidx1</span><span class="p">,</span> <span class="n">eidx1</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Index</span><span class="p">):</span>
                <span class="n">line</span> <span class="o">=</span> <span class="p">(</span><span class="n">sidx0</span><span class="p">,</span> <span class="n">eidx0</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">ave_std</span><span class="p">(</span><span class="n">sidx0</span><span class="p">,</span> <span class="n">eidx0</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">sidx1</span><span class="p">,</span> <span class="n">eidx1</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">ave_std</span><span class="p">(</span><span class="n">sidx1</span><span class="p">,</span> <span class="n">eidx1</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dTx</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">errdTx</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">kxx</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">errkxx</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">v</span><span class="si">:</span><span class="s2">.9e</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">line</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="RemakeExpFromRawSeebeck"><a class="viewcode-back" href="../../../cpystal.analysis.html#cpystal.analysis.thermal_conduction.RemakeExpFromRawSeebeck">[docs]</a><span class="k">class</span> <span class="nc">RemakeExpFromRawSeebeck</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">filename_Seebeck</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">cernox_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;X173409&quot;</span><span class="p">,</span> <span class="n">attr_cor_to_V</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">filename</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">TC_TS</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="n">filename_Seebeck</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()[</span><span class="mi">1</span><span class="p">:]:</span>
                <span class="n">s</span><span class="p">,</span><span class="n">t</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TC_TS</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">t</span><span class="p">,</span><span class="n">s</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">TC_TS</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TC_TS</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># 温度順にソート</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="p">:</span> <span class="n">RawDataExpander</span> <span class="o">=</span> <span class="n">RawDataExpander</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">filename_Seebeck</span><span class="p">,</span> <span class="n">attr_cor_to_V</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="o">.</span><span class="n">SxxSxy_mode</span><span class="p">(</span><span class="n">cernox_name</span><span class="p">,</span> <span class="n">attr_cor_to_V</span><span class="p">)</span>
        <span class="n">filename_exp</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Raw&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;Exp&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ExpData</span><span class="p">:</span> <span class="n">ExpDataExpander</span> <span class="o">=</span> <span class="n">ExpDataExpander</span><span class="p">(</span><span class="n">filename_exp</span><span class="p">,</span> <span class="n">filename_Seebeck</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">StartTime</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="o">.</span><span class="n">StartTime</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">LTx</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="o">.</span><span class="n">LTx</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">LTy</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="o">.</span><span class="n">LTy</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">LVx</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="o">.</span><span class="n">LVx</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">LVy</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="o">.</span><span class="n">LVy</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Width</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="o">.</span><span class="n">Width</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Thickness</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="o">.</span><span class="n">Thickness</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">Index</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ExpData</span><span class="o">.</span><span class="n">Index</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">T_PPMS</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Field</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Current</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">T_Cernox</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dVx</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dTx</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dTx0</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dTx1</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">errdTx</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">errdTx0</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">errdTx1</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Ex</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Ey</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Ex0</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Ey0</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Ex1</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Ey1</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">errEx</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">errEy</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">errEx0</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">errEy0</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">errEx1</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">errEy1</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Sxx</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">errSxx</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1000.0</span>
        <span class="k">for</span> <span class="n">sidx0</span><span class="p">,</span> <span class="n">eidx0</span><span class="p">,</span> <span class="n">sidx1</span><span class="p">,</span> <span class="n">eidx1</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Index</span><span class="p">:</span>
            <span class="n">tp0</span><span class="p">,</span> <span class="n">etp0</span><span class="p">,</span> <span class="n">h0</span><span class="p">,</span> <span class="n">eh0</span><span class="p">,</span> <span class="n">cur0</span><span class="p">,</span> <span class="n">ecur0</span><span class="p">,</span> <span class="n">tc0</span><span class="p">,</span> <span class="n">etc0</span><span class="p">,</span> <span class="n">vx0</span><span class="p">,</span> <span class="n">evx0</span><span class="p">,</span> <span class="n">ex0</span><span class="p">,</span> <span class="n">eex0</span><span class="p">,</span> <span class="n">ey0</span><span class="p">,</span> <span class="n">eey0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ave_std</span><span class="p">(</span><span class="n">eidx0</span><span class="o">-</span><span class="mi">59</span><span class="p">,</span> <span class="n">eidx0</span><span class="p">)</span>
            <span class="n">tp1</span><span class="p">,</span> <span class="n">etp1</span><span class="p">,</span> <span class="n">h1</span><span class="p">,</span> <span class="n">eh1</span><span class="p">,</span> <span class="n">cur1</span><span class="p">,</span> <span class="n">ecur1</span><span class="p">,</span> <span class="n">tc1</span><span class="p">,</span> <span class="n">etc1</span><span class="p">,</span> <span class="n">vx1</span><span class="p">,</span> <span class="n">evx1</span><span class="p">,</span> <span class="n">ex1</span><span class="p">,</span> <span class="n">eex1</span><span class="p">,</span> <span class="n">ey1</span><span class="p">,</span> <span class="n">eey1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ave_std</span><span class="p">(</span><span class="n">eidx1</span><span class="o">-</span><span class="mi">59</span><span class="p">,</span> <span class="n">eidx1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">T_PPMS</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tp1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Field</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">h1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Current</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cur1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">T_Cernox</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tc1</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">dVx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vx1</span><span class="o">-</span><span class="n">vx0</span><span class="p">)</span>
            <span class="n">dTx</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="p">(</span><span class="n">vx1</span><span class="o">-</span><span class="n">vx0</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">Seebeck_at_T</span><span class="p">(</span><span class="n">tp1</span><span class="p">)</span>
            <span class="n">edTx</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="p">(</span><span class="n">evx0</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">evx1</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">Seebeck_at_T</span><span class="p">(</span><span class="n">tp1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dTx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dTx</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">errdTx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">edTx</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dTx0</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">vx0</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">Seebeck_at_T</span><span class="p">(</span><span class="n">tp0</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dTx1</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">vx1</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">Seebeck_at_T</span><span class="p">(</span><span class="n">tp1</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">errdTx0</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">evx0</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">Seebeck_at_T</span><span class="p">(</span><span class="n">tp0</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">errdTx1</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">evx1</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">Seebeck_at_T</span><span class="p">(</span><span class="n">tp1</span><span class="p">))</span>

            <span class="n">ex</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">ex1</span><span class="o">-</span><span class="n">ex0</span>
            <span class="n">ey</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">ey1</span><span class="o">-</span><span class="n">ey0</span>
            <span class="n">eex</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="p">(</span><span class="n">eex0</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">eex1</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span>
            <span class="n">eey</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="p">(</span><span class="n">eey0</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">eey1</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Ex</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ex</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Ey</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ey</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">errEx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">eex</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">errEy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">eey</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Ex0</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ex0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Ex1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ex1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Ey0</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ey0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Ey1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ey1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">errEx0</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">eex0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">errEx1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">eex1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">errEy0</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">eey0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">errEy1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">eey1</span><span class="p">)</span>
            
            <span class="c1"># self.Sxx.append(Sxx)</span>
            <span class="c1"># self.errSxx.append(eSxx)</span>
            <span class="n">Sxx</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">ex</span> <span class="o">/</span> <span class="n">dTx</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">Lvx</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">LTx</span> <span class="o">*</span> <span class="mf">1e6</span> <span class="c1"># (uv/K)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Sxx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Sxx</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">errSxx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">Sxx</span><span class="p">)</span> <span class="o">*</span> <span class="p">((</span><span class="n">eex</span><span class="o">/</span><span class="n">ex</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">edTx</span><span class="o">/</span><span class="n">dTx</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">kxx</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">Width</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">Thickness</span> <span class="o">/</span> <span class="p">(</span><span class="n">dt</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">LTx</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">dt</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Current</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">dTx</span><span class="p">)]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">errkxx</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">k</span> <span class="o">*</span> <span class="n">edtx</span> <span class="o">/</span> <span class="n">dtx</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">dtx</span><span class="p">,</span><span class="n">edtx</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kxx</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">dTx</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">errdTx</span><span class="p">)]</span>


<div class="viewcode-block" id="RemakeExpFromRawSeebeck.ave_std"><a class="viewcode-back" href="../../../cpystal.analysis.html#cpystal.analysis.thermal_conduction.RemakeExpFromRawSeebeck.ave_std">[docs]</a>    <span class="k">def</span> <span class="nf">ave_std</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sidx</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">eidx</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="o">...</span><span class="p">]:</span>
        <span class="n">slc</span><span class="p">:</span> <span class="nb">slice</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">sidx</span><span class="p">,</span> <span class="n">eidx</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">attr_cor_to_V</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="o">.</span><span class="n">attr_cor_to_V</span>
        <span class="n">aveT_PPMS</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="o">.</span><span class="n">PPMSTemp</span><span class="p">[</span><span class="n">slc</span><span class="p">])</span>
        <span class="n">errT_PPMS</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="o">.</span><span class="n">PPMSTemp</span><span class="p">[</span><span class="n">slc</span><span class="p">])</span>
        <span class="n">aveH</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="o">.</span><span class="n">Field</span><span class="p">[</span><span class="n">slc</span><span class="p">])</span>
        <span class="n">errH</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="o">.</span><span class="n">Field</span><span class="p">[</span><span class="n">slc</span><span class="p">])</span>
        <span class="n">aveCurrent</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="o">.</span><span class="n">HeaterCurrent</span><span class="p">[</span><span class="n">slc</span><span class="p">])</span>
        <span class="n">errCurrent</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="o">.</span><span class="n">HeaterCurrent</span><span class="p">[</span><span class="n">slc</span><span class="p">])</span>
        <span class="n">aveT_Cernox</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="o">.</span><span class="n">CernoxTemp</span><span class="p">[</span><span class="n">slc</span><span class="p">])</span>
        <span class="n">errT_Cernox</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="o">.</span><span class="n">CernoxTemp</span><span class="p">[</span><span class="n">slc</span><span class="p">])</span>
        <span class="n">Vs</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="o">.</span><span class="n">V1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="o">.</span><span class="n">V2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="o">.</span><span class="n">V3</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="o">.</span><span class="n">V4</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="o">.</span><span class="n">V5</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="o">.</span><span class="n">V6</span><span class="p">]</span>
        <span class="n">aveVx</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">Vs</span><span class="p">[</span><span class="n">attr_cor_to_V</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="n">slc</span><span class="p">])</span>
        <span class="n">errVx</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">Vs</span><span class="p">[</span><span class="n">attr_cor_to_V</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="n">slc</span><span class="p">])</span>
        <span class="n">aveEx</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">Vs</span><span class="p">[</span><span class="n">attr_cor_to_V</span><span class="p">[</span><span class="mi">2</span><span class="p">]][</span><span class="n">slc</span><span class="p">])</span>
        <span class="n">errEx</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">Vs</span><span class="p">[</span><span class="n">attr_cor_to_V</span><span class="p">[</span><span class="mi">2</span><span class="p">]][</span><span class="n">slc</span><span class="p">])</span>
        <span class="n">aveEy</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">Vs</span><span class="p">[</span><span class="n">attr_cor_to_V</span><span class="p">[</span><span class="mi">3</span><span class="p">]][</span><span class="n">slc</span><span class="p">])</span>
        <span class="n">errEy</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">Vs</span><span class="p">[</span><span class="n">attr_cor_to_V</span><span class="p">[</span><span class="mi">3</span><span class="p">]][</span><span class="n">slc</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">aveT_PPMS</span><span class="p">,</span> <span class="n">errT_PPMS</span><span class="p">,</span> <span class="n">aveH</span><span class="p">,</span> <span class="n">errH</span><span class="p">,</span> <span class="n">aveCurrent</span><span class="p">,</span> <span class="n">errCurrent</span><span class="p">,</span> <span class="n">aveT_Cernox</span><span class="p">,</span> <span class="n">errT_Cernox</span><span class="p">,</span> <span class="n">aveVx</span><span class="p">,</span> <span class="n">errVx</span><span class="p">,</span> <span class="n">aveEx</span><span class="p">,</span> <span class="n">errEx</span><span class="p">,</span> <span class="n">aveEy</span><span class="p">,</span> <span class="n">errEy</span></div>

<div class="viewcode-block" id="RemakeExpFromRawSeebeck.Seebeck_at_T"><a class="viewcode-back" href="../../../cpystal.analysis.html#cpystal.analysis.thermal_conduction.RemakeExpFromRawSeebeck.Seebeck_at_T">[docs]</a>    <span class="k">def</span> <span class="nf">Seebeck_at_T</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TC_TS</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">T</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">TC_TS</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]):</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="n">S_at_T</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TC_TS</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">TC_TS</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">T</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">TC_TS</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span>
                <span class="n">S_at_T</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">TC_TS</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TC_TS</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">TC_TS</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TC_TS</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">TC_TS</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="p">(</span><span class="n">T</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">TC_TS</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                <span class="k">break</span>
        <span class="k">if</span> <span class="n">S_at_T</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span>
        <span class="k">return</span> <span class="n">S_at_T</span></div>

<div class="viewcode-block" id="RemakeExpFromRawSeebeck.symmetrize"><a class="viewcode-back" href="../../../cpystal.analysis.html#cpystal.analysis.thermal_conduction.RemakeExpFromRawSeebeck.symmetrize">[docs]</a>    <span class="k">def</span> <span class="nf">symmetrize</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]:</span>
        <span class="n">N</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Field</span><span class="p">)</span>
        <span class="n">kxx_symm</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">kxx</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">kxx</span><span class="p">[</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">i</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)]</span>
        <span class="n">kxx_symm_err</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">errkxx</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">errkxx</span><span class="p">[</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)]</span>

        <span class="n">Sxx_symm</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">Sxx</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">Sxx</span><span class="p">[</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">i</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)]</span>
        <span class="n">Sxx_symm_err</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">errSxx</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">errSxx</span><span class="p">[</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)]</span>

        <span class="n">Sxy_no_symm</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">ey</span><span class="o">/</span><span class="n">dtx</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">LVy</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">LTx</span> <span class="o">*</span> <span class="mf">1e6</span> <span class="k">for</span> <span class="n">ey</span><span class="p">,</span><span class="n">dtx</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Ey</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">dTx</span><span class="p">)]</span> <span class="c1"># (uV/K)</span>
        <span class="n">Sxy_no_symm_err</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="nb">abs</span><span class="p">(</span><span class="n">sxy</span><span class="p">)</span> <span class="o">*</span> <span class="p">((</span><span class="n">eey</span><span class="o">/</span><span class="n">ey</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">edtx</span><span class="o">/</span><span class="n">dtx</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span> <span class="k">for</span> <span class="n">sxy</span><span class="p">,</span><span class="n">ey</span><span class="p">,</span><span class="n">eey</span><span class="p">,</span><span class="n">dtx</span><span class="p">,</span><span class="n">edtx</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">Sxy_no_symm</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ex</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">errEx</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dTx</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">errdTx</span><span class="p">)]</span>
        <span class="n">H_</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">N</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">H_</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="n">h</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Field</span><span class="p">[</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">:][::</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">Field</span><span class="p">[</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="p">:]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">H_</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="n">h</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Field</span><span class="p">[</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="p">:][::</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">Field</span><span class="p">[</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="p">:]</span>
        <span class="n">Sxy_symm</span> <span class="o">=</span> <span class="p">[(</span><span class="n">Sxy_no_symm</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">Sxy_no_symm</span><span class="p">[</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">i</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)]</span>
        <span class="n">Sxy_symm_err</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Sxy_no_symm_err</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">Sxy_no_symm_err</span><span class="p">[</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)]</span>

        <span class="k">return</span> <span class="n">H_</span><span class="p">,</span> <span class="n">kxx_symm</span><span class="p">,</span> <span class="n">kxx_symm_err</span><span class="p">,</span> <span class="n">Sxx_symm</span><span class="p">,</span> <span class="n">Sxx_symm_err</span><span class="p">,</span> <span class="n">Sxy_symm</span><span class="p">,</span> <span class="n">Sxy_symm_err</span></div>
    
<div class="viewcode-block" id="RemakeExpFromRawSeebeck.symmetrize_positive_half"><a class="viewcode-back" href="../../../cpystal.analysis.html#cpystal.analysis.thermal_conduction.RemakeExpFromRawSeebeck.symmetrize_positive_half">[docs]</a>    <span class="k">def</span> <span class="nf">symmetrize_positive_half</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]:</span>
        <span class="n">H_</span><span class="p">,</span> <span class="n">kxx</span><span class="p">,</span> <span class="n">kxx_err</span><span class="p">,</span> <span class="n">Sxx</span><span class="p">,</span> <span class="n">Sxx_err</span><span class="p">,</span> <span class="n">Sxy</span><span class="p">,</span> <span class="n">Sxy_err</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">symmetrize</span><span class="p">()</span>
        <span class="n">N</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">H_</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">H_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">H_</span><span class="p">[</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="p">:],</span> <span class="n">kxx</span><span class="p">[</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="p">:],</span> <span class="n">kxx_err</span><span class="p">[</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="p">:],</span> <span class="n">Sxx</span><span class="p">[</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="p">:],</span> <span class="n">Sxx_err</span><span class="p">[</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="p">:],</span> <span class="n">Sxy</span><span class="p">[</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="p">:],</span> <span class="n">Sxy_err</span><span class="p">[</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="p">:]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">H_</span><span class="p">[:(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">kxx</span><span class="p">[:(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">kxx_err</span><span class="p">[:(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">Sxx</span><span class="p">[:(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">Sxx_err</span><span class="p">[:(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">Sxy</span><span class="p">[:(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">Sxy_err</span><span class="p">[:(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span></div>
    
<div class="viewcode-block" id="RemakeExpFromRawSeebeck.symmetrize_dT"><a class="viewcode-back" href="../../../cpystal.analysis.html#cpystal.analysis.thermal_conduction.RemakeExpFromRawSeebeck.symmetrize_dT">[docs]</a>    <span class="k">def</span> <span class="nf">symmetrize_dT</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]:</span>
        <span class="n">N</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Field</span><span class="p">)</span>
        <span class="n">dTx_symm</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">dTx</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">dTx</span><span class="p">[</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">i</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)]</span>
        <span class="n">dTx_symm_err</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">errdTx</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">errdTx</span><span class="p">[</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)]</span>

        <span class="n">H_</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">N</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">H_</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="n">h</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Field</span><span class="p">[</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">:][::</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">Field</span><span class="p">[</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="p">:]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">H_</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="n">h</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Field</span><span class="p">[</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="p">:][::</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">Field</span><span class="p">[</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="p">:]</span>
        <span class="k">return</span> <span class="n">H_</span><span class="p">,</span> <span class="n">dTx_symm</span><span class="p">,</span> <span class="n">dTx_symm_err</span></div>

<div class="viewcode-block" id="RemakeExpFromRawSeebeck.make_new_exp_data_file"><a class="viewcode-back" href="../../../cpystal.analysis.html#cpystal.analysis.thermal_conduction.RemakeExpFromRawSeebeck.make_new_exp_data_file">[docs]</a>    <span class="k">def</span> <span class="nf">make_new_exp_data_file</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">filename_new</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Raw&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;NewExp&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename_new</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ExpData</span><span class="o">.</span><span class="n">full_contents</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="o">.</span><span class="n">header_length</span><span class="p">]))</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">sidx0</span><span class="p">,</span> <span class="n">eidx0</span><span class="p">,</span> <span class="n">sidx1</span><span class="p">,</span> <span class="n">eidx1</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Index</span><span class="p">):</span>
                <span class="n">line</span> <span class="o">=</span> <span class="p">(</span><span class="n">sidx0</span><span class="p">,</span> <span class="n">eidx0</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">ave_std</span><span class="p">(</span><span class="n">sidx0</span><span class="p">,</span> <span class="n">eidx0</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">sidx1</span><span class="p">,</span> <span class="n">eidx1</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">ave_std</span><span class="p">(</span><span class="n">sidx1</span><span class="p">,</span> <span class="n">eidx1</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dTx</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">errdTx</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">kxx</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">errkxx</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">Sxx</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">errSxx</span><span class="p">[</span><span class="n">i</span><span class="p">],)</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">v</span><span class="si">:</span><span class="s2">.9e</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">line</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="AATTPMD"><a class="viewcode-back" href="../../../cpystal.analysis.html#cpystal.analysis.thermal_conduction.AATTPMD">[docs]</a><span class="k">class</span> <span class="nc">AATTPMD</span><span class="p">(</span><span class="n">RawDataExpander</span><span class="p">,</span> <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;App. for Analysis of Thermal Transport Property Measurement Data</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">filename_Seebeck</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">cernox_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">attr_cor_to_V</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">RawDataExpander</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">filename_Seebeck</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kxxkxy_mode</span><span class="p">(</span><span class="n">cernox_name</span><span class="p">,</span> <span class="n">attr_cor_to_V</span><span class="p">)</span>
        <span class="n">filename_exp</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Raw&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;Exp&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ExpData</span><span class="p">:</span> <span class="n">ExpDataExpander</span> <span class="o">=</span> <span class="n">ExpDataExpander</span><span class="p">(</span><span class="n">filename_exp</span><span class="p">,</span> <span class="n">filename_Seebeck</span><span class="p">)</span>

        <span class="n">root</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Tk</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Tk</span><span class="p">()</span>
        <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">root</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Tk</span> <span class="o">=</span> <span class="n">root</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="n">geometry</span><span class="p">(</span><span class="s1">&#39;1500x900&#39;</span><span class="p">)</span>

        <span class="c1">#-----------------------------------------------</span>

        <span class="c1"># matplotlib配置用フレーム</span>
        <span class="n">mtpltlb_frame</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">14</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.family&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Arial&#39;</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;xtick.direction&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;in&#39;</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;ytick.direction&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;in&#39;</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;legend.framealpha&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;legend.fontsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">8</span>


        <span class="n">figsize</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
        <span class="n">fig</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">Figure</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">wspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.20</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">ax1</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">Subplot</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">221</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax1</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax1</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Time</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Field</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;Time (sec)&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$H$ (Oe)&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax1</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticklabels</span><span class="p">([])</span> <span class="c1"># 目盛を削除</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">Subplot</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">223</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Time</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">CernoxTemp</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Time</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">PPMSTemp</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;Time (sec)&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$T$ (K)&quot;</span><span class="o">+</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> Cernox:blue</span><span class="se">\n</span><span class="s2"> PPMS:red)&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">Subplot</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">222</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Time</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dTx</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;Time (sec)&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$\Delta T_</span><span class="si">{x}</span><span class="s2">$ (K)&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticklabels</span><span class="p">([])</span> <span class="c1"># 目盛を削除</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ax4</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">Subplot</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">224</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax4</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax4</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax4</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Time</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dTy</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax4</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;Time (sec)&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax4</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$\Delta T_</span><span class="si">{y}</span><span class="s2">$ (K)&quot;</span><span class="p">)</span>

        <span class="c1"># マウスのhoverで描画する縦線</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ln1_hover</span><span class="p">,</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">([],[],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ln2_hover</span><span class="p">,</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">([],[],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ln3_hover</span><span class="p">,</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">([],[],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ln4_hover</span><span class="p">,</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax4</span><span class="o">.</span><span class="n">plot</span><span class="p">([],[],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        
        <span class="c1"># マウスのclickで描画する縦線</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ln1_start</span><span class="p">,</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">([],[],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ln2_start</span><span class="p">,</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">([],[],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ln3_start</span><span class="p">,</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">([],[],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ln4_start</span><span class="p">,</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax4</span><span class="o">.</span><span class="n">plot</span><span class="p">([],[],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="c1"># マウスのclickで描画する縦線</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ln1_end</span><span class="p">,</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">([],[],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ln2_end</span><span class="p">,</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">([],[],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ln3_end</span><span class="p">,</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">([],[],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ln4_end</span><span class="p">,</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax4</span><span class="o">.</span><span class="n">plot</span><span class="p">([],[],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="c1"># 指定されたsidx0, eidx0, sidx1, eidx1に対応する縦線</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ln1_s0</span><span class="p">,</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">([],[],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ln2_s0</span><span class="p">,</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">([],[],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ln3_s0</span><span class="p">,</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">([],[],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ln4_s0</span><span class="p">,</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax4</span><span class="o">.</span><span class="n">plot</span><span class="p">([],[],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ln1_e0</span><span class="p">,</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">([],[],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;orange&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ln2_e0</span><span class="p">,</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">([],[],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;orange&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ln3_e0</span><span class="p">,</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">([],[],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;orange&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ln4_e0</span><span class="p">,</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax4</span><span class="o">.</span><span class="n">plot</span><span class="p">([],[],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;orange&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ln1_s1</span><span class="p">,</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">([],[],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ln2_s1</span><span class="p">,</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">([],[],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ln3_s1</span><span class="p">,</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">([],[],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ln4_s1</span><span class="p">,</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax4</span><span class="o">.</span><span class="n">plot</span><span class="p">([],[],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ln1_e1</span><span class="p">,</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">([],[],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;orange&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ln2_e1</span><span class="p">,</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">([],[],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;orange&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ln3_e1</span><span class="p">,</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">([],[],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;orange&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ln4_e1</span><span class="p">,</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax4</span><span class="o">.</span><span class="n">plot</span><span class="p">([],[],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;orange&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">expfit_dTx</span><span class="p">,</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">([],[],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;cyan&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>

        <span class="c1"># figとFrameの対応付け</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fig_canvas</span><span class="p">:</span> <span class="n">FigureCanvasTkAgg</span> <span class="o">=</span> <span class="n">FigureCanvasTkAgg</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">mtpltlb_frame</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">toolbar</span><span class="p">:</span> <span class="n">NavigationToolbar2Tk</span> <span class="o">=</span> <span class="n">NavigationToolbar2Tk</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fig_canvas</span><span class="p">,</span> <span class="n">mtpltlb_frame</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cid1</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">mpl_connect</span><span class="p">(</span><span class="s1">&#39;button_press_event&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fig_click</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cid2</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">mpl_connect</span><span class="p">(</span><span class="s1">&#39;motion_notify_event&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fig_hover</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fig_canvas</span><span class="o">.</span><span class="n">get_tk_widget</span><span class="p">()</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">expand</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">side</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">LEFT</span><span class="p">)</span>

        <span class="n">mtpltlb_frame</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">LEFT</span><span class="p">)</span>

        <span class="c1">#-----------------------------------------------</span>
        <span class="c1">### sliderを生成</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sliders</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">tk</span><span class="o">.</span><span class="n">DoubleVar</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">tk</span><span class="o">.</span><span class="n">DoubleVar</span><span class="p">(),</span> <span class="n">tk</span><span class="o">.</span><span class="n">DoubleVar</span><span class="p">()]</span>
        <span class="n">slider0</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Scale</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="p">,</span>
                    <span class="n">variable</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sliders</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                    <span class="n">command</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_slider_scroll</span><span class="p">,</span>
                    <span class="n">orient</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">HORIZONTAL</span><span class="p">,</span>
                    <span class="n">length</span> <span class="o">=</span> <span class="mi">300</span><span class="p">,</span>
                    <span class="n">width</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span>
                    <span class="n">sliderlength</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
                    <span class="n">from_</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                    <span class="n">to</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Time</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span>
                    <span class="n">resolution</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
                    <span class="n">tickinterval</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="p">)</span>
        <span class="n">slider0</span><span class="o">.</span><span class="n">pack</span><span class="p">()</span>

        <span class="n">slider1</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Scale</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="p">,</span>
                    <span class="n">variable</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sliders</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                    <span class="n">command</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_slider_scroll</span><span class="p">,</span>
                    <span class="n">orient</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">HORIZONTAL</span><span class="p">,</span>
                    <span class="n">length</span> <span class="o">=</span> <span class="mi">300</span><span class="p">,</span>
                    <span class="n">width</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span>
                    <span class="n">sliderlength</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
                    <span class="n">from_</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                    <span class="n">to</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Time</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span>
                    <span class="n">resolution</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
                    <span class="n">tickinterval</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="p">)</span>
        <span class="n">slider1</span><span class="o">.</span><span class="n">pack</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sliders</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sliders</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Time</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>

        <span class="c1">#-----------------------------------------------</span>
        <span class="c1">### slider制御のFrame</span>
        <span class="n">slider_control_frame</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="p">,</span> <span class="n">borderwidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">relief</span><span class="o">=</span><span class="s2">&quot;ridge&quot;</span><span class="p">)</span>
        <span class="c1"># resetボタン</span>
        <span class="n">reset_button</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">slider_control_frame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Reset&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_reset_click</span><span class="p">)</span>
        <span class="n">reset_button</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

        <span class="c1"># 相対位置固定チェックボタン</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t_lock</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_locked</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">BooleanVar</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">BooleanVar</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_locked</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">lock_cbutton</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Checkbutton</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Checkbutton</span><span class="p">(</span><span class="n">slider_control_frame</span><span class="p">,</span> <span class="n">variable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">is_locked</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Lock&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_lock_click</span><span class="p">)</span>
        <span class="n">lock_cbutton</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

        <span class="c1"># increment関係のFrame</span>
        <span class="n">increment_frame</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="n">slider_control_frame</span><span class="p">,</span> <span class="n">borderwidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">relief</span><span class="o">=</span><span class="s2">&quot;ridge&quot;</span><span class="p">)</span>
        <span class="n">increment_button</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">increment_frame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Increment&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_increment_click</span><span class="p">)</span>
        <span class="n">increment_button</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">increment</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Entry</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="n">increment_frame</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">increment</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">increment_frame</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">rowspan</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">sticky</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">N</span><span class="o">+</span><span class="n">tk</span><span class="o">.</span><span class="n">S</span><span class="p">)</span>

        <span class="c1"># スライダーの値を直接入力</span>
        <span class="k">def</span> <span class="nf">slider_left_changer</span><span class="p">(</span><span class="n">var</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">idx</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">mode</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sliders</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">slider_left_value</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_slider_scroll</span><span class="p">()</span>
        <span class="k">def</span> <span class="nf">slider_right_changer</span><span class="p">(</span><span class="n">var</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">idx</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">mode</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sliders</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">slider_right_value</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_slider_scroll</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">slider_left_value</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">DoubleVar</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">DoubleVar</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">slider_left_value</span><span class="o">.</span><span class="n">trace_add</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s2">&quot;write&quot;</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="n">slider_left_changer</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">slider_left</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Entry</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="n">slider_control_frame</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">slider_left_value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">slider_left</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">slider_right_value</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">DoubleVar</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">DoubleVar</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">slider_right_value</span><span class="o">.</span><span class="n">trace_add</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s2">&quot;write&quot;</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="n">slider_right_changer</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">slider_right</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Entry</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="n">slider_control_frame</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">slider_right_value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">slider_right</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

        <span class="n">slider_control_frame</span><span class="o">.</span><span class="n">pack</span><span class="p">()</span>

        <span class="c1">#-----------------------------------------------</span>
        <span class="c1">### データ解析のFrame</span>
        <span class="n">analysis_frame</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="p">,</span> <span class="n">borderwidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">relief</span><span class="o">=</span><span class="s2">&quot;ridge&quot;</span><span class="p">)</span>

        <span class="c1"># データsave先のfilename</span>
        <span class="n">lbl_filename</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">analysis_frame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;save filename&quot;</span><span class="p">)</span>
        <span class="n">lbl_filename</span><span class="o">.</span><span class="n">pack</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">filename_to_save</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Entry</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="n">analysis_frame</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">filename_to_save</span><span class="o">.</span><span class="n">pack</span><span class="p">()</span>

        <span class="c1"># 測定番号を元に時間範囲を指定</span>
        <span class="n">exp_idx_frame</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="n">analysis_frame</span><span class="p">,</span> <span class="n">borderwidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">relief</span><span class="o">=</span><span class="s2">&quot;ridge&quot;</span><span class="p">)</span>
        <span class="n">lbl_exp_idx</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">exp_idx_frame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Exp index&quot;</span><span class="p">,</span> <span class="n">foreground</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
        <span class="n">lbl_exp_idx</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">exp_idx</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Entry</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="n">exp_idx_frame</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">exp_idx</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">lbl_now_idx</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">exp_idx_frame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;now index&quot;</span><span class="p">,</span> <span class="n">foreground</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
        <span class="n">lbl_now_idx</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">now_idx_value</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">now_idx_value</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;0&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lbl_now_idx_value</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">exp_idx_frame</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">now_idx_value</span><span class="p">,</span> <span class="n">relief</span><span class="o">=</span><span class="s2">&quot;sunken&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lbl_now_idx_value</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">update_button</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">exp_idx_frame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Update&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_update_click</span><span class="p">)</span>
        <span class="n">update_button</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">prev_button</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">exp_idx_frame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Prev&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_prev_click</span><span class="p">)</span>
        <span class="n">prev_button</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">next_button</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">exp_idx_frame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Next&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_next_click</span><span class="p">)</span>
        <span class="n">next_button</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">lbl_kxx</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">exp_idx_frame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;kxx (W/Km)&quot;</span><span class="p">)</span>
        <span class="n">lbl_kxx</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kxx_value</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lbl_kxx_value</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">exp_idx_frame</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kxx_value</span><span class="p">,</span> <span class="n">relief</span><span class="o">=</span><span class="s2">&quot;sunken&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lbl_kxx_value</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">exp_idx_frame</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

        <span class="c1"># データとして使う時間範囲の設定をするためのFrame</span>
        <span class="n">range_frame</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="n">analysis_frame</span><span class="p">,</span> <span class="n">borderwidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">relief</span><span class="o">=</span><span class="s2">&quot;ridge&quot;</span><span class="p">)</span>
        <span class="n">lbl_start</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">range_frame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;start (s)&quot;</span><span class="p">,</span> <span class="n">foreground</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">)</span>
        <span class="n">lbl_start</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_start</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Entry</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="n">range_frame</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_start</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">lbl_end</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">range_frame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;end (s)&quot;</span><span class="p">,</span> <span class="n">foreground</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
        <span class="n">lbl_end</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_end</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Entry</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="n">range_frame</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_end</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">lbl_dt</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">range_frame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;end-start (s)&quot;</span><span class="p">,</span> <span class="n">foreground</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
        <span class="n">lbl_dt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_dt_value</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lbl_time_dt_value</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">range_frame</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">time_dt_value</span><span class="p">,</span> <span class="n">relief</span><span class="o">=</span><span class="s2">&quot;sunken&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lbl_time_dt_value</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">start_or_end</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_select_range_by_click</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">BooleanVar</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">BooleanVar</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_select_range_by_click</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">select_range_by_click_cbutton</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Checkbutton</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Checkbutton</span><span class="p">(</span><span class="n">range_frame</span><span class="p">,</span> <span class="n">variable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">is_select_range_by_click</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;select range by click&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_select_range_by_click_click</span><span class="p">)</span>
        <span class="n">select_range_by_click_cbutton</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">columnspan</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">range_frame</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

        <span class="c1"># データを表示するFrame</span>
        <span class="n">value_frame</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="n">analysis_frame</span><span class="p">,</span> <span class="n">borderwidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">relief</span><span class="o">=</span><span class="s2">&quot;ridge&quot;</span><span class="p">)</span>
        <span class="n">lbl_field</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">value_frame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;H (Oe)&quot;</span><span class="p">)</span>
        <span class="n">lbl_field</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">field_value</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lbl_field_value</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">value_frame</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">field_value</span><span class="p">,</span> <span class="n">relief</span><span class="o">=</span><span class="s2">&quot;sunken&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lbl_field_value</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">lbl_Cernox_temp</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">value_frame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;T_Cernox (K)&quot;</span><span class="p">)</span>
        <span class="n">lbl_Cernox_temp</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Cernox_temp_value</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lbl_Cernox_temp_value</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">value_frame</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Cernox_temp_value</span><span class="p">,</span> <span class="n">relief</span><span class="o">=</span><span class="s2">&quot;sunken&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lbl_Cernox_temp_value</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">lbl_dTx</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">value_frame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;ΔTx (K)&quot;</span><span class="p">)</span>
        <span class="n">lbl_dTx</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dTx_value</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lbl_dTx_value</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">value_frame</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dTx_value</span><span class="p">,</span> <span class="n">relief</span><span class="o">=</span><span class="s2">&quot;sunken&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lbl_dTx_value</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">lbl_dTy</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">value_frame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;ΔTy (K)&quot;</span><span class="p">)</span>
        <span class="n">lbl_dTy</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dTy_value</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lbl_dTy_value</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">value_frame</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dTy_value</span><span class="p">,</span> <span class="n">relief</span><span class="o">=</span><span class="s2">&quot;sunken&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lbl_dTy_value</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">value_frame</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

        <span class="c1"># 指定した時間範囲のデータを計算させるボタン</span>
        <span class="n">calc_button</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">analysis_frame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Calc&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_calc_click</span><span class="p">)</span>
        <span class="n">calc_button</span><span class="o">.</span><span class="n">pack</span><span class="p">()</span>

        <span class="c1"># 計算したデータをsaveさせるボタン</span>
        <span class="n">save_button</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">analysis_frame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Save&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_save_click</span><span class="p">)</span>
        <span class="n">save_button</span><span class="o">.</span><span class="n">pack</span><span class="p">()</span>

        <span class="c1"># 選択した範囲から計算したExp形式のデータを標準出力させるFrame</span>
        <span class="n">print_frame</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="n">analysis_frame</span><span class="p">,</span> <span class="n">borderwidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">relief</span><span class="o">=</span><span class="s2">&quot;ridge&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">print_mode</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t0</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t1</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data0</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data1</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="n">print_button</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">print_frame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Print&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_print_click</span><span class="p">)</span>
        <span class="n">print_button</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">lbl_sidx0</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">print_frame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;t_s0&quot;</span><span class="p">)</span>
        <span class="n">lbl_sidx0</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">lbl_eidx0</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">print_frame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;t_e0&quot;</span><span class="p">)</span>
        <span class="n">lbl_eidx0</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">lbl_sidx1</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">print_frame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;t_s1&quot;</span><span class="p">)</span>
        <span class="n">lbl_sidx1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">lbl_eidx1</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">print_frame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;t_e1&quot;</span><span class="p">)</span>
        <span class="n">lbl_eidx1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t_s0</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lbl_t_s0_value</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">print_frame</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">t_s0</span><span class="p">,</span> <span class="n">relief</span><span class="o">=</span><span class="s2">&quot;sunken&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lbl_t_s0_value</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t_e0</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lbl_t_e0_value</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">print_frame</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">t_e0</span><span class="p">,</span> <span class="n">relief</span><span class="o">=</span><span class="s2">&quot;sunken&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lbl_t_e0_value</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t_s1</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lbl_t_s1_value</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">print_frame</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">t_s1</span><span class="p">,</span> <span class="n">relief</span><span class="o">=</span><span class="s2">&quot;sunken&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lbl_t_s1_value</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t_e1</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lbl_t_e1_value</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">print_frame</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">t_e1</span><span class="p">,</span> <span class="n">relief</span><span class="o">=</span><span class="s2">&quot;sunken&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lbl_t_e1_value</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
        <span class="n">print_frame</span><span class="o">.</span><span class="n">pack</span><span class="p">()</span>

        <span class="c1"># 指定されている範囲を f(t) := A exp(-t/τ) でフィッティングするFrame</span>
        <span class="n">expfit_frame</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="n">analysis_frame</span><span class="p">,</span> <span class="n">borderwidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">relief</span><span class="o">=</span><span class="s2">&quot;ridge&quot;</span><span class="p">)</span>
        <span class="n">expfit_button</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">expfit_frame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;ExpFit&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_expfit_click</span><span class="p">)</span>
        <span class="n">expfit_button</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">lbl_relaxation_time</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">expfit_frame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;τ ln(100) (s)&quot;</span><span class="p">)</span>
        <span class="n">lbl_relaxation_time</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">relaxation_time</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lbl_relaxation_time_value</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">expfit_frame</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">relaxation_time</span><span class="p">,</span> <span class="n">relief</span><span class="o">=</span><span class="s2">&quot;sunken&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lbl_relaxation_time_value</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">expfit_frame</span><span class="o">.</span><span class="n">pack</span><span class="p">()</span>


        <span class="n">analysis_frame</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">pady</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
        <span class="c1">#-----------------------------------------------</span>
    
    <span class="k">def</span> <span class="nf">_update_xlim</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t1</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">t2</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax1</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span><span class="n">t2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span><span class="n">t2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span><span class="n">t2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax4</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span><span class="n">t2</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_update_ylim</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t1</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">t2</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">lineax1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax1</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">yax1</span> <span class="o">=</span> <span class="n">lineax1</span><span class="o">.</span><span class="n">_yorig</span><span class="p">[</span><span class="n">bisect_left</span><span class="p">(</span><span class="n">lineax1</span><span class="o">.</span><span class="n">_xorig</span><span class="p">,</span><span class="n">t1</span><span class="p">):</span><span class="n">bisect_left</span><span class="p">(</span><span class="n">lineax1</span><span class="o">.</span><span class="n">_xorig</span><span class="p">,</span><span class="n">t2</span><span class="p">)]</span>
        <span class="n">yax1m</span><span class="p">,</span> <span class="n">yax1M</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">yax1</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">yax1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">yax1m</span><span class="o">-</span><span class="p">(</span><span class="n">yax1M</span><span class="o">-</span><span class="n">yax1m</span><span class="p">)</span><span class="o">*</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">yax1M</span><span class="o">+</span><span class="p">(</span><span class="n">yax1M</span><span class="o">-</span><span class="n">yax1m</span><span class="p">)</span><span class="o">*</span><span class="mf">0.05</span><span class="p">)</span>
        <span class="n">lineax2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">yax2</span> <span class="o">=</span> <span class="n">lineax2</span><span class="o">.</span><span class="n">_yorig</span><span class="p">[</span><span class="n">bisect_left</span><span class="p">(</span><span class="n">lineax2</span><span class="o">.</span><span class="n">_xorig</span><span class="p">,</span><span class="n">t1</span><span class="p">):</span><span class="n">bisect_left</span><span class="p">(</span><span class="n">lineax2</span><span class="o">.</span><span class="n">_xorig</span><span class="p">,</span><span class="n">t2</span><span class="p">)]</span>
        <span class="n">lineax2_2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">yax2_2</span> <span class="o">=</span> <span class="n">lineax2_2</span><span class="o">.</span><span class="n">_yorig</span><span class="p">[</span><span class="n">bisect_left</span><span class="p">(</span><span class="n">lineax2_2</span><span class="o">.</span><span class="n">_xorig</span><span class="p">,</span><span class="n">t1</span><span class="p">):</span><span class="n">bisect_left</span><span class="p">(</span><span class="n">lineax2_2</span><span class="o">.</span><span class="n">_xorig</span><span class="p">,</span><span class="n">t2</span><span class="p">)]</span>
        <span class="n">yax2m</span><span class="p">,</span> <span class="n">yax2M</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">yax2</span><span class="p">),</span><span class="nb">min</span><span class="p">(</span><span class="n">yax2_2</span><span class="p">)),</span> <span class="nb">max</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">yax2</span><span class="p">),</span><span class="nb">max</span><span class="p">(</span><span class="n">yax2_2</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">yax2m</span><span class="o">-</span><span class="p">(</span><span class="n">yax2M</span><span class="o">-</span><span class="n">yax2m</span><span class="p">)</span><span class="o">*</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">yax2M</span><span class="o">+</span><span class="p">(</span><span class="n">yax2M</span><span class="o">-</span><span class="n">yax2m</span><span class="p">)</span><span class="o">*</span><span class="mf">0.05</span><span class="p">)</span>
        <span class="n">lineax3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">yax3</span> <span class="o">=</span> <span class="n">lineax3</span><span class="o">.</span><span class="n">_yorig</span><span class="p">[</span><span class="n">bisect_left</span><span class="p">(</span><span class="n">lineax3</span><span class="o">.</span><span class="n">_xorig</span><span class="p">,</span><span class="n">t1</span><span class="p">):</span><span class="n">bisect_left</span><span class="p">(</span><span class="n">lineax3</span><span class="o">.</span><span class="n">_xorig</span><span class="p">,</span><span class="n">t2</span><span class="p">)]</span>
        <span class="n">yax3m</span><span class="p">,</span> <span class="n">yax3M</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">yax3</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">yax3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">yax3m</span><span class="o">-</span><span class="p">(</span><span class="n">yax3M</span><span class="o">-</span><span class="n">yax3m</span><span class="p">)</span><span class="o">*</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">yax3M</span><span class="o">+</span><span class="p">(</span><span class="n">yax3M</span><span class="o">-</span><span class="n">yax3m</span><span class="p">)</span><span class="o">*</span><span class="mf">0.05</span><span class="p">)</span>
        <span class="n">lineax4</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax4</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">yax4</span> <span class="o">=</span> <span class="n">lineax4</span><span class="o">.</span><span class="n">_yorig</span><span class="p">[</span><span class="n">bisect_left</span><span class="p">(</span><span class="n">lineax4</span><span class="o">.</span><span class="n">_xorig</span><span class="p">,</span><span class="n">t1</span><span class="p">):</span><span class="n">bisect_left</span><span class="p">(</span><span class="n">lineax4</span><span class="o">.</span><span class="n">_xorig</span><span class="p">,</span><span class="n">t2</span><span class="p">)]</span>
        <span class="n">yax4m</span><span class="p">,</span> <span class="n">yax4M</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">yax4</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">yax4</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax4</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">yax4m</span><span class="o">-</span><span class="p">(</span><span class="n">yax4M</span><span class="o">-</span><span class="n">yax4m</span><span class="p">)</span><span class="o">*</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">yax4M</span><span class="o">+</span><span class="p">(</span><span class="n">yax4M</span><span class="o">-</span><span class="n">yax4m</span><span class="p">)</span><span class="o">*</span><span class="mf">0.05</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_update_start_time</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x_start</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_start</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">tk</span><span class="o">.</span><span class="n">END</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_start</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">tk</span><span class="o">.</span><span class="n">END</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">x_start</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">start_or_end</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ln1_start</span><span class="o">.</span><span class="n">set_data</span><span class="p">([</span><span class="n">x_start</span><span class="p">,</span><span class="n">x_start</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax1</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ln2_start</span><span class="o">.</span><span class="n">set_data</span><span class="p">([</span><span class="n">x_start</span><span class="p">,</span><span class="n">x_start</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ln3_start</span><span class="o">.</span><span class="n">set_data</span><span class="p">([</span><span class="n">x_start</span><span class="p">,</span><span class="n">x_start</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ln4_start</span><span class="o">.</span><span class="n">set_data</span><span class="p">([</span><span class="n">x_start</span><span class="p">,</span><span class="n">x_start</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax4</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">())</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_start</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_end</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">time_dt_value</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time_end</span><span class="o">.</span><span class="n">get</span><span class="p">())</span><span class="o">-</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time_start</span><span class="o">.</span><span class="n">get</span><span class="p">())</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_update_end_time</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x_end</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_end</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">tk</span><span class="o">.</span><span class="n">END</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_end</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">tk</span><span class="o">.</span><span class="n">END</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">x_end</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">start_or_end</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ln1_end</span><span class="o">.</span><span class="n">set_data</span><span class="p">([</span><span class="n">x_end</span><span class="p">,</span><span class="n">x_end</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax1</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ln2_end</span><span class="o">.</span><span class="n">set_data</span><span class="p">([</span><span class="n">x_end</span><span class="p">,</span><span class="n">x_end</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ln3_end</span><span class="o">.</span><span class="n">set_data</span><span class="p">([</span><span class="n">x_end</span><span class="p">,</span><span class="n">x_end</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ln4_end</span><span class="o">.</span><span class="n">set_data</span><span class="p">([</span><span class="n">x_end</span><span class="p">,</span><span class="n">x_end</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax4</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">())</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_start</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_end</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">time_dt_value</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time_end</span><span class="o">.</span><span class="n">get</span><span class="p">())</span><span class="o">-</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time_start</span><span class="o">.</span><span class="n">get</span><span class="p">())</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_update_exp_line</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t1</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">t2</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">t3</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">t4</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;バックグラウンド測定開始・終了時間とQ&gt;0での測定開始・終了時間の描画</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ln1_s0</span><span class="o">.</span><span class="n">set_data</span><span class="p">([</span><span class="n">t1</span><span class="p">,</span><span class="n">t1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax1</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ln2_s0</span><span class="o">.</span><span class="n">set_data</span><span class="p">([</span><span class="n">t1</span><span class="p">,</span><span class="n">t1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ln3_s0</span><span class="o">.</span><span class="n">set_data</span><span class="p">([</span><span class="n">t1</span><span class="p">,</span><span class="n">t1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ln4_s0</span><span class="o">.</span><span class="n">set_data</span><span class="p">([</span><span class="n">t1</span><span class="p">,</span><span class="n">t1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax4</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">())</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ln1_e0</span><span class="o">.</span><span class="n">set_data</span><span class="p">([</span><span class="n">t2</span><span class="p">,</span><span class="n">t2</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax1</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ln2_e0</span><span class="o">.</span><span class="n">set_data</span><span class="p">([</span><span class="n">t2</span><span class="p">,</span><span class="n">t2</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ln3_e0</span><span class="o">.</span><span class="n">set_data</span><span class="p">([</span><span class="n">t2</span><span class="p">,</span><span class="n">t2</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ln4_e0</span><span class="o">.</span><span class="n">set_data</span><span class="p">([</span><span class="n">t2</span><span class="p">,</span><span class="n">t2</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax4</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">())</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ln1_s1</span><span class="o">.</span><span class="n">set_data</span><span class="p">([</span><span class="n">t3</span><span class="p">,</span><span class="n">t3</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax1</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ln2_s1</span><span class="o">.</span><span class="n">set_data</span><span class="p">([</span><span class="n">t3</span><span class="p">,</span><span class="n">t3</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ln3_s1</span><span class="o">.</span><span class="n">set_data</span><span class="p">([</span><span class="n">t3</span><span class="p">,</span><span class="n">t3</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ln4_s1</span><span class="o">.</span><span class="n">set_data</span><span class="p">([</span><span class="n">t3</span><span class="p">,</span><span class="n">t3</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax4</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">())</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ln1_e1</span><span class="o">.</span><span class="n">set_data</span><span class="p">([</span><span class="n">t4</span><span class="p">,</span><span class="n">t4</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax1</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ln2_e1</span><span class="o">.</span><span class="n">set_data</span><span class="p">([</span><span class="n">t4</span><span class="p">,</span><span class="n">t4</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ln3_e1</span><span class="o">.</span><span class="n">set_data</span><span class="p">([</span><span class="n">t4</span><span class="p">,</span><span class="n">t4</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ln4_e1</span><span class="o">.</span><span class="n">set_data</span><span class="p">([</span><span class="n">t4</span><span class="p">,</span><span class="n">t4</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax4</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">_reset_click</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">:</span> <span class="n">Any</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;&#39;Reset&#39;を押したときにsliderの値をを初期値にリセット</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">t1</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">t2</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Time</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sliders</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">t1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sliders</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">t2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_update_xlim</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span><span class="n">t2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_update_ylim</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span><span class="n">t2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fig_canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_lock_click</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;&#39;Lock&#39;を押したときにsliderの相対位置を固定</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">t1</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sliders</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">t2</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sliders</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t_lock</span> <span class="o">=</span> <span class="n">t2</span><span class="o">-</span><span class="n">t1</span>

    <span class="k">def</span> <span class="nf">_increment_click</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;&#39;Increment&#39;を押したときに描画範囲や&#39;start time&#39;や&#39;end time&#39;を自動的に変更</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">increment</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">increment</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
        <span class="n">t1</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sliders</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="o">+</span> <span class="n">increment</span>
        <span class="n">t2</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sliders</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="o">+</span> <span class="n">increment</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sliders</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">t1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sliders</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">t2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_update_xlim</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span><span class="n">t2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_update_ylim</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span><span class="n">t2</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_start</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
            <span class="n">x_start</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time_start</span><span class="o">.</span><span class="n">get</span><span class="p">())</span> <span class="o">+</span> <span class="n">increment</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_update_start_time</span><span class="p">(</span><span class="n">x_start</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_end</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
            <span class="n">x_end</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time_end</span><span class="o">.</span><span class="n">get</span><span class="p">())</span> <span class="o">+</span> <span class="n">increment</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_update_end_time</span><span class="p">(</span><span class="n">x_end</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fig_canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_reflection_exp_idx</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;描画にexp_idxを反映させる</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">sidx0</span><span class="p">,</span> <span class="n">eidx0</span><span class="p">,</span> <span class="n">sidx1</span><span class="p">,</span> <span class="n">eidx1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ExpData</span><span class="o">.</span><span class="n">Index</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
        <span class="n">t1</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Time</span><span class="p">[</span><span class="n">sidx0</span><span class="p">]</span>
        <span class="n">t2</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Time</span><span class="p">[</span><span class="n">eidx0</span><span class="p">]</span>
        <span class="n">t3</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Time</span><span class="p">[</span><span class="n">sidx1</span><span class="p">]</span>
        <span class="n">t4</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Time</span><span class="p">[</span><span class="n">eidx1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sliders</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">t1</span><span class="o">-</span><span class="mi">30</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sliders</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">t4</span><span class="o">+</span><span class="mi">30</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_update_xlim</span><span class="p">(</span><span class="n">t1</span><span class="o">-</span><span class="mi">30</span><span class="p">,</span><span class="n">t4</span><span class="o">+</span><span class="mi">30</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_update_ylim</span><span class="p">(</span><span class="n">t1</span><span class="o">-</span><span class="mi">30</span><span class="p">,</span><span class="n">t4</span><span class="o">+</span><span class="mi">30</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_update_exp_line</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span><span class="n">t2</span><span class="p">,</span><span class="n">t3</span><span class="p">,</span><span class="n">t4</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">now_idx_value</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">kxx</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ExpData</span><span class="o">.</span><span class="n">kxx</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kxx_value</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">kxx</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_update_click</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;&#39;Update&#39;を押したときに描画範囲を自動的に変更</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">now</span><span class="p">:</span> <span class="nb">int</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">exp_idx</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">exp_idx</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">now</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">now</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">exp_idx</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_reflection_exp_idx</span><span class="p">(</span><span class="n">now</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fig_canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_prev_click</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;&#39;Prev&#39;を押したときに描画範囲を自動的に変更</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">value</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">now_idx_value</span><span class="o">.</span><span class="n">get</span><span class="p">())</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_reflection_exp_idx</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fig_canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_next_click</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;&#39;Next&#39;を押したときに描画範囲を自動的に変更</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">value</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ExpData</span><span class="o">.</span><span class="n">Index</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">now_idx_value</span><span class="o">.</span><span class="n">get</span><span class="p">())</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_reflection_exp_idx</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fig_canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_select_range_by_click_click</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;&#39;select range by click&#39;をclickしたときに&#39;is_select_range_by_click&#39;を変更</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_select_range_by_click</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">is_select_range_by_click</span><span class="o">.</span><span class="n">get</span><span class="p">()</span><span class="o">^</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_calc_click</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">:</span> <span class="n">Any</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;&#39;Calc&#39;ボタンをクリックしたときに&#39;start time&#39;から&#39;end time&#39;の各物理量の平均値と標準偏差を計算</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">t_start</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time_start</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
        <span class="n">t_end</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time_end</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
        <span class="n">idx</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">t</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Time</span><span class="p">)</span> <span class="k">if</span> <span class="n">t_start</span> <span class="o">&lt;=</span> <span class="n">t</span> <span class="o">&lt;=</span> <span class="n">t_end</span><span class="p">]</span>
        <span class="n">now_H</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">Field</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">idx</span><span class="p">]</span>
        <span class="n">ave_H</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">now_H</span><span class="p">)</span>
        <span class="n">std_H</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">now_H</span><span class="p">)</span>

        <span class="n">now_Cernox_temp</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">CernoxTemp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">idx</span><span class="p">]</span>
        <span class="n">ave_Cernox_temp</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">now_Cernox_temp</span><span class="p">)</span>
        <span class="n">std_Cernox_temp</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">now_Cernox_temp</span><span class="p">)</span>
        
        <span class="n">now_dTx</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">dTx</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">idx</span><span class="p">]</span>
        <span class="n">ave_dTx</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">now_dTx</span><span class="p">)</span>
        <span class="n">std_dTx</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">now_dTx</span><span class="p">)</span>

        <span class="n">now_dTy</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">dTy</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">idx</span><span class="p">]</span>
        <span class="n">ave_dTy</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">now_dTy</span><span class="p">)</span>
        <span class="n">std_dTy</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">now_dTy</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">field_value</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ave_H</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> ± </span><span class="si">{</span><span class="n">std_H</span><span class="si">:</span><span class="s2">.2g</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Cernox_temp_value</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ave_Cernox_temp</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> ± </span><span class="si">{</span><span class="n">std_Cernox_temp</span><span class="si">:</span><span class="s2">.2g</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dTx_value</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ave_dTx</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> ± </span><span class="si">{</span><span class="n">std_dTx</span><span class="si">:</span><span class="s2">.2g</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dTy_value</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ave_dTy</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> ± </span><span class="si">{</span><span class="n">std_dTy</span><span class="si">:</span><span class="s2">.2g</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="nf">_save_click</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;&#39;Save&#39;ボタンをクリックしたときに&#39;start time&#39;から&#39;end time&#39;の各物理量の平均値と</span>
<span class="sd">            標準偏差を指定したファイルに保存</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filename_to_save</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">t_start</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time_start</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
            <span class="n">t_end</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time_end</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
            <span class="n">idx</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">t</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Time</span><span class="p">)</span> <span class="k">if</span> <span class="n">t_start</span> <span class="o">&lt;=</span> <span class="n">t</span> <span class="o">&lt;=</span> <span class="n">t_end</span><span class="p">]</span>

            <span class="n">now_H</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">Field</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">idx</span><span class="p">]</span>
            <span class="n">ave_H</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">now_H</span><span class="p">)</span>
            <span class="n">std_H</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">now_H</span><span class="p">)</span>

            <span class="n">now_Cernox_temp</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">CernoxTemp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">idx</span><span class="p">]</span>
            <span class="n">ave_Cernox_temp</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">now_Cernox_temp</span><span class="p">)</span>
            <span class="n">std_Cernox_temp</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">now_Cernox_temp</span><span class="p">)</span>
            
            <span class="n">now_dTx</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">dTx</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">idx</span><span class="p">]</span>
            <span class="n">ave_dTx</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">now_dTx</span><span class="p">)</span>
            <span class="n">std_dTx</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">now_dTx</span><span class="p">)</span>

            <span class="n">now_dTy</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">dTy</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">idx</span><span class="p">]</span>
            <span class="n">ave_dTy</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">now_dTy</span><span class="p">)</span>
            <span class="n">std_dTy</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">now_dTy</span><span class="p">)</span>

            <span class="n">res</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="p">[</span><span class="n">t_start</span><span class="p">,</span> <span class="n">t_end</span><span class="p">,</span> 
                                <span class="n">ave_H</span><span class="p">,</span> <span class="n">std_H</span><span class="p">,</span> 
                                <span class="n">ave_Cernox_temp</span><span class="p">,</span> <span class="n">std_Cernox_temp</span><span class="p">,</span>
                                <span class="n">ave_dTx</span><span class="p">,</span> <span class="n">std_dTx</span><span class="p">,</span>
                                <span class="n">ave_dTy</span><span class="p">,</span> <span class="n">std_dTy</span><span class="p">]))</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;failed: save data&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_print_click</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;&#39;Print&#39;ボタンをクリックしたときに&#39;start time&#39;から&#39;end time&#39;の各物理量の平均値と</span>
<span class="sd">            標準偏差を所定の形式で出力</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">print_mode</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t_s0</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t_e0</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t_s1</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t_e1</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_expfit_click</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;&#39;ExpFit&#39;ボタンをクリックしたときに&#39;start time&#39;から&#39;end time&#39;のdTxを</span>
<span class="sd">            f(t) := A exp(-(t-t_start)/τ) + B</span>
<span class="sd">            でフィッティングしたときの緩和時間τの計算</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">t_start</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time_start</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
            <span class="n">t_end</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time_end</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
            <span class="n">idx</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">t</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Time</span><span class="p">)</span> <span class="k">if</span> <span class="n">t_start</span> <span class="o">&lt;=</span> <span class="n">t</span> <span class="o">&lt;=</span> <span class="n">t_end</span><span class="p">]</span>

            
            <span class="n">X</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">Time</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">idx</span><span class="p">])</span>
            <span class="n">Y</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">dTx</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">idx</span><span class="p">])</span>
            <span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">t</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">A</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">B</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">tau</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">A</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="n">t_start</span><span class="p">)</span><span class="o">/</span><span class="n">tau</span><span class="p">)</span> <span class="o">+</span> <span class="n">B</span>

            <span class="n">param</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">curve_fit</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># 返り値はtuple(np.ndarray(#パラメータの値),np.ndarray(#パラメータの標準偏差))</span>
            <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">tau</span> <span class="o">=</span> <span class="n">param</span>
            <span class="n">tau_1percent</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="o">-</span><span class="n">tau</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">0.01</span><span class="p">)</span> <span class="c1"># 収束先からの偏差が1％になるまでの時間</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">relaxation_time</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">tau_1percent</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">expfit_dTx</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="o">*</span><span class="n">param</span><span class="p">))</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;parameters: A:</span><span class="si">{</span><span class="n">A</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> (K), B:</span><span class="si">{</span><span class="n">B</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> (K), tau:</span><span class="si">{</span><span class="n">tau</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">, &lt;1%: </span><span class="si">{</span><span class="n">tau_1percent</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;failed: fit data&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_slider_scroll</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">:</span> <span class="n">Any</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;sliderを変化させたときにx座標の描画範囲を変更</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">t1</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sliders</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">t2</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sliders</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_locked</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">t2</span> <span class="o">!=</span> <span class="n">t1</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">t_lock</span><span class="p">:</span>
                <span class="n">t2</span> <span class="o">=</span> <span class="n">t1</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">t_lock</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">sliders</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">t2</span><span class="p">)</span>
        <span class="c1"># 描画範囲を更新</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_update_xlim</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span><span class="n">t2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_update_ylim</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span><span class="n">t2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fig_canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_fig_hover</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;figure領域をマウスオーバーしたときにそのx座標に対応する縦線を描画</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">x</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">xdata</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ln1_hover</span><span class="o">.</span><span class="n">set_data</span><span class="p">([</span><span class="n">x</span><span class="p">,</span><span class="n">x</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax1</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ln2_hover</span><span class="o">.</span><span class="n">set_data</span><span class="p">([</span><span class="n">x</span><span class="p">,</span><span class="n">x</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ln3_hover</span><span class="o">.</span><span class="n">set_data</span><span class="p">([</span><span class="n">x</span><span class="p">,</span><span class="n">x</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ln4_hover</span><span class="o">.</span><span class="n">set_data</span><span class="p">([</span><span class="n">x</span><span class="p">,</span><span class="n">x</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax4</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fig_canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_fig_click</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;figure領域をclickしたときにそのx座標に対応する縦線を描画</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">x</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">xdata</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">print_mode</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">t0</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_select_range_by_click</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_or_end</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">t0</span> <span class="o">=</span> <span class="n">x</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">t_s0</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">x</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">t1</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_select_range_by_click</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_or_end</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">t1</span> <span class="o">=</span> <span class="n">x</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">t_e0</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">x</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">t0</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">t1</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">idx</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">t</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Time</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">t0</span> <span class="o">&lt;=</span> <span class="n">t</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">t1</span><span class="p">]</span>
                <span class="n">sidx</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">idx</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">eidx</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">idx</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">data0</span> <span class="o">=</span> <span class="p">[</span><span class="n">sidx</span><span class="p">,</span> <span class="n">eidx</span><span class="p">]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ave_std</span><span class="p">(</span><span class="n">sidx</span><span class="p">,</span> <span class="n">eidx</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">t0</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">t1</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">print_mode</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">print_mode</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">t0</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_select_range_by_click</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_or_end</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">t0</span> <span class="o">=</span> <span class="n">x</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">t_s1</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">x</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">t1</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_select_range_by_click</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_or_end</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">t1</span> <span class="o">=</span> <span class="n">x</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">t_e1</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">x</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">t0</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">t1</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">idx</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">t</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Time</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">t0</span> <span class="o">&lt;=</span> <span class="n">t</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">t1</span><span class="p">]</span>
                <span class="n">sidx</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">idx</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">eidx</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">idx</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">data1</span> <span class="o">=</span> <span class="p">[</span><span class="n">sidx</span><span class="p">,</span> <span class="n">eidx</span><span class="p">]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ave_std</span><span class="p">(</span><span class="n">sidx</span><span class="p">,</span> <span class="n">eidx</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">t0</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">t1</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">print_mode</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">sidx0</span><span class="p">,</span> <span class="n">eidx0</span><span class="p">,</span> <span class="n">tp0</span><span class="p">,</span> <span class="n">etp0</span><span class="p">,</span> <span class="n">h0</span><span class="p">,</span> <span class="n">eh0</span><span class="p">,</span> <span class="n">cur0</span><span class="p">,</span> <span class="n">ecur0</span><span class="p">,</span> <span class="n">tc0</span><span class="p">,</span> <span class="n">etc0</span><span class="p">,</span> <span class="n">vx0</span><span class="p">,</span> <span class="n">evx0</span><span class="p">,</span> <span class="n">vy0</span><span class="p">,</span> <span class="n">evy0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data0</span>
                <span class="n">sidx1</span><span class="p">,</span> <span class="n">eidx1</span><span class="p">,</span> <span class="n">tp1</span><span class="p">,</span> <span class="n">etp1</span><span class="p">,</span> <span class="n">h1</span><span class="p">,</span> <span class="n">eh1</span><span class="p">,</span> <span class="n">cur1</span><span class="p">,</span> <span class="n">ecur1</span><span class="p">,</span> <span class="n">tc1</span><span class="p">,</span> <span class="n">etc1</span><span class="p">,</span> <span class="n">vx1</span><span class="p">,</span> <span class="n">evx1</span><span class="p">,</span> <span class="n">vy1</span><span class="p">,</span> <span class="n">evy1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data1</span>
                <span class="n">dtx</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="p">(</span><span class="n">vx1</span><span class="o">-</span><span class="n">vx0</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">Seebeck_at_T</span><span class="p">(</span><span class="n">tp1</span><span class="p">)</span>
                <span class="n">errdtx</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="p">(</span><span class="n">evx0</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">evx1</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">Seebeck_at_T</span><span class="p">(</span><span class="n">tp1</span><span class="p">)</span>
                <span class="n">kxx</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="o">*</span><span class="p">(</span><span class="n">cur1</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">Width</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">Thickness</span> <span class="o">/</span> <span class="p">(</span><span class="n">dtx</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">LTx</span><span class="p">)</span>
                <span class="n">errkxx</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">kxx</span> <span class="o">*</span> <span class="n">errdtx</span> <span class="o">/</span> <span class="n">dtx</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Start Index0	End Index0	ave T_PPMS0 (K)	err T_PPMS0 (K)	ave H0 (Oe)	err H0 (Oe)	ave Current0 (mA)	err Current0 (mA)	ave T_Cernox0 (K)	err T_Cernox0 (K)	ave Vx0 (V)	err Vx0 (V)	ave Vy0 (V)	err Vy0 (V)	Start Index1	End Index1	ave T_PPMS1 (K)	err T_PPMS1 (K)	ave H1 (Oe)	err H1 (Oe)	ave Current1 (mA)	err Current1 (mA)	ave T_Cernox1 (K)	err T_Cernox1 (K)	ave Vx1 (V)	err Vx1 (V)	ave Vy1 (V)	err Vy1 (V)	dTx (K)	err dTx (K)	kxx (W/Km)	err kxx (W/Km)&quot;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data0</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">data1</span><span class="o">+</span><span class="p">[</span><span class="n">dtx</span><span class="p">,</span> <span class="n">errdtx</span><span class="p">,</span> <span class="n">kxx</span><span class="p">,</span> <span class="n">errkxx</span><span class="p">])))</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_select_range_by_click</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_or_end</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_update_start_time</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fig_canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_update_end_time</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fig_canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
    
<div class="viewcode-block" id="AATTPMD.ave_std"><a class="viewcode-back" href="../../../cpystal.analysis.html#cpystal.analysis.thermal_conduction.AATTPMD.ave_std">[docs]</a>    <span class="k">def</span> <span class="nf">ave_std</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sidx</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">eidx</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="o">...</span><span class="p">]:</span>
        <span class="n">slc</span><span class="p">:</span> <span class="nb">slice</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">sidx</span><span class="p">,</span> <span class="n">eidx</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">attr_cor_to_V</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">attr_cor_to_V</span>
        <span class="n">aveT_PPMS</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PPMSTemp</span><span class="p">[</span><span class="n">slc</span><span class="p">])</span>
        <span class="n">errT_PPMS</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PPMSTemp</span><span class="p">[</span><span class="n">slc</span><span class="p">])</span>
        <span class="n">aveH</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Field</span><span class="p">[</span><span class="n">slc</span><span class="p">])</span>
        <span class="n">errH</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Field</span><span class="p">[</span><span class="n">slc</span><span class="p">])</span>
        <span class="n">aveCurrent</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">HeaterCurrent</span><span class="p">[</span><span class="n">slc</span><span class="p">])</span>
        <span class="n">errCurrent</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">HeaterCurrent</span><span class="p">[</span><span class="n">slc</span><span class="p">])</span>
        <span class="n">aveT_Cernox</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">CernoxTemp</span><span class="p">[</span><span class="n">slc</span><span class="p">])</span>
        <span class="n">errT_Cernox</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">CernoxTemp</span><span class="p">[</span><span class="n">slc</span><span class="p">])</span>
        <span class="n">Vs</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">V1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">V2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">V3</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">V4</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">V5</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">V6</span><span class="p">]</span>
        <span class="n">aveVx</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">Vs</span><span class="p">[</span><span class="n">attr_cor_to_V</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="n">slc</span><span class="p">])</span>
        <span class="n">errVx</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">Vs</span><span class="p">[</span><span class="n">attr_cor_to_V</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="n">slc</span><span class="p">])</span>
        <span class="n">aveVy</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">Vs</span><span class="p">[</span><span class="n">attr_cor_to_V</span><span class="p">[</span><span class="mi">2</span><span class="p">]][</span><span class="n">slc</span><span class="p">])</span>
        <span class="n">errVy</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">Vs</span><span class="p">[</span><span class="n">attr_cor_to_V</span><span class="p">[</span><span class="mi">2</span><span class="p">]][</span><span class="n">slc</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">aveT_PPMS</span><span class="p">,</span> <span class="n">errT_PPMS</span><span class="p">,</span> <span class="n">aveH</span><span class="p">,</span> <span class="n">errH</span><span class="p">,</span> <span class="n">aveCurrent</span><span class="p">,</span> <span class="n">errCurrent</span><span class="p">,</span> <span class="n">aveT_Cernox</span><span class="p">,</span> <span class="n">errT_Cernox</span><span class="p">,</span> <span class="n">aveVx</span><span class="p">,</span> <span class="n">errVx</span><span class="p">,</span> <span class="n">aveVy</span><span class="p">,</span> <span class="n">errVy</span></div>

<div class="viewcode-block" id="AATTPMD.excute"><a class="viewcode-back" href="../../../cpystal.analysis.html#cpystal.analysis.thermal_conduction.AATTPMD.excute">[docs]</a>    <span class="k">def</span> <span class="nf">excute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">save_filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">Tx_gain</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;アプリを実行</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">save_filename</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">filename_to_save</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">tk</span><span class="o">.</span><span class="n">END</span><span class="p">,</span> <span class="n">save_filename</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">mainloop</span><span class="p">()</span></div>
    
<div class="viewcode-block" id="AATTPMD.delete"><a class="viewcode-back" href="../../../cpystal.analysis.html#cpystal.analysis.thermal_conduction.AATTPMD.delete">[docs]</a>    <span class="k">def</span> <span class="nf">delete</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="n">destroy</span><span class="p">()</span></div></div>


<div class="viewcode-block" id="HistoryOfTTM"><a class="viewcode-back" href="../../../cpystal.analysis.html#cpystal.analysis.thermal_conduction.HistoryOfTTM">[docs]</a><span class="k">class</span> <span class="nc">HistoryOfTTM</span><span class="p">(</span><span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;History of Thermal Transport Measurement</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename_Seebeck</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">cernox_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">foldername</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">attr_cor_to_V</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">foldername</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">foldername</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
        <span class="n">filenames</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">foldername</span><span class="o">+</span><span class="s2">&quot;/*&quot;</span><span class="p">):</span>
            <span class="k">if</span> <span class="s2">&quot;Raw&quot;</span> <span class="ow">in</span> <span class="n">filename</span><span class="p">:</span>
                <span class="n">filenames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        <span class="n">filenames</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">filenames</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">start_time_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">RDE</span><span class="p">:</span> <span class="n">RawDataExpander</span> <span class="o">=</span> <span class="n">RawDataExpander</span><span class="p">(</span><span class="n">filenames</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">filename_Seebeck</span><span class="p">)</span>
        <span class="n">RDE</span><span class="o">.</span><span class="n">kxxkxy_mode</span><span class="p">(</span><span class="n">cernox_name</span><span class="p">,</span> <span class="n">attr_cor_to_V</span><span class="p">)</span>
        <span class="n">EDE</span><span class="p">:</span> <span class="n">ExpDataExpander</span> <span class="o">=</span> <span class="n">ExpDataExpander</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Raw&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;Exp&quot;</span><span class="p">,</span> <span class="n">filenames</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">filename_Seebeck</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">filenames</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
            <span class="n">R</span><span class="p">:</span> <span class="n">RawDataExpander</span> <span class="o">=</span> <span class="n">RawDataExpander</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">filename_Seebeck</span><span class="p">)</span>
            <span class="n">R</span><span class="o">.</span><span class="n">kxxkxy_mode</span><span class="p">(</span><span class="n">cernox_name</span><span class="p">,</span> <span class="n">attr_cor_to_V</span><span class="p">)</span>
            <span class="n">E</span><span class="p">:</span> <span class="n">ExpDataExpander</span> <span class="o">=</span> <span class="n">ExpDataExpander</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Raw&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;Exp&quot;</span><span class="p">,</span> <span class="n">filename</span><span class="p">),</span> <span class="n">filename_Seebeck</span><span class="p">)</span>
            <span class="n">RDE</span> <span class="o">=</span> <span class="n">RDE</span> <span class="o">+</span> <span class="n">R</span>
            <span class="n">EDE</span> <span class="o">=</span> <span class="n">EDE</span> <span class="o">+</span> <span class="n">E</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">start_time_list</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">R</span><span class="o">.</span><span class="n">StartTime</span><span class="o">-</span><span class="n">RDE</span><span class="o">.</span><span class="n">StartTime</span><span class="p">)</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="p">:</span> <span class="n">RawDataExpander</span> <span class="o">=</span> <span class="n">RDE</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ExpData</span><span class="p">:</span> <span class="n">ExpDataExpander</span> <span class="o">=</span> <span class="n">EDE</span>

        <span class="n">root</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Tk</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Tk</span><span class="p">()</span>
        <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">root</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Tk</span> <span class="o">=</span> <span class="n">root</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">foldername</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="n">geometry</span><span class="p">(</span><span class="s1">&#39;1500x900&#39;</span><span class="p">)</span>

        <span class="c1">#-----------------------------------------------</span>

        <span class="c1"># matplotlib配置用フレーム</span>
        <span class="n">mtpltlb_frame</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">14</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.family&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Arial&#39;</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;xtick.direction&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;in&#39;</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;ytick.direction&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;in&#39;</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;legend.framealpha&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;legend.fontsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">8</span>

        <span class="n">figsize</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
        <span class="n">fig</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">Figure</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">wspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.20</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">0.95</span><span class="p">)</span>
        
        <span class="c1"># 磁場</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax1</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">Subplot</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">411</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax1</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax1</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
        <span class="n">H_threshold</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e5</span>
        <span class="n">H</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">h</span> <span class="k">if</span> <span class="o">-</span><span class="n">H_threshold</span> <span class="o">&lt;</span> <span class="n">h</span> <span class="o">&lt;</span> <span class="n">H_threshold</span> <span class="k">else</span> <span class="n">H_threshold</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="o">.</span><span class="n">Field</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="o">.</span><span class="n">Time</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;Time (sec)&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$H$ (Oe)&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax1</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticklabels</span><span class="p">([])</span> <span class="c1"># 目盛を削除</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">foldername</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="c1"># 温度</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">Subplot</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">412</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
        <span class="n">T_threshold</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">500</span>
        <span class="n">T_cernox</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">t</span> <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;</span> <span class="n">t</span> <span class="o">&lt;</span> <span class="n">T_threshold</span> <span class="k">else</span> <span class="n">T_threshold</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="o">.</span><span class="n">CernoxTemp</span><span class="p">]</span>
        <span class="n">T_ppms</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">t</span> <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;</span> <span class="n">t</span> <span class="o">&lt;</span> <span class="n">T_threshold</span> <span class="k">else</span> <span class="n">T_threshold</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="o">.</span><span class="n">PPMSTemp</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="o">.</span><span class="n">Time</span><span class="p">,</span> <span class="n">T_cernox</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="o">.</span><span class="n">Time</span><span class="p">,</span> <span class="n">T_ppms</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;Time (sec)&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$T$ (K)&quot;</span><span class="o">+</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> Cernox:blue</span><span class="se">\n</span><span class="s2"> PPMS:red&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticklabels</span><span class="p">([])</span> <span class="c1"># 目盛を削除</span>
        <span class="c1"># dTx</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">Subplot</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">413</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="o">.</span><span class="n">Time</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="o">.</span><span class="n">dTx</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;Time (sec)&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$\Delta T_</span><span class="si">{x}</span><span class="s2">$ (K)&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticklabels</span><span class="p">([])</span> <span class="c1"># 目盛を削除</span>
        <span class="c1"># dTy</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax4</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">Subplot</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">414</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax4</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax4</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax4</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="o">.</span><span class="n">Time</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="o">.</span><span class="n">dTy</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax4</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;Time (sec)&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax4</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$\Delta T_</span><span class="si">{y}</span><span class="s2">$ (K)&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">adjust_tickslabel</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="o">.</span><span class="n">Time</span><span class="p">))</span>

        <span class="c1"># マウスのhoverで描画する縦線</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ln1_hover</span><span class="p">,</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">([],[],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ln2_hover</span><span class="p">,</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">([],[],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ln3_hover</span><span class="p">,</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">([],[],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ln4_hover</span><span class="p">,</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax4</span><span class="o">.</span><span class="n">plot</span><span class="p">([],[],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        
        <span class="c1"># マウスのclickで描画する縦線</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ln1_start</span><span class="p">,</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">([],[],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ln2_start</span><span class="p">,</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">([],[],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ln3_start</span><span class="p">,</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">([],[],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ln4_start</span><span class="p">,</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax4</span><span class="o">.</span><span class="n">plot</span><span class="p">([],[],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="c1"># マウスのclickで描画する縦線</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ln1_end</span><span class="p">,</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">([],[],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ln2_end</span><span class="p">,</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">([],[],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ln3_end</span><span class="p">,</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">([],[],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ln4_end</span><span class="p">,</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax4</span><span class="o">.</span><span class="n">plot</span><span class="p">([],[],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="c1"># 指定されたsidx0, eidx0, sidx1, eidx1に対応する縦線</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ln1_s0</span><span class="p">,</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">([],[],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ln2_s0</span><span class="p">,</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">([],[],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ln3_s0</span><span class="p">,</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">([],[],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ln4_s0</span><span class="p">,</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax4</span><span class="o">.</span><span class="n">plot</span><span class="p">([],[],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ln1_e0</span><span class="p">,</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">([],[],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;orange&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ln2_e0</span><span class="p">,</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">([],[],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;orange&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ln3_e0</span><span class="p">,</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">([],[],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;orange&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ln4_e0</span><span class="p">,</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax4</span><span class="o">.</span><span class="n">plot</span><span class="p">([],[],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;orange&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ln1_s1</span><span class="p">,</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">([],[],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ln2_s1</span><span class="p">,</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">([],[],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ln3_s1</span><span class="p">,</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">([],[],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ln4_s1</span><span class="p">,</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax4</span><span class="o">.</span><span class="n">plot</span><span class="p">([],[],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ln1_e1</span><span class="p">,</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">([],[],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;orange&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ln2_e1</span><span class="p">,</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">([],[],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;orange&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ln3_e1</span><span class="p">,</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">([],[],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;orange&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ln4_e1</span><span class="p">,</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax4</span><span class="o">.</span><span class="n">plot</span><span class="p">([],[],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;orange&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="c1"># 指数関数fitting用</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">expfit_dTx</span><span class="p">,</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">([],[],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;cyan&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>

        <span class="c1"># Rawファイルごとに区切る線</span>
        <span class="n">ylim1</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax1</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>
        <span class="n">ylim2</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>
        <span class="n">ylim3</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>
        <span class="n">ylim4</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax4</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_time_list</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">s</span><span class="p">,</span><span class="n">s</span><span class="p">],</span> <span class="n">ylim1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">s</span><span class="p">,</span><span class="n">s</span><span class="p">],</span> <span class="n">ylim2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">s</span><span class="p">,</span><span class="n">s</span><span class="p">],</span> <span class="n">ylim3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax4</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">s</span><span class="p">,</span><span class="n">s</span><span class="p">],</span> <span class="n">ylim4</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ylim1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ylim2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ylim3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax4</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ylim4</span><span class="p">)</span>

        <span class="c1"># figとFrameの対応付け</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fig_canvas</span><span class="p">:</span> <span class="n">FigureCanvasTkAgg</span> <span class="o">=</span> <span class="n">FigureCanvasTkAgg</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">mtpltlb_frame</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">toolbar</span><span class="p">:</span> <span class="n">NavigationToolbar2Tk</span> <span class="o">=</span> <span class="n">NavigationToolbar2Tk</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fig_canvas</span><span class="p">,</span> <span class="n">mtpltlb_frame</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cid1</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">mpl_connect</span><span class="p">(</span><span class="s1">&#39;button_press_event&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fig_click</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cid2</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">mpl_connect</span><span class="p">(</span><span class="s1">&#39;motion_notify_event&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fig_hover</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fig_canvas</span><span class="o">.</span><span class="n">get_tk_widget</span><span class="p">()</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">expand</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">side</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">LEFT</span><span class="p">)</span>

        <span class="n">mtpltlb_frame</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">LEFT</span><span class="p">)</span>

        <span class="c1">#-----------------------------------------------</span>
        <span class="c1">### sliderを生成</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sliders</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">tk</span><span class="o">.</span><span class="n">DoubleVar</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">tk</span><span class="o">.</span><span class="n">DoubleVar</span><span class="p">(),</span> <span class="n">tk</span><span class="o">.</span><span class="n">DoubleVar</span><span class="p">()]</span>
        <span class="n">slider0</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Scale</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="p">,</span>
                    <span class="n">variable</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sliders</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                    <span class="n">command</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_slider_scroll</span><span class="p">,</span>
                    <span class="n">orient</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">HORIZONTAL</span><span class="p">,</span>
                    <span class="n">length</span> <span class="o">=</span> <span class="mi">300</span><span class="p">,</span>
                    <span class="n">width</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span>
                    <span class="n">sliderlength</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
                    <span class="n">from_</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                    <span class="n">to</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="o">.</span><span class="n">Time</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span>
                    <span class="n">resolution</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
                    <span class="n">tickinterval</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="p">)</span>
        <span class="n">slider0</span><span class="o">.</span><span class="n">pack</span><span class="p">()</span>

        <span class="n">slider1</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Scale</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="p">,</span>
                    <span class="n">variable</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sliders</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                    <span class="n">command</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_slider_scroll</span><span class="p">,</span>
                    <span class="n">orient</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">HORIZONTAL</span><span class="p">,</span>
                    <span class="n">length</span> <span class="o">=</span> <span class="mi">300</span><span class="p">,</span>
                    <span class="n">width</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span>
                    <span class="n">sliderlength</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
                    <span class="n">from_</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                    <span class="n">to</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="o">.</span><span class="n">Time</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span>
                    <span class="n">resolution</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
                    <span class="n">tickinterval</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="p">)</span>
        <span class="n">slider1</span><span class="o">.</span><span class="n">pack</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sliders</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sliders</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="o">.</span><span class="n">Time</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>

        <span class="c1">#-----------------------------------------------</span>
        <span class="c1">### slider制御のFrame</span>
        <span class="n">slider_control_frame</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="p">,</span> <span class="n">borderwidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">relief</span><span class="o">=</span><span class="s2">&quot;ridge&quot;</span><span class="p">)</span>
        <span class="c1"># resetボタン</span>
        <span class="n">reset_button</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">slider_control_frame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Reset&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_reset_click</span><span class="p">)</span>
        <span class="n">reset_button</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

        <span class="c1"># 相対位置固定チェックボタン</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t_lock</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_locked</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">BooleanVar</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">BooleanVar</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_locked</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">lock_cbutton</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Checkbutton</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Checkbutton</span><span class="p">(</span><span class="n">slider_control_frame</span><span class="p">,</span> <span class="n">variable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">is_locked</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Lock&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_lock_click</span><span class="p">)</span>
        <span class="n">lock_cbutton</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

        <span class="c1"># increment関係のFrame</span>
        <span class="n">increment_frame</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="n">slider_control_frame</span><span class="p">,</span> <span class="n">borderwidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">relief</span><span class="o">=</span><span class="s2">&quot;ridge&quot;</span><span class="p">)</span>
        <span class="n">increment_button</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">increment_frame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Increment&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_increment_click</span><span class="p">)</span>
        <span class="n">increment_button</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">increment</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Entry</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="n">increment_frame</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">increment</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">increment_frame</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">rowspan</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">N</span><span class="o">+</span><span class="n">tk</span><span class="o">.</span><span class="n">S</span><span class="p">)</span>

        <span class="c1"># スライダーの値を直接入力</span>
        <span class="k">def</span> <span class="nf">slider_left_changer</span><span class="p">(</span><span class="n">var</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">idx</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">mode</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sliders</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">slider_left_value</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_slider_scroll</span><span class="p">()</span>
        <span class="k">def</span> <span class="nf">slider_right_changer</span><span class="p">(</span><span class="n">var</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">idx</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">mode</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sliders</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">slider_right_value</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_slider_scroll</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">slider_left_value</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">DoubleVar</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">DoubleVar</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">slider_left_value</span><span class="o">.</span><span class="n">trace_add</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s2">&quot;write&quot;</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="n">slider_left_changer</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">slider_left</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Entry</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="n">slider_control_frame</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">slider_left_value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">slider_left</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">slider_right_value</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">DoubleVar</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">DoubleVar</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">slider_right_value</span><span class="o">.</span><span class="n">trace_add</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s2">&quot;write&quot;</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="n">slider_right_changer</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">slider_right</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Entry</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="n">slider_control_frame</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">slider_right_value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">slider_right</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

        <span class="n">slider_control_frame</span><span class="o">.</span><span class="n">pack</span><span class="p">()</span>


        <span class="c1">#-----------------------------------------------</span>
        <span class="c1">### データ解析のFrame</span>
        <span class="n">analysis_frame</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="p">,</span> <span class="n">borderwidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">relief</span><span class="o">=</span><span class="s2">&quot;ridge&quot;</span><span class="p">)</span>

        <span class="c1"># # データsave先のfilename</span>
        <span class="c1"># lbl_filename: tk.Label = tk.Label(analysis_frame, text=&quot;save filename&quot;)</span>
        <span class="c1"># lbl_filename.pack()</span>
        <span class="c1"># self.filename_to_save: tk.Entry = tk.Entry(analysis_frame, width=20)</span>
        <span class="c1"># self.filename_to_save.pack()</span>

        <span class="c1"># 測定番号を元に時間範囲を指定するFrame</span>
        <span class="n">exp_idx_frame</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="n">analysis_frame</span><span class="p">,</span> <span class="n">borderwidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">relief</span><span class="o">=</span><span class="s2">&quot;ridge&quot;</span><span class="p">)</span>
        <span class="n">lbl_exp_idx</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">exp_idx_frame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Exp index&quot;</span><span class="p">,</span> <span class="n">foreground</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
        <span class="n">lbl_exp_idx</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">exp_idx</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Entry</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="n">exp_idx_frame</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">exp_idx</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">lbl_now_idx</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">exp_idx_frame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;now index&quot;</span><span class="p">,</span> <span class="n">foreground</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
        <span class="n">lbl_now_idx</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">now_idx_value</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">now_idx_value</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;0&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lbl_now_idx_value</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">exp_idx_frame</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">now_idx_value</span><span class="p">,</span> <span class="n">relief</span><span class="o">=</span><span class="s2">&quot;sunken&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lbl_now_idx_value</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">update_button</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">exp_idx_frame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Update&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_update_click</span><span class="p">)</span>
        <span class="n">update_button</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">prev_button</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">exp_idx_frame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Prev&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_prev_click</span><span class="p">)</span>
        <span class="n">prev_button</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">next_button</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">exp_idx_frame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Next&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_next_click</span><span class="p">)</span>
        <span class="n">next_button</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">lbl_kxx</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">exp_idx_frame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;kxx (W/Km)&quot;</span><span class="p">)</span>
        <span class="n">lbl_kxx</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kxx_value</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lbl_kxx_value</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">exp_idx_frame</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kxx_value</span><span class="p">,</span> <span class="n">relief</span><span class="o">=</span><span class="s2">&quot;sunken&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lbl_kxx_value</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">exp_idx_frame</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

        <span class="c1"># データとして使う時間範囲の設定をするためのFrame</span>
        <span class="n">range_frame</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="n">analysis_frame</span><span class="p">,</span> <span class="n">borderwidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">relief</span><span class="o">=</span><span class="s2">&quot;ridge&quot;</span><span class="p">)</span>
        <span class="n">lbl_start</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">range_frame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;start (s)&quot;</span><span class="p">,</span> <span class="n">foreground</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">)</span>
        <span class="n">lbl_start</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_start</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Entry</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="n">range_frame</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_start</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">lbl_end</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">range_frame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;end (s)&quot;</span><span class="p">,</span> <span class="n">foreground</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
        <span class="n">lbl_end</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_end</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Entry</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="n">range_frame</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_end</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">lbl_dt</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">range_frame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;end-start (s)&quot;</span><span class="p">,</span> <span class="n">foreground</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
        <span class="n">lbl_dt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_dt_value</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lbl_time_dt_value</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">range_frame</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">time_dt_value</span><span class="p">,</span> <span class="n">relief</span><span class="o">=</span><span class="s2">&quot;sunken&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lbl_time_dt_value</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">start_or_end</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_select_range_by_click</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">BooleanVar</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">BooleanVar</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_select_range_by_click</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">select_range_by_click_cbutton</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Checkbutton</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Checkbutton</span><span class="p">(</span><span class="n">range_frame</span><span class="p">,</span> <span class="n">variable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">is_select_range_by_click</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;select range by click&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_select_range_by_click_click</span><span class="p">)</span>
        <span class="n">select_range_by_click_cbutton</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">columnspan</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">range_frame</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

        <span class="c1"># データを表示するFrame</span>
        <span class="n">value_frame</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="n">analysis_frame</span><span class="p">,</span> <span class="n">borderwidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">relief</span><span class="o">=</span><span class="s2">&quot;ridge&quot;</span><span class="p">)</span>
        <span class="n">lbl_field</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">value_frame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;H (Oe)&quot;</span><span class="p">)</span>
        <span class="n">lbl_field</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">field_value</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lbl_field_value</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">value_frame</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">field_value</span><span class="p">,</span> <span class="n">relief</span><span class="o">=</span><span class="s2">&quot;sunken&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lbl_field_value</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">lbl_Cernox_temp</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">value_frame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;T_Cernox (K)&quot;</span><span class="p">)</span>
        <span class="n">lbl_Cernox_temp</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Cernox_temp_value</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lbl_Cernox_temp_value</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">value_frame</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Cernox_temp_value</span><span class="p">,</span> <span class="n">relief</span><span class="o">=</span><span class="s2">&quot;sunken&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lbl_Cernox_temp_value</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">lbl_dTx</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">value_frame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;ΔTx (K)&quot;</span><span class="p">)</span>
        <span class="n">lbl_dTx</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dTx_value</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lbl_dTx_value</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">value_frame</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dTx_value</span><span class="p">,</span> <span class="n">relief</span><span class="o">=</span><span class="s2">&quot;sunken&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lbl_dTx_value</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">lbl_dTy</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">value_frame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;ΔTy (K)&quot;</span><span class="p">)</span>
        <span class="n">lbl_dTy</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dTy_value</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lbl_dTy_value</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">value_frame</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dTy_value</span><span class="p">,</span> <span class="n">relief</span><span class="o">=</span><span class="s2">&quot;sunken&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lbl_dTy_value</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">value_frame</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

        <span class="c1"># 指定した時間範囲のデータを計算させるボタン</span>
        <span class="n">calc_button</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">analysis_frame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Calc&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_calc_click</span><span class="p">)</span>
        <span class="n">calc_button</span><span class="o">.</span><span class="n">pack</span><span class="p">()</span>

        <span class="c1"># # 計算したデータをsaveさせるボタン</span>
        <span class="c1"># save_button: tk.Button = tk.Button(analysis_frame, text=&quot;Save&quot;, command=self._save_click)</span>
        <span class="c1"># save_button.pack()</span>

        <span class="c1"># 選択した範囲から計算したExp形式のデータを標準出力させるFrame</span>
        <span class="n">print_frame</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="n">analysis_frame</span><span class="p">,</span> <span class="n">borderwidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">relief</span><span class="o">=</span><span class="s2">&quot;ridge&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">print_mode</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t0</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t1</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data0</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data1</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">print_button</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">print_frame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Print&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_print_click</span><span class="p">)</span>
        <span class="n">print_button</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">lbl_sidx0</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">print_frame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;t_s0&quot;</span><span class="p">)</span>
        <span class="n">lbl_sidx0</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">lbl_eidx0</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">print_frame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;t_e0&quot;</span><span class="p">)</span>
        <span class="n">lbl_eidx0</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">lbl_sidx1</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">print_frame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;t_s1&quot;</span><span class="p">)</span>
        <span class="n">lbl_sidx1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">lbl_eidx1</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">print_frame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;t_e1&quot;</span><span class="p">)</span>
        <span class="n">lbl_eidx1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t_s0</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lbl_t_s0_value</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">print_frame</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">t_s0</span><span class="p">,</span> <span class="n">relief</span><span class="o">=</span><span class="s2">&quot;sunken&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lbl_t_s0_value</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t_e0</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lbl_t_e0_value</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">print_frame</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">t_e0</span><span class="p">,</span> <span class="n">relief</span><span class="o">=</span><span class="s2">&quot;sunken&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lbl_t_e0_value</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t_s1</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lbl_t_s1_value</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">print_frame</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">t_s1</span><span class="p">,</span> <span class="n">relief</span><span class="o">=</span><span class="s2">&quot;sunken&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lbl_t_s1_value</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t_e1</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lbl_t_e1_value</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">print_frame</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">t_e1</span><span class="p">,</span> <span class="n">relief</span><span class="o">=</span><span class="s2">&quot;sunken&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lbl_t_e1_value</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
        <span class="n">print_frame</span><span class="o">.</span><span class="n">pack</span><span class="p">()</span>

        <span class="c1"># 指定されている範囲を f(t) := A exp(-t/τ) でフィッティングするFrame</span>
        <span class="n">expfit_frame</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="n">analysis_frame</span><span class="p">,</span> <span class="n">borderwidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">relief</span><span class="o">=</span><span class="s2">&quot;ridge&quot;</span><span class="p">)</span>
        <span class="n">expfit_button</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">expfit_frame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;ExpFit&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_expfit_click</span><span class="p">)</span>
        <span class="n">expfit_button</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">lbl_relaxation_time</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">expfit_frame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;τ ln(100) (s)&quot;</span><span class="p">)</span>
        <span class="n">lbl_relaxation_time</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">relaxation_time</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lbl_relaxation_time_value</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">expfit_frame</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">relaxation_time</span><span class="p">,</span> <span class="n">relief</span><span class="o">=</span><span class="s2">&quot;sunken&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lbl_relaxation_time_value</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">expfit_frame</span><span class="o">.</span><span class="n">pack</span><span class="p">()</span>

        <span class="n">analysis_frame</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">pady</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
        <span class="c1">#-----------------------------------------------</span>
    
    <span class="k">def</span> <span class="nf">_update_xlim</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t1</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">t2</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">t1</span> <span class="o">&gt;</span> <span class="n">t2</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax1</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span><span class="n">t2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span><span class="n">t2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span><span class="n">t2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax4</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span><span class="n">t2</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_update_ylim</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t1</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">t2</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">t1</span> <span class="o">&gt;</span> <span class="n">t2</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">lineax1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax1</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">yax1</span> <span class="o">=</span> <span class="n">lineax1</span><span class="o">.</span><span class="n">_yorig</span><span class="p">[</span><span class="n">bisect_left</span><span class="p">(</span><span class="n">lineax1</span><span class="o">.</span><span class="n">_xorig</span><span class="p">,</span><span class="n">t1</span><span class="p">):</span><span class="n">bisect_left</span><span class="p">(</span><span class="n">lineax1</span><span class="o">.</span><span class="n">_xorig</span><span class="p">,</span><span class="n">t2</span><span class="p">)]</span>
            <span class="n">yax1m</span><span class="p">,</span> <span class="n">yax1M</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">yax1</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">yax1</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">yax1m</span> <span class="o">==</span> <span class="n">yax1M</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">yax1m</span><span class="o">-</span><span class="p">(</span><span class="n">yax1M</span><span class="o">-</span><span class="n">yax1m</span><span class="p">)</span><span class="o">*</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">yax1M</span><span class="o">+</span><span class="p">(</span><span class="n">yax1M</span><span class="o">-</span><span class="n">yax1m</span><span class="p">)</span><span class="o">*</span><span class="mf">0.05</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;error in _update_ylim: ax1&quot;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">lineax2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">yax2</span> <span class="o">=</span> <span class="n">lineax2</span><span class="o">.</span><span class="n">_yorig</span><span class="p">[</span><span class="n">bisect_left</span><span class="p">(</span><span class="n">lineax2</span><span class="o">.</span><span class="n">_xorig</span><span class="p">,</span><span class="n">t1</span><span class="p">):</span><span class="n">bisect_left</span><span class="p">(</span><span class="n">lineax2</span><span class="o">.</span><span class="n">_xorig</span><span class="p">,</span><span class="n">t2</span><span class="p">)]</span>
            <span class="n">lineax2_2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">yax2_2</span> <span class="o">=</span> <span class="n">lineax2_2</span><span class="o">.</span><span class="n">_yorig</span><span class="p">[</span><span class="n">bisect_left</span><span class="p">(</span><span class="n">lineax2_2</span><span class="o">.</span><span class="n">_xorig</span><span class="p">,</span><span class="n">t1</span><span class="p">):</span><span class="n">bisect_left</span><span class="p">(</span><span class="n">lineax2_2</span><span class="o">.</span><span class="n">_xorig</span><span class="p">,</span><span class="n">t2</span><span class="p">)]</span>
            <span class="n">yax2m</span><span class="p">,</span> <span class="n">yax2M</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">yax2</span><span class="p">),</span><span class="nb">min</span><span class="p">(</span><span class="n">yax2_2</span><span class="p">)),</span> <span class="nb">max</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">yax2</span><span class="p">),</span><span class="nb">max</span><span class="p">(</span><span class="n">yax2_2</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">yax2m</span><span class="o">-</span><span class="p">(</span><span class="n">yax2M</span><span class="o">-</span><span class="n">yax2m</span><span class="p">)</span><span class="o">*</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">yax2M</span><span class="o">+</span><span class="p">(</span><span class="n">yax2M</span><span class="o">-</span><span class="n">yax2m</span><span class="p">)</span><span class="o">*</span><span class="mf">0.05</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;error in _update_ylim: ax2&quot;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">lineax3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">yax3</span> <span class="o">=</span> <span class="n">lineax3</span><span class="o">.</span><span class="n">_yorig</span><span class="p">[</span><span class="n">bisect_left</span><span class="p">(</span><span class="n">lineax3</span><span class="o">.</span><span class="n">_xorig</span><span class="p">,</span><span class="n">t1</span><span class="p">):</span><span class="n">bisect_left</span><span class="p">(</span><span class="n">lineax3</span><span class="o">.</span><span class="n">_xorig</span><span class="p">,</span><span class="n">t2</span><span class="p">)]</span>
            <span class="n">yax3m</span><span class="p">,</span> <span class="n">yax3M</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">yax3</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">yax3</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">yax3m</span><span class="o">-</span><span class="p">(</span><span class="n">yax3M</span><span class="o">-</span><span class="n">yax3m</span><span class="p">)</span><span class="o">*</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">yax3M</span><span class="o">+</span><span class="p">(</span><span class="n">yax3M</span><span class="o">-</span><span class="n">yax3m</span><span class="p">)</span><span class="o">*</span><span class="mf">0.05</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;error in _update_ylim: ax3&quot;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">lineax4</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax4</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">yax4</span> <span class="o">=</span> <span class="n">lineax4</span><span class="o">.</span><span class="n">_yorig</span><span class="p">[</span><span class="n">bisect_left</span><span class="p">(</span><span class="n">lineax4</span><span class="o">.</span><span class="n">_xorig</span><span class="p">,</span><span class="n">t1</span><span class="p">):</span><span class="n">bisect_left</span><span class="p">(</span><span class="n">lineax4</span><span class="o">.</span><span class="n">_xorig</span><span class="p">,</span><span class="n">t2</span><span class="p">)]</span>
            <span class="n">yax4m</span><span class="p">,</span> <span class="n">yax4M</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">yax4</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">yax4</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax4</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">yax4m</span><span class="o">-</span><span class="p">(</span><span class="n">yax4M</span><span class="o">-</span><span class="n">yax4m</span><span class="p">)</span><span class="o">*</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">yax4M</span><span class="o">+</span><span class="p">(</span><span class="n">yax4M</span><span class="o">-</span><span class="n">yax4m</span><span class="p">)</span><span class="o">*</span><span class="mf">0.05</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;error in _update_ylim: ax4&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_update_start_time</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x_start</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_start</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">tk</span><span class="o">.</span><span class="n">END</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_start</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">tk</span><span class="o">.</span><span class="n">END</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">x_start</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">start_or_end</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ln1_start</span><span class="o">.</span><span class="n">set_data</span><span class="p">([</span><span class="n">x_start</span><span class="p">,</span><span class="n">x_start</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax1</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ln2_start</span><span class="o">.</span><span class="n">set_data</span><span class="p">([</span><span class="n">x_start</span><span class="p">,</span><span class="n">x_start</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ln3_start</span><span class="o">.</span><span class="n">set_data</span><span class="p">([</span><span class="n">x_start</span><span class="p">,</span><span class="n">x_start</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ln4_start</span><span class="o">.</span><span class="n">set_data</span><span class="p">([</span><span class="n">x_start</span><span class="p">,</span><span class="n">x_start</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax4</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">())</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_start</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_end</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">time_dt_value</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time_end</span><span class="o">.</span><span class="n">get</span><span class="p">())</span><span class="o">-</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time_start</span><span class="o">.</span><span class="n">get</span><span class="p">())</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_update_end_time</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x_end</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_end</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">tk</span><span class="o">.</span><span class="n">END</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_end</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">tk</span><span class="o">.</span><span class="n">END</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">x_end</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">start_or_end</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ln1_end</span><span class="o">.</span><span class="n">set_data</span><span class="p">([</span><span class="n">x_end</span><span class="p">,</span><span class="n">x_end</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax1</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ln2_end</span><span class="o">.</span><span class="n">set_data</span><span class="p">([</span><span class="n">x_end</span><span class="p">,</span><span class="n">x_end</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ln3_end</span><span class="o">.</span><span class="n">set_data</span><span class="p">([</span><span class="n">x_end</span><span class="p">,</span><span class="n">x_end</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ln4_end</span><span class="o">.</span><span class="n">set_data</span><span class="p">([</span><span class="n">x_end</span><span class="p">,</span><span class="n">x_end</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax4</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">())</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_start</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_end</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">time_dt_value</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time_end</span><span class="o">.</span><span class="n">get</span><span class="p">())</span><span class="o">-</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time_start</span><span class="o">.</span><span class="n">get</span><span class="p">())</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_update_exp_line</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t1</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">t2</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">t3</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">t4</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;バックグラウンド測定開始・終了時間とQ&gt;0での測定開始・終了時間の描画</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ln1_s0</span><span class="o">.</span><span class="n">set_data</span><span class="p">([</span><span class="n">t1</span><span class="p">,</span><span class="n">t1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax1</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ln2_s0</span><span class="o">.</span><span class="n">set_data</span><span class="p">([</span><span class="n">t1</span><span class="p">,</span><span class="n">t1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ln3_s0</span><span class="o">.</span><span class="n">set_data</span><span class="p">([</span><span class="n">t1</span><span class="p">,</span><span class="n">t1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ln4_s0</span><span class="o">.</span><span class="n">set_data</span><span class="p">([</span><span class="n">t1</span><span class="p">,</span><span class="n">t1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax4</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">())</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ln1_e0</span><span class="o">.</span><span class="n">set_data</span><span class="p">([</span><span class="n">t2</span><span class="p">,</span><span class="n">t2</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax1</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ln2_e0</span><span class="o">.</span><span class="n">set_data</span><span class="p">([</span><span class="n">t2</span><span class="p">,</span><span class="n">t2</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ln3_e0</span><span class="o">.</span><span class="n">set_data</span><span class="p">([</span><span class="n">t2</span><span class="p">,</span><span class="n">t2</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ln4_e0</span><span class="o">.</span><span class="n">set_data</span><span class="p">([</span><span class="n">t2</span><span class="p">,</span><span class="n">t2</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax4</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">())</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ln1_s1</span><span class="o">.</span><span class="n">set_data</span><span class="p">([</span><span class="n">t3</span><span class="p">,</span><span class="n">t3</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax1</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ln2_s1</span><span class="o">.</span><span class="n">set_data</span><span class="p">([</span><span class="n">t3</span><span class="p">,</span><span class="n">t3</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ln3_s1</span><span class="o">.</span><span class="n">set_data</span><span class="p">([</span><span class="n">t3</span><span class="p">,</span><span class="n">t3</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ln4_s1</span><span class="o">.</span><span class="n">set_data</span><span class="p">([</span><span class="n">t3</span><span class="p">,</span><span class="n">t3</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax4</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">())</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ln1_e1</span><span class="o">.</span><span class="n">set_data</span><span class="p">([</span><span class="n">t4</span><span class="p">,</span><span class="n">t4</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax1</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ln2_e1</span><span class="o">.</span><span class="n">set_data</span><span class="p">([</span><span class="n">t4</span><span class="p">,</span><span class="n">t4</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ln3_e1</span><span class="o">.</span><span class="n">set_data</span><span class="p">([</span><span class="n">t4</span><span class="p">,</span><span class="n">t4</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ln4_e1</span><span class="o">.</span><span class="n">set_data</span><span class="p">([</span><span class="n">t4</span><span class="p">,</span><span class="n">t4</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax4</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">_reset_click</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">:</span> <span class="n">Any</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;&#39;Reset&#39;を押したときにsliderの値をを初期値にリセット</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">t1</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">t2</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="o">.</span><span class="n">Time</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sliders</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">t1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sliders</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">t2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_update_xlim</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span><span class="n">t2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_update_ylim</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span><span class="n">t2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">adjust_tickslabel</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fig_canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_lock_click</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;&#39;Lock&#39;を押したときにsliderの相対位置を固定</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">t1</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sliders</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">t2</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sliders</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t_lock</span> <span class="o">=</span> <span class="n">t2</span><span class="o">-</span><span class="n">t1</span>

    <span class="k">def</span> <span class="nf">_increment_click</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;&#39;Increment&#39;を押したときに描画範囲や&#39;start time&#39;や&#39;end time&#39;を自動的に変更</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">increment</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">increment</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
        <span class="n">t1</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sliders</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="o">+</span> <span class="n">increment</span>
        <span class="n">t2</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sliders</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="o">+</span> <span class="n">increment</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sliders</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">t1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sliders</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">t2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_update_xlim</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span><span class="n">t2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_update_ylim</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span><span class="n">t2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">adjust_tickslabel</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_start</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
            <span class="n">x_start</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time_start</span><span class="o">.</span><span class="n">get</span><span class="p">())</span> <span class="o">+</span> <span class="n">increment</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_update_start_time</span><span class="p">(</span><span class="n">x_start</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_end</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
            <span class="n">x_end</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time_end</span><span class="o">.</span><span class="n">get</span><span class="p">())</span> <span class="o">+</span> <span class="n">increment</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_update_end_time</span><span class="p">(</span><span class="n">x_end</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fig_canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_reflection_exp_idx</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;描画にexp_idxを反映させる</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">sidx0</span><span class="p">,</span> <span class="n">eidx0</span><span class="p">,</span> <span class="n">sidx1</span><span class="p">,</span> <span class="n">eidx1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ExpData</span><span class="o">.</span><span class="n">Index</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
        <span class="n">t1</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="o">.</span><span class="n">Time</span><span class="p">[</span><span class="n">sidx0</span><span class="p">]</span>
        <span class="n">t2</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="o">.</span><span class="n">Time</span><span class="p">[</span><span class="n">eidx0</span><span class="p">]</span>
        <span class="n">t3</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="o">.</span><span class="n">Time</span><span class="p">[</span><span class="n">sidx1</span><span class="p">]</span>
        <span class="n">t4</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="o">.</span><span class="n">Time</span><span class="p">[</span><span class="n">eidx1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sliders</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">t1</span><span class="o">-</span><span class="mi">30</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sliders</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">t4</span><span class="o">+</span><span class="mi">30</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_update_xlim</span><span class="p">(</span><span class="n">t1</span><span class="o">-</span><span class="mi">30</span><span class="p">,</span><span class="n">t4</span><span class="o">+</span><span class="mi">30</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_update_ylim</span><span class="p">(</span><span class="n">t1</span><span class="o">-</span><span class="mi">30</span><span class="p">,</span><span class="n">t4</span><span class="o">+</span><span class="mi">30</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">adjust_tickslabel</span><span class="p">(</span><span class="n">t1</span><span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="n">t4</span><span class="o">+</span><span class="mi">30</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_update_exp_line</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span><span class="n">t2</span><span class="p">,</span><span class="n">t3</span><span class="p">,</span><span class="n">t4</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">now_idx_value</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">kxx</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ExpData</span><span class="o">.</span><span class="n">kxx</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kxx_value</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">kxx</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_update_click</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;&#39;Update&#39;を押したときに描画範囲を自動的に変更</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">now</span><span class="p">:</span> <span class="nb">int</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">exp_idx</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">exp_idx</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">now</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">now</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">exp_idx</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_reflection_exp_idx</span><span class="p">(</span><span class="n">now</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fig_canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_prev_click</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;&#39;Prev&#39;を押したときに描画範囲を自動的に変更</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">value</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">now_idx_value</span><span class="o">.</span><span class="n">get</span><span class="p">())</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_reflection_exp_idx</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fig_canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_next_click</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;&#39;Next&#39;を押したときに描画範囲を自動的に変更</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">value</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ExpData</span><span class="o">.</span><span class="n">Index</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">now_idx_value</span><span class="o">.</span><span class="n">get</span><span class="p">())</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_reflection_exp_idx</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fig_canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_select_range_by_click_click</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;&#39;select range by click&#39;をclickしたときに&#39;is_select_range_by_click&#39;を変更</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_select_range_by_click</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">is_select_range_by_click</span><span class="o">.</span><span class="n">get</span><span class="p">()</span><span class="o">^</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_calc_click</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">:</span> <span class="n">Any</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;&#39;Calc&#39;ボタンをクリックしたときに&#39;start time&#39;から&#39;end time&#39;の各物理量の平均値と標準偏差を計算</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">t_start</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time_start</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
        <span class="n">t_end</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time_end</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
        <span class="n">idx</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">t</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="o">.</span><span class="n">Time</span><span class="p">)</span> <span class="k">if</span> <span class="n">t_start</span> <span class="o">&lt;=</span> <span class="n">t</span> <span class="o">&lt;=</span> <span class="n">t_end</span><span class="p">]</span>
        <span class="n">now_H</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="o">.</span><span class="n">Field</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">idx</span><span class="p">]</span>
        <span class="n">ave_H</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">now_H</span><span class="p">)</span>
        <span class="n">std_H</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">now_H</span><span class="p">)</span>

        <span class="n">now_Cernox_temp</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="o">.</span><span class="n">CernoxTemp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">idx</span><span class="p">]</span>
        <span class="n">ave_Cernox_temp</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">now_Cernox_temp</span><span class="p">)</span>
        <span class="n">std_Cernox_temp</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">now_Cernox_temp</span><span class="p">)</span>
        
        <span class="n">now_dTx</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="o">.</span><span class="n">dTx</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">idx</span><span class="p">]</span>
        <span class="n">ave_dTx</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">now_dTx</span><span class="p">)</span>
        <span class="n">std_dTx</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">now_dTx</span><span class="p">)</span>

        <span class="n">now_dTy</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="o">.</span><span class="n">dTy</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">idx</span><span class="p">]</span>
        <span class="n">ave_dTy</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">now_dTy</span><span class="p">)</span>
        <span class="n">std_dTy</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">now_dTy</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">field_value</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ave_H</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> ± </span><span class="si">{</span><span class="n">std_H</span><span class="si">:</span><span class="s2">.2g</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Cernox_temp_value</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ave_Cernox_temp</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> ± </span><span class="si">{</span><span class="n">std_Cernox_temp</span><span class="si">:</span><span class="s2">.2g</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dTx_value</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ave_dTx</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> ± </span><span class="si">{</span><span class="n">std_dTx</span><span class="si">:</span><span class="s2">.2g</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dTy_value</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ave_dTy</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> ± </span><span class="si">{</span><span class="n">std_dTy</span><span class="si">:</span><span class="s2">.2g</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="nf">_save_click</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;&#39;Save&#39;ボタンをクリックしたときに&#39;start time&#39;から&#39;end time&#39;の各物理量の平均値と</span>
<span class="sd">            標準偏差を指定したファイルに保存</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filename_to_save</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">t_start</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time_start</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
            <span class="n">t_end</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time_end</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
            <span class="n">idx</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">t</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="o">.</span><span class="n">Time</span><span class="p">)</span> <span class="k">if</span> <span class="n">t_start</span> <span class="o">&lt;=</span> <span class="n">t</span> <span class="o">&lt;=</span> <span class="n">t_end</span><span class="p">]</span>

            <span class="n">now_H</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="o">.</span><span class="n">Field</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">idx</span><span class="p">]</span>
            <span class="n">ave_H</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">now_H</span><span class="p">)</span>
            <span class="n">std_H</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">now_H</span><span class="p">)</span>

            <span class="n">now_Cernox_temp</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="o">.</span><span class="n">CernoxTemp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">idx</span><span class="p">]</span>
            <span class="n">ave_Cernox_temp</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">now_Cernox_temp</span><span class="p">)</span>
            <span class="n">std_Cernox_temp</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">now_Cernox_temp</span><span class="p">)</span>
            
            <span class="n">now_dTx</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="o">.</span><span class="n">dTx</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">idx</span><span class="p">]</span>
            <span class="n">ave_dTx</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">now_dTx</span><span class="p">)</span>
            <span class="n">std_dTx</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">now_dTx</span><span class="p">)</span>

            <span class="n">now_dTy</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="o">.</span><span class="n">dTy</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">idx</span><span class="p">]</span>
            <span class="n">ave_dTy</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">now_dTy</span><span class="p">)</span>
            <span class="n">std_dTy</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">now_dTy</span><span class="p">)</span>

            <span class="n">res</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="p">[</span><span class="n">t_start</span><span class="p">,</span> <span class="n">t_end</span><span class="p">,</span> 
                                <span class="n">ave_H</span><span class="p">,</span> <span class="n">std_H</span><span class="p">,</span> 
                                <span class="n">ave_Cernox_temp</span><span class="p">,</span> <span class="n">std_Cernox_temp</span><span class="p">,</span>
                                <span class="n">ave_dTx</span><span class="p">,</span> <span class="n">std_dTx</span><span class="p">,</span>
                                <span class="n">ave_dTy</span><span class="p">,</span> <span class="n">std_dTy</span><span class="p">]))</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;failed: save data&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_print_click</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;&#39;Print&#39;ボタンをクリックしたときに&#39;start time&#39;から&#39;end time&#39;の各物理量の平均値と</span>
<span class="sd">            標準偏差を所定の形式で出力</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">print_mode</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t_s0</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t_e0</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t_s1</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t_e1</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_expfit_click</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;&#39;ExpFit&#39;ボタンをクリックしたときに&#39;start time&#39;から&#39;end time&#39;のdTxを</span>
<span class="sd">            f(t) := A exp(-(t-t_start)/τ) + B</span>
<span class="sd">            でフィッティングしたときの緩和時間τの計算</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">t_start</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time_start</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
            <span class="n">t_end</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time_end</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
            <span class="n">idx</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">t</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="o">.</span><span class="n">Time</span><span class="p">)</span> <span class="k">if</span> <span class="n">t_start</span> <span class="o">&lt;=</span> <span class="n">t</span> <span class="o">&lt;=</span> <span class="n">t_end</span><span class="p">]</span>

            <span class="n">X</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="o">.</span><span class="n">Time</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">idx</span><span class="p">])</span>
            <span class="n">Y</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="o">.</span><span class="n">dTx</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">idx</span><span class="p">])</span>
            <span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">t</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">A</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">B</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">tau</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">A</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="n">t_start</span><span class="p">)</span><span class="o">/</span><span class="n">tau</span><span class="p">)</span> <span class="o">+</span> <span class="n">B</span>

            <span class="n">param</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">curve_fit</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># 返り値はtuple(np.ndarray(#パラメータの値),np.ndarray(#パラメータの標準偏差))</span>
            <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">tau</span> <span class="o">=</span> <span class="n">param</span>
            <span class="n">tau_1percent</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="o">-</span><span class="n">tau</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">0.01</span><span class="p">)</span> <span class="c1"># 収束先からの偏差が1％になるまでの時間</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">relaxation_time</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">tau_1percent</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">expfit_dTx</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="o">*</span><span class="n">param</span><span class="p">))</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;parameters: A:</span><span class="si">{</span><span class="n">A</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> (K), B:</span><span class="si">{</span><span class="n">B</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> (K), tau:</span><span class="si">{</span><span class="n">tau</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">, &lt;1%: </span><span class="si">{</span><span class="n">tau_1percent</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;failed: fit data&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_slider_scroll</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">:</span> <span class="n">Any</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;sliderを変化させたときにx座標の描画範囲を変更</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">t1</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sliders</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">t2</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sliders</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_locked</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">t2</span> <span class="o">!=</span> <span class="n">t1</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">t_lock</span><span class="p">:</span>
                <span class="n">t2</span> <span class="o">=</span> <span class="n">t1</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">t_lock</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">sliders</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">t2</span><span class="p">)</span>
        <span class="c1"># 描画範囲を更新</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_update_xlim</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span><span class="n">t2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_update_ylim</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span><span class="n">t2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">adjust_tickslabel</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fig_canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_fig_hover</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;figure領域をマウスオーバーしたときにそのx座標に対応する縦線を描画</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">x</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">xdata</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ln1_hover</span><span class="o">.</span><span class="n">set_data</span><span class="p">([</span><span class="n">x</span><span class="p">,</span><span class="n">x</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax1</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ln2_hover</span><span class="o">.</span><span class="n">set_data</span><span class="p">([</span><span class="n">x</span><span class="p">,</span><span class="n">x</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ln3_hover</span><span class="o">.</span><span class="n">set_data</span><span class="p">([</span><span class="n">x</span><span class="p">,</span><span class="n">x</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ln4_hover</span><span class="o">.</span><span class="n">set_data</span><span class="p">([</span><span class="n">x</span><span class="p">,</span><span class="n">x</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax4</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fig_canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_fig_click</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;figure領域をclickしたときにそのx座標に対応する縦線を描画</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">x</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">xdata</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">print_mode</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">t0</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_select_range_by_click</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_or_end</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">t0</span> <span class="o">=</span> <span class="n">x</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">t_s0</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">x</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">t1</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_select_range_by_click</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_or_end</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">t1</span> <span class="o">=</span> <span class="n">x</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">t_e0</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">x</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">t0</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">t1</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">idx</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">t</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="o">.</span><span class="n">Time</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">t0</span> <span class="o">&lt;=</span> <span class="n">t</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">t1</span><span class="p">]</span>
                <span class="n">sidx</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">idx</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">eidx</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">idx</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">data0</span> <span class="o">=</span> <span class="p">[</span><span class="n">sidx</span><span class="p">,</span> <span class="n">eidx</span><span class="p">]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ave_std</span><span class="p">(</span><span class="n">sidx</span><span class="p">,</span> <span class="n">eidx</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">t0</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">t1</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">print_mode</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">print_mode</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">t0</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_select_range_by_click</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_or_end</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">t0</span> <span class="o">=</span> <span class="n">x</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">t_s1</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">x</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">t1</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_select_range_by_click</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_or_end</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">t1</span> <span class="o">=</span> <span class="n">x</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">t_e1</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">x</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">t0</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">t1</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">idx</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">t</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="o">.</span><span class="n">Time</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">t0</span> <span class="o">&lt;=</span> <span class="n">t</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">t1</span><span class="p">]</span>
                <span class="n">sidx</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">idx</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">eidx</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">idx</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">data1</span> <span class="o">=</span> <span class="p">[</span><span class="n">sidx</span><span class="p">,</span> <span class="n">eidx</span><span class="p">]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ave_std</span><span class="p">(</span><span class="n">sidx</span><span class="p">,</span> <span class="n">eidx</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">t0</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">t1</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">print_mode</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">sidx0</span><span class="p">,</span> <span class="n">eidx0</span><span class="p">,</span> <span class="n">tp0</span><span class="p">,</span> <span class="n">etp0</span><span class="p">,</span> <span class="n">h0</span><span class="p">,</span> <span class="n">eh0</span><span class="p">,</span> <span class="n">cur0</span><span class="p">,</span> <span class="n">ecur0</span><span class="p">,</span> <span class="n">tc0</span><span class="p">,</span> <span class="n">etc0</span><span class="p">,</span> <span class="n">vx0</span><span class="p">,</span> <span class="n">evx0</span><span class="p">,</span> <span class="n">vy0</span><span class="p">,</span> <span class="n">evy0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data0</span>
                <span class="n">sidx1</span><span class="p">,</span> <span class="n">eidx1</span><span class="p">,</span> <span class="n">tp1</span><span class="p">,</span> <span class="n">etp1</span><span class="p">,</span> <span class="n">h1</span><span class="p">,</span> <span class="n">eh1</span><span class="p">,</span> <span class="n">cur1</span><span class="p">,</span> <span class="n">ecur1</span><span class="p">,</span> <span class="n">tc1</span><span class="p">,</span> <span class="n">etc1</span><span class="p">,</span> <span class="n">vx1</span><span class="p">,</span> <span class="n">evx1</span><span class="p">,</span> <span class="n">vy1</span><span class="p">,</span> <span class="n">evy1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data1</span>
                <span class="n">dtx</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="p">(</span><span class="n">vx1</span><span class="o">-</span><span class="n">vx0</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="o">.</span><span class="n">Seebeck_at_T</span><span class="p">(</span><span class="n">tp1</span><span class="p">)</span>
                <span class="n">errdtx</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="p">(</span><span class="n">evx0</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">evx1</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="o">.</span><span class="n">Seebeck_at_T</span><span class="p">(</span><span class="n">tp1</span><span class="p">)</span>
                <span class="n">kxx</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="o">.</span><span class="n">R</span><span class="o">*</span><span class="p">(</span><span class="n">cur1</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="o">.</span><span class="n">Width</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="o">.</span><span class="n">Thickness</span> <span class="o">/</span> <span class="p">(</span><span class="n">dtx</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="o">.</span><span class="n">LTx</span><span class="p">)</span>
                <span class="n">errkxx</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">kxx</span> <span class="o">*</span> <span class="n">errdtx</span> <span class="o">/</span> <span class="n">dtx</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Start Index0	End Index0	ave T_PPMS0 (K)	err T_PPMS0 (K)	ave H0 (Oe)	err H0 (Oe)	</span><span class="se">\</span>
<span class="s2">                    ave Current0 (mA)	err Current0 (mA)	ave T_Cernox0 (K)	err T_Cernox0 (K)	</span><span class="se">\</span>
<span class="s2">                    ave Vx0 (V)	err Vx0 (V)	ave Vy0 (V)	err Vy0 (V)	</span><span class="se">\</span>
<span class="s2">                    Start Index1	End Index1	ave T_PPMS1 (K)	err T_PPMS1 (K)	ave H1 (Oe)	err H1 (Oe)	</span><span class="se">\</span>
<span class="s2">                    ave Current1 (mA)	err Current1 (mA)	ave T_Cernox1 (K)	err T_Cernox1 (K)	</span><span class="se">\</span>
<span class="s2">                    ave Vx1 (V)	err Vx1 (V)	ave Vy1 (V)	err Vy1 (V)	</span><span class="se">\</span>
<span class="s2">                    dTx (K)	err dTx (K)	kxx (W/Km)	err kxx (W/Km)&quot;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data0</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">data1</span><span class="o">+</span><span class="p">[</span><span class="n">dtx</span><span class="p">,</span> <span class="n">errdtx</span><span class="p">,</span> <span class="n">kxx</span><span class="p">,</span> <span class="n">errkxx</span><span class="p">])))</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_select_range_by_click</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_or_end</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_update_start_time</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fig_canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_update_end_time</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fig_canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
    
<div class="viewcode-block" id="HistoryOfTTM.ave_std"><a class="viewcode-back" href="../../../cpystal.analysis.html#cpystal.analysis.thermal_conduction.HistoryOfTTM.ave_std">[docs]</a>    <span class="k">def</span> <span class="nf">ave_std</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sidx</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">eidx</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="o">...</span><span class="p">]:</span>
        <span class="n">slc</span><span class="p">:</span> <span class="nb">slice</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">sidx</span><span class="p">,</span> <span class="n">eidx</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">attr_cor_to_V</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="o">.</span><span class="n">attr_cor_to_V</span>
        <span class="n">aveT_PPMS</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="o">.</span><span class="n">PPMSTemp</span><span class="p">[</span><span class="n">slc</span><span class="p">])</span>
        <span class="n">errT_PPMS</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="o">.</span><span class="n">PPMSTemp</span><span class="p">[</span><span class="n">slc</span><span class="p">])</span>
        <span class="n">aveH</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="o">.</span><span class="n">Field</span><span class="p">[</span><span class="n">slc</span><span class="p">])</span>
        <span class="n">errH</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="o">.</span><span class="n">Field</span><span class="p">[</span><span class="n">slc</span><span class="p">])</span>
        <span class="n">aveCurrent</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="o">.</span><span class="n">HeaterCurrent</span><span class="p">[</span><span class="n">slc</span><span class="p">])</span>
        <span class="n">errCurrent</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="o">.</span><span class="n">HeaterCurrent</span><span class="p">[</span><span class="n">slc</span><span class="p">])</span>
        <span class="n">aveT_Cernox</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="o">.</span><span class="n">CernoxTemp</span><span class="p">[</span><span class="n">slc</span><span class="p">])</span>
        <span class="n">errT_Cernox</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="o">.</span><span class="n">CernoxTemp</span><span class="p">[</span><span class="n">slc</span><span class="p">])</span>
        <span class="n">Vs</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="o">.</span><span class="n">V1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="o">.</span><span class="n">V2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="o">.</span><span class="n">V3</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="o">.</span><span class="n">V4</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="o">.</span><span class="n">V5</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="o">.</span><span class="n">V6</span><span class="p">]</span>
        <span class="n">aveVx</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">Vs</span><span class="p">[</span><span class="n">attr_cor_to_V</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="n">slc</span><span class="p">])</span>
        <span class="n">errVx</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">Vs</span><span class="p">[</span><span class="n">attr_cor_to_V</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="n">slc</span><span class="p">])</span>
        <span class="n">aveVy</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">Vs</span><span class="p">[</span><span class="n">attr_cor_to_V</span><span class="p">[</span><span class="mi">2</span><span class="p">]][</span><span class="n">slc</span><span class="p">])</span>
        <span class="n">errVy</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">Vs</span><span class="p">[</span><span class="n">attr_cor_to_V</span><span class="p">[</span><span class="mi">2</span><span class="p">]][</span><span class="n">slc</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">aveT_PPMS</span><span class="p">,</span> <span class="n">errT_PPMS</span><span class="p">,</span> <span class="n">aveH</span><span class="p">,</span> <span class="n">errH</span><span class="p">,</span> <span class="n">aveCurrent</span><span class="p">,</span> <span class="n">errCurrent</span><span class="p">,</span> <span class="n">aveT_Cernox</span><span class="p">,</span> <span class="n">errT_Cernox</span><span class="p">,</span> <span class="n">aveVx</span><span class="p">,</span> <span class="n">errVx</span><span class="p">,</span> <span class="n">aveVy</span><span class="p">,</span> <span class="n">errVy</span></div>

<div class="viewcode-block" id="HistoryOfTTM.adjust_tickslabel"><a class="viewcode-back" href="../../../cpystal.analysis.html#cpystal.analysis.thermal_conduction.HistoryOfTTM.adjust_tickslabel">[docs]</a>    <span class="k">def</span> <span class="nf">adjust_tickslabel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t1</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">t2</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;目盛りのラベルを変更&quot;&quot;&quot;</span>
        <span class="n">time_origin_tranformation</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">60</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="o">.</span><span class="n">StartTime</span><span class="o">.</span><span class="n">minute</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="o">.</span><span class="n">StartTime</span><span class="o">.</span><span class="n">second</span> <span class="c1"># 目盛を0分0秒を基準として見やすくする</span>
        <span class="n">t1_int</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">t1</span><span class="p">)</span>
        <span class="n">t2_int</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">t2</span><span class="p">)</span>
        <span class="n">t_range</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">t2_int</span> <span class="o">-</span> <span class="n">t1_int</span>
        <span class="n">dt_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">86400</span><span class="p">,</span> <span class="mi">43200</span><span class="p">,</span> <span class="mi">21600</span><span class="p">,</span> <span class="mi">10800</span><span class="p">,</span> <span class="mi">7200</span><span class="p">,</span> <span class="mi">3600</span><span class="p">,</span> <span class="mi">1800</span><span class="p">,</span> <span class="mi">900</span><span class="p">,</span> <span class="mi">600</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
        <span class="n">dt_list</span> <span class="o">=</span> <span class="n">dt_list</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">xticks</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">dt</span> <span class="ow">in</span> <span class="n">dt_list</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">t_range</span> <span class="o">//</span> <span class="n">dt</span> <span class="o">&lt;=</span> <span class="mi">10</span><span class="p">:</span>
                <span class="n">xticks</span> <span class="o">=</span> <span class="p">[</span><span class="n">t</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(((</span><span class="n">t1_int</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">//</span><span class="n">dt</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">dt</span><span class="o">-</span><span class="n">time_origin_tranformation</span><span class="p">,</span> <span class="n">t2_int</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span> <span class="k">if</span> <span class="n">t1</span> <span class="o">&lt;=</span> <span class="n">t</span> <span class="o">&lt;=</span> <span class="n">t2</span><span class="p">]</span>
                <span class="k">break</span>
            <span class="k">elif</span> <span class="n">dt</span> <span class="o">==</span> <span class="mi">86400</span><span class="p">:</span>
                <span class="n">xticks</span> <span class="o">=</span> <span class="p">[</span><span class="n">t</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(((</span><span class="n">t1_int</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">//</span><span class="n">dt</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">dt</span><span class="o">-</span><span class="n">time_origin_tranformation</span><span class="p">,</span> <span class="n">t2_int</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span> <span class="k">if</span> <span class="n">t1</span> <span class="o">&lt;=</span> <span class="n">t</span> <span class="o">&lt;=</span> <span class="n">t2</span><span class="p">]</span>
                <span class="k">break</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">continue</span>
        <span class="n">xtickslabel</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">RawData</span><span class="o">.</span><span class="n">StartTime</span> <span class="o">+</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">t</span><span class="p">))</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y/%m/</span><span class="si">%d</span><span class="s1"> %H:%M:%S&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">xticks</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax1</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">(</span><span class="n">xticks</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">(</span><span class="n">xticks</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">(</span><span class="n">xticks</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax4</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">(</span><span class="n">xticks</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax1</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticklabels</span><span class="p">([])</span> <span class="c1"># 目盛を削除</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticklabels</span><span class="p">([])</span> <span class="c1"># 目盛を削除</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticklabels</span><span class="p">([])</span> <span class="c1"># 目盛を削除</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax4</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticklabels</span><span class="p">(</span><span class="n">xtickslabel</span><span class="p">,</span> <span class="n">Rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span></div>

<div class="viewcode-block" id="HistoryOfTTM.excute"><a class="viewcode-back" href="../../../cpystal.analysis.html#cpystal.analysis.thermal_conduction.HistoryOfTTM.excute">[docs]</a>    <span class="k">def</span> <span class="nf">excute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">save_filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;アプリを実行</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">save_filename</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">filename_to_save</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">tk</span><span class="o">.</span><span class="n">END</span><span class="p">,</span> <span class="n">save_filename</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">mainloop</span><span class="p">()</span></div>
    
<div class="viewcode-block" id="HistoryOfTTM.delete"><a class="viewcode-back" href="../../../cpystal.analysis.html#cpystal.analysis.thermal_conduction.HistoryOfTTM.delete">[docs]</a>    <span class="k">def</span> <span class="nf">delete</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="n">destroy</span><span class="p">()</span></div></div>


<div class="viewcode-block" id="ThermalDiffusionSimulation"><a class="viewcode-back" href="../../../cpystal.analysis.html#cpystal.analysis.thermal_conduction.ThermalDiffusionSimulation">[docs]</a><span class="k">class</span> <span class="nc">ThermalDiffusionSimulation</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> 
            <span class="n">Lx</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> 
            <span class="n">Ly</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
            <span class="n">Lz</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
            <span class="n">Lt</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
            <span class="n">mol_density</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
            <span class="n">dx</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.</span><span class="p">,</span>
            <span class="n">dt</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">,</span>
        <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;initialize</span>

<span class="sd">        Args:</span>
<span class="sd">            Lx (float): Length of the sample (μm).</span>
<span class="sd">            Ly (float): Width of the sample (μm).</span>
<span class="sd">            Lz (float): Thickness of the sample (μm).</span>
<span class="sd">            Lt (float): Time length of simulation (s).</span>
<span class="sd">            mol_density (float): Mol density of the sample (mol/cm^3).</span>
<span class="sd">            dx (float, optional): Discretization length of x direction (μm). Defaluts to 1.</span>
<span class="sd">            dt (float, optional): Discretization length of time (s). Defaluts to 0.01.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Lx</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">Lx</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Ly</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">Ly</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Lz</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">Lz</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Lt</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">Lt</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mol_density</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">mol_density</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">dx</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">dx</span> <span class="c1"># x方向離散化長さ(μm)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dt</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">dt</span> <span class="c1"># 離散化時間単位(s)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">Nx</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">Lx</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">dx</span><span class="p">)</span> <span class="c1"># x方向グリッド数</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Nt</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">Lt</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">dt</span><span class="p">)</span> <span class="c1"># t方向グリッド数</span>

<div class="viewcode-block" id="ThermalDiffusionSimulation.excute_1D_FTCS"><a class="viewcode-back" href="../../../cpystal.analysis.html#cpystal.analysis.thermal_conduction.ThermalDiffusionSimulation.excute_1D_FTCS">[docs]</a>    <span class="k">def</span> <span class="nf">excute_1D_FTCS</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T_init</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">Q</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">kappa</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">c</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;1D thermal diffusion simulation by Forward Time Center Space explicit method.</span>

<span class="sd">        Note:</span>
<span class="sd">            The discretization width (dx,dt) must be satisfied the CFL condition as below:</span>
<span class="sd">                dt/(dx**2) &lt; 1/(2*D),</span>
<span class="sd">            where D is diffusion coefficient.</span>
<span class="sd">            The boundary conditions are:</span>
<span class="sd">                x=0: Neumann condition under steady thermal flux flowing.</span>
<span class="sd">                x=L: Dirichlet condition at the constant temperature T_init.</span>
<span class="sd">            T_{n}^(t+1) = (1-2α)T_{n}^(t) + α(T_{n-1}^(t) + T_{n+1}^(t))</span>
<span class="sd">            </span>
<span class="sd">        Args:</span>
<span class="sd">            T_init (float): Initial temperature (K).</span>
<span class="sd">            Q (float): Heater power (mW).</span>
<span class="sd">            kappa (float): Thermal conductivity (W/Km).</span>
<span class="sd">            c (float): Specific heat (J/molK).</span>

<span class="sd">        Returns:</span>
<span class="sd">            npt.NDArray: Temperature distribution T(x,t).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># 時間前進-空間中心の陽的解法</span>
        <span class="n">Nx</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Nx</span>
        <span class="n">Nt</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Nt</span>
        <span class="n">T</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDarray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">Nx</span><span class="p">,</span> <span class="n">Nt</span><span class="p">))</span>
        <span class="n">T</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">T_init</span>
    
        <span class="n">dtdxdx</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dt</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dx</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="c1"># s / (μm)^2</span>
        <span class="n">D</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">kappa</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">mol_density</span> <span class="o">/</span> <span class="n">c</span> <span class="o">*</span> <span class="mf">1e6</span> <span class="c1"># (W/Km) / (mol/cm^3) / (J/molK) = 10^6 * (μm)^2 / s</span>
        <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">D</span> <span class="o">*</span> <span class="n">dtdxdx</span>
        <span class="n">beta</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">Q</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">Ly</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">Lz</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">dx</span> <span class="o">/</span> <span class="n">kappa</span> <span class="o">*</span> <span class="mf">1e3</span> <span class="c1"># mW/μm/μm * μm / (W/Km) = 10^3 * K</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">dtdxdx</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">D</span><span class="p">))</span>
        <span class="k">assert</span> <span class="n">dtdxdx</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">D</span><span class="p">)</span> <span class="c1"># 拡散方程式の安定条件</span>
        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="o">.</span><span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">Nt</span><span class="o">-</span><span class="mi">1</span><span class="p">)):</span>
            <span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="n">Nx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="n">Nx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">t</span><span class="p">]</span> <span class="o">+</span> <span class="n">alpha</span> <span class="o">*</span> <span class="p">(</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">Nx</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="n">t</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="n">Nx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">t</span><span class="p">]</span> <span class="o">+</span> <span class="n">T</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="n">Nx</span><span class="p">,</span> <span class="n">t</span><span class="p">])</span>
        
            <span class="c1"># Neumann条件(定常熱流印加バージョン)</span>
            <span class="c1"># T[0, t+1] = T[0, t] + Q/self.Ly/self.Lz * self.dx / kappa * 1e3 # mW/μm/μm * μm / (W/Km) = 10^3 * K</span>
            <span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">beta</span>
            <span class="c1"># Dirichlet条件</span>
            <span class="n">T</span><span class="p">[</span><span class="n">Nx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">T_init</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span> <span class="o">=</span> <span class="n">T</span>
        <span class="k">return</span> <span class="n">T</span></div>
    
    <span class="k">def</span> <span class="nf">_excute_1D_implicit2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T_init</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">Q</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">kappa</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">c</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;1D thermal diffusion simulation by iterative implicit method.</span>

<span class="sd">        Note:</span>
<span class="sd">            The constraint of discretization width (dx,dt) is nothing.</span>
<span class="sd">            The boundary conditions are:</span>
<span class="sd">                x=0: Neumann condition under steady thermal flux flowing.</span>
<span class="sd">                x=L: Dirichlet condition at the constant temperature T_init.</span>
<span class="sd">            </span>
<span class="sd">        Args:</span>
<span class="sd">            T_init (float): Initial temperature (K).</span>
<span class="sd">            Q (float): Heater power (mW).</span>
<span class="sd">            kappa (float): Thermal conductivity (W/Km).</span>
<span class="sd">            c (float): Specific heat (J/molK).</span>

<span class="sd">        Returns:</span>
<span class="sd">            npt.NDArray: Temperature distribution T(x,t).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># 反復法の陰的解法</span>
        <span class="n">Nx</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Nx</span>
        <span class="n">Nt</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Nt</span>
        <span class="n">T</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDarray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">Nx</span><span class="p">,</span> <span class="n">Nt</span><span class="p">))</span>
        <span class="n">T</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">T_init</span>
    
        <span class="n">dtdxdx</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dt</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dx</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="c1"># s / (μm)^2</span>
        <span class="n">D</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">kappa</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">mol_density</span> <span class="o">/</span> <span class="n">c</span> <span class="o">*</span> <span class="mf">1e6</span> <span class="c1"># (W/Km) / (mol/cm^3) / (J/molK) = 10^6 * (μm)^2 / s</span>
        <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">D</span> <span class="o">*</span> <span class="n">dtdxdx</span> <span class="c1"># dimensionless</span>
        <span class="n">beta</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">Q</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">Ly</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">Lz</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">dx</span> <span class="o">/</span> <span class="n">kappa</span> <span class="o">*</span> <span class="mf">1e3</span> <span class="c1"># mW/μm/μm * μm / (W/Km) = 10^3 * K</span>
        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="o">.</span><span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">Nt</span><span class="o">-</span><span class="mi">1</span><span class="p">)):</span>
            <span class="n">v</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">T</span><span class="p">[:,</span> <span class="n">t</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">):</span>
                <span class="n">w</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">T</span><span class="p">[:,</span> <span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="n">Nx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">alpha</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="n">Nx</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">alpha</span><span class="o">*</span><span class="p">(</span><span class="n">w</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="n">Nx</span><span class="p">]</span><span class="o">+</span><span class="n">w</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">Nx</span><span class="o">-</span><span class="mi">2</span><span class="p">]))</span>
                <span class="k">if</span> <span class="n">n</span> <span class="o">%</span> <span class="mi">10</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">T</span><span class="p">[:,</span> <span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">w</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">w</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1e-6</span><span class="p">:</span>
                        <span class="k">break</span>

                <span class="c1"># boundary condition</span>
                <span class="c1"># Neumann条件(定常熱流印加バージョン)</span>
                <span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">beta</span>
                <span class="c1"># Dirichlet条件</span>
                <span class="n">T</span><span class="p">[</span><span class="n">Nx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">T_init</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span> <span class="o">=</span> <span class="n">T</span>
        <span class="k">return</span> <span class="n">T</span>

<div class="viewcode-block" id="ThermalDiffusionSimulation.excute_1D_implicit"><a class="viewcode-back" href="../../../cpystal.analysis.html#cpystal.analysis.thermal_conduction.ThermalDiffusionSimulation.excute_1D_implicit">[docs]</a>    <span class="k">def</span> <span class="nf">excute_1D_implicit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T_init</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">Q</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">kappa</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">c</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;1D thermal diffusion simulation by implicit method with TDMA.</span>

<span class="sd">        Note:</span>
<span class="sd">            The constraint of discretization width (dx,dt) is nothing.</span>
<span class="sd">            The boundary conditions are:</span>
<span class="sd">                x=0: Neumann condition under steady thermal flux flowing.</span>
<span class="sd">                x=L: Dirichlet condition at the constant temperature T_init.</span>
<span class="sd">            (1+2α)T_{n}^(t+1) - α(T_{n-1}^(t+1) + T_{n+1}^(t+1)) = T_{n}^(t)</span>
<span class="sd">            </span>
<span class="sd">        Args:</span>
<span class="sd">            T_init (float): Initial temperature (K).</span>
<span class="sd">            Q (float): Heater power (mW).</span>
<span class="sd">            kappa (float): Thermal conductivity (W/Km).</span>
<span class="sd">            c (float): Specific heat (J/molK).</span>

<span class="sd">        Returns:</span>
<span class="sd">            npt.NDArray: Temperature distribution T(x,t).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># 三重対角行列の陰的解法</span>
        <span class="n">Nx</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Nx</span>
        <span class="n">Nt</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Nt</span>
        <span class="n">T</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDarray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">Nx</span><span class="p">,</span> <span class="n">Nt</span><span class="p">))</span>
        <span class="n">T</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">T_init</span>
    
        <span class="n">dtdxdx</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dt</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dx</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="c1"># s / (μm)^2</span>
        <span class="n">D</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">kappa</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">mol_density</span> <span class="o">/</span> <span class="n">c</span> <span class="o">*</span> <span class="mf">1e6</span> <span class="c1"># (W/Km) / (mol/cm^3) / (J/molK) = 10^6 * (μm)^2 / s</span>
        <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">D</span> <span class="o">*</span> <span class="n">dtdxdx</span> <span class="c1"># dimensionless</span>
        <span class="n">beta</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">Q</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">Ly</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">Lz</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">dx</span> <span class="o">/</span> <span class="n">kappa</span> <span class="o">*</span> <span class="mf">1e3</span> <span class="c1"># mW/μm/μm * μm / (W/Km) = 10^3 * K</span>
        <span class="n">d</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.</span><span class="p">]</span><span class="o">+</span><span class="p">[</span><span class="mi">1</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">alpha</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">Nx</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="p">[</span><span class="mf">1.</span><span class="p">])</span>
        <span class="n">u</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">1.</span><span class="p">]</span><span class="o">+</span><span class="p">[</span><span class="o">-</span><span class="n">alpha</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">Nx</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="p">[</span><span class="mf">0.</span><span class="p">])</span>
        <span class="n">l</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">]</span><span class="o">+</span><span class="p">[</span><span class="o">-</span><span class="n">alpha</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">Nx</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="p">[</span><span class="mf">0.</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="o">.</span><span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">Nt</span><span class="o">-</span><span class="mi">1</span><span class="p">)):</span>
            <span class="n">b</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">T</span><span class="p">[:,</span> <span class="n">t</span><span class="p">])</span>
            <span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">beta</span>
            <span class="n">T</span><span class="p">[:,</span> <span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">TDMA</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">T</span> <span class="o">=</span> <span class="n">T</span>
        <span class="k">return</span> <span class="n">T</span></div>

<div class="viewcode-block" id="ThermalDiffusionSimulation.excute_1D_Crank_Nicolson"><a class="viewcode-back" href="../../../cpystal.analysis.html#cpystal.analysis.thermal_conduction.ThermalDiffusionSimulation.excute_1D_Crank_Nicolson">[docs]</a>    <span class="k">def</span> <span class="nf">excute_1D_Crank_Nicolson</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T_init</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">Q</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">kappa</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">c</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;1D thermal diffusion simulation by Crank-Nicolson method.</span>

<span class="sd">        Note:</span>
<span class="sd">            The constraint of discretization width (dx,dt) is nothing.</span>
<span class="sd">            The boundary conditions are:</span>
<span class="sd">                x=0: Neumann condition under steady thermal flux flowing.</span>
<span class="sd">                x=L: Dirichlet condition at the constant temperature T_init.</span>
<span class="sd">            (1+2θα)T_{n}^(t+1) - θα(T_{n-1}^(t+1) + T_{n+1}^(t+1)) = (1-2(1-θ)α)T_{n}^(t) + (1-θ)α(T_{n-1}^(t) + T_{n+1}^(t))</span>
<span class="sd">            </span>
<span class="sd">        Args:</span>
<span class="sd">            T_init (float): Initial temperature (K).</span>
<span class="sd">            Q (float): Heater power (mW).</span>
<span class="sd">            kappa (float): Thermal conductivity (W/Km).</span>
<span class="sd">            c (float): Specific heat (J/molK).</span>

<span class="sd">        Returns:</span>
<span class="sd">            npt.NDArray: Temperature distribution T(x,t).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Crank-Nicolson法の陰的解法</span>
        <span class="n">Nx</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Nx</span>
        <span class="n">Nt</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Nt</span>
        <span class="n">T</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDarray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">Nx</span><span class="p">,</span> <span class="n">Nt</span><span class="p">))</span>
        <span class="n">T</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">T_init</span>

        <span class="n">theta</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span>
        <span class="n">dtdxdx</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dt</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dx</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="c1"># s / (μm)^2</span>
        <span class="n">D</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">kappa</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">mol_density</span> <span class="o">/</span> <span class="n">c</span> <span class="o">*</span> <span class="mf">1e6</span> <span class="c1"># (W/Km) / (mol/cm^3) / (J/molK) = 10^6 * (μm)^2 / s</span>
        <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">D</span> <span class="o">*</span> <span class="n">dtdxdx</span> <span class="c1"># dimensionless</span>
        <span class="n">beta</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">Q</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">Ly</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">Lz</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">dx</span> <span class="o">/</span> <span class="n">kappa</span> <span class="o">*</span> <span class="mf">1e3</span> <span class="c1"># mW/μm/μm * μm / (W/Km) = 10^3 * K</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">dtdxdx</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">)</span>
        <span class="n">d</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.</span><span class="p">]</span><span class="o">+</span><span class="p">[</span><span class="mi">1</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">theta</span><span class="o">*</span><span class="n">alpha</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">Nx</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="p">[</span><span class="mf">1.</span><span class="p">])</span>
        <span class="n">u</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">1.</span><span class="p">]</span><span class="o">+</span><span class="p">[</span><span class="o">-</span><span class="n">theta</span><span class="o">*</span><span class="n">alpha</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">Nx</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="p">[</span><span class="mf">0.</span><span class="p">])</span>
        <span class="n">l</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">]</span><span class="o">+</span><span class="p">[</span><span class="o">-</span><span class="n">theta</span><span class="o">*</span><span class="n">alpha</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">Nx</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="p">[</span><span class="mf">0.</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="o">.</span><span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">Nt</span><span class="o">-</span><span class="mi">1</span><span class="p">)):</span>
            <span class="n">b</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">T</span><span class="p">[:,</span> <span class="n">t</span><span class="p">])</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">theta</span><span class="p">)</span><span class="o">*</span><span class="n">alpha</span><span class="p">)</span>
            <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">+=</span> <span class="n">T</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">t</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">theta</span><span class="p">)</span><span class="o">*</span><span class="n">alpha</span>
            <span class="n">b</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="n">t</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">theta</span><span class="p">)</span><span class="o">*</span><span class="n">alpha</span>
            <span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">beta</span> <span class="c1"># boundary condition</span>
            <span class="n">b</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">T_init</span> <span class="c1"># boundary condition</span>
            <span class="n">T</span><span class="p">[:,</span> <span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">TDMA</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">T</span> <span class="o">=</span> <span class="n">T</span>
        <span class="k">return</span> <span class="n">T</span></div>

    <span class="k">def</span> <span class="nf">_excutor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T_init</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">Q</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">kappa</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">c</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">mode</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;Crank-Nicolson&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">,</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">]:</span>
        <span class="n">X</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Lx</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Nx</span><span class="p">)</span>
        <span class="n">T</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span>
        <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="s2">&quot;T&quot;</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="n">T</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">T</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;FTCS&quot;</span><span class="p">:</span>
                <span class="n">T</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">excute_1D_FTCS</span><span class="p">(</span><span class="n">T_init</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="n">kappa</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;implicit&quot;</span><span class="p">:</span>
                <span class="n">T</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">excute_1D_implicit</span><span class="p">(</span><span class="n">T_init</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="n">kappa</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;Crank-Nicolson&quot;</span><span class="p">:</span>
                <span class="n">T</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">excute_1D_Crank_Nicolson</span><span class="p">(</span><span class="n">T_init</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="n">kappa</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span>
        <span class="k">return</span> <span class="n">X</span><span class="p">,</span> <span class="n">T</span>
    
<div class="viewcode-block" id="ThermalDiffusionSimulation.snapshot"><a class="viewcode-back" href="../../../cpystal.analysis.html#cpystal.analysis.thermal_conduction.ThermalDiffusionSimulation.snapshot">[docs]</a>    <span class="k">def</span> <span class="nf">snapshot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">T_init</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">Q</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">kappa</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">c</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">mode</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;Crank-Nicolson&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Visualize temperature distribution at the selected time.</span>

<span class="sd">        Args:</span>
<span class="sd">            t (float): Time (s).</span>
<span class="sd">            T_init (float): Initial temperature (K).</span>
<span class="sd">            Q (float): Heater power (mW).</span>
<span class="sd">            kappa (float): Thermal conductivity (W/Km).</span>
<span class="sd">            mode (str, optional): Simulation mode. Defaults to &quot;Crank-Nicolson&quot;.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: mode must be in [&quot;FTCS&quot;, &quot;implicit&quot;, &quot;Crank-Nicolson&quot;, &quot;reuse&quot;]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">X</span><span class="p">,</span> <span class="n">T</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_excutor</span><span class="p">(</span><span class="n">T_init</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="n">kappa</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">mode</span><span class="p">)</span>
        <span class="n">fig</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">Figure</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">set_dpi</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">Subplot</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
        <span class="n">min_y</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
        <span class="n">max_y</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="o">*</span><span class="mf">1.1</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">T</span><span class="p">[:,</span><span class="n">t</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;t = </span><span class="si">{</span><span class="p">(</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">dt</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">Lt</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">,&quot;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Lx</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">min_y</span><span class="p">,</span> <span class="n">max_y</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$x$ ($\mathrm{\mu}$m)&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$T$ (K)&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>

<div class="viewcode-block" id="ThermalDiffusionSimulation.animation"><a class="viewcode-back" href="../../../cpystal.analysis.html#cpystal.analysis.thermal_conduction.ThermalDiffusionSimulation.animation">[docs]</a>    <span class="k">def</span> <span class="nf">animation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T_init</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">Q</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">kappa</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">c</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">mode</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;Crank-Nicolson&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Make an animation of temperature distribution.</span>

<span class="sd">        Args:</span>
<span class="sd">            T_init (float): Initial temperature (K).</span>
<span class="sd">            Q (float): Heater power (mW).</span>
<span class="sd">            kappa (float): Thermal conductivity (W/Km).</span>
<span class="sd">            c (float): Specific heat (J/molK).</span>
<span class="sd">            mode (str, optional): Simulation mode. Defaults to &quot;Crank-Nicolson&quot;.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: mode must be in [&quot;FTCS&quot;, &quot;implicit&quot;, &quot;Crank-Nicolson&quot;, &quot;reuse&quot;]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">X</span><span class="p">,</span> <span class="n">T</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_excutor</span><span class="p">(</span><span class="n">T_init</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="n">kappa</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">mode</span><span class="p">)</span>
        <span class="n">fig</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">Figure</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">set_dpi</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">Subplot</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">min_y</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
        <span class="n">max_y</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="o">*</span><span class="mf">1.1</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Lx</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">min_y</span><span class="p">,</span> <span class="n">max_y</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$x$ ($\mathrm{\mu}$m)&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$T$ (K)&quot;</span><span class="p">)</span>
        <span class="k">def</span> <span class="nf">animate</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">T</span><span class="p">[:,</span><span class="n">t</span><span class="p">])</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;t = </span><span class="si">{</span><span class="p">(</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">dt</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">Lt</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">,&quot;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">min_y</span><span class="p">,</span> <span class="n">max_y</span><span class="p">)</span>
        <span class="n">anim</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">animation</span><span class="o">.</span><span class="n">FuncAnimation</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">animate</span><span class="p">,</span> <span class="n">frames</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">Nt</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">Nt</span><span class="o">//</span><span class="mi">100</span><span class="p">),</span> <span class="n">interval</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">repeat</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>

<div class="viewcode-block" id="ThermalDiffusionSimulation.exp_fit"><a class="viewcode-back" href="../../../cpystal.analysis.html#cpystal.analysis.thermal_conduction.ThermalDiffusionSimulation.exp_fit">[docs]</a>    <span class="k">def</span> <span class="nf">exp_fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">,</span> <span class="n">Y</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Exponential fitting.</span>

<span class="sd">        Args:</span>
<span class="sd">            X (npt.NDArray): X.</span>
<span class="sd">            Y (npt.NDArray): Y.</span>

<span class="sd">        Returns:</span>
<span class="sd">            tuple[npt.NDArray, tuple[float, float, float]]: Result of fitting and used parameters.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">t</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">A</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">B</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">tau</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">A</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">t</span><span class="o">/</span><span class="n">tau</span><span class="p">)</span> <span class="o">+</span> <span class="n">B</span>
        <span class="n">param</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">curve_fit</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">f</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="o">*</span><span class="n">param</span><span class="p">),</span> <span class="n">param</span></div>
    
<div class="viewcode-block" id="ThermalDiffusionSimulation.cal_tau"><a class="viewcode-back" href="../../../cpystal.analysis.html#cpystal.analysis.thermal_conduction.ThermalDiffusionSimulation.cal_tau">[docs]</a>    <span class="k">def</span> <span class="nf">cal_tau</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">,</span> <span class="n">Y</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the relaxation time.</span>

<span class="sd">        Args:</span>
<span class="sd">            X (npt.NDArray): X.</span>
<span class="sd">            Y (npt.NDArray): Y.</span>

<span class="sd">        Returns:</span>
<span class="sd">            float: Relaxation time.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">_</span><span class="p">,</span> <span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">tau</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">exp_fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">tau</span></div>
    
<div class="viewcode-block" id="ThermalDiffusionSimulation.dT"><a class="viewcode-back" href="../../../cpystal.analysis.html#cpystal.analysis.thermal_conduction.ThermalDiffusionSimulation.dT">[docs]</a>    <span class="k">def</span> <span class="nf">dT</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lx1</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">lx2</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">T_init</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">Q</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">kappa</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">c</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">mode</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;Crank-Nicolson&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Visualize dT vs time.</span>

<span class="sd">        Args:</span>
<span class="sd">            lx1 (float): Left side point (μm).</span>
<span class="sd">            lx2 (float): Right side point (μm).</span>
<span class="sd">            T_init (float): Initial temperature (K).</span>
<span class="sd">            Q (float): Heater power (mW).</span>
<span class="sd">            kappa (float): Thermal conductivity (W/Km).</span>
<span class="sd">            c (float): Specific heat (J/molK).</span>
<span class="sd">            mode (str, optional): Simulation mode. Defaults to &quot;Crank-Nicolson&quot;.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">T</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_excutor</span><span class="p">(</span><span class="n">T_init</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="n">kappa</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">mode</span><span class="p">)</span>
        <span class="n">idx1</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">lx1</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">dx</span><span class="p">)</span>
        <span class="n">idx2</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">lx2</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">dx</span><span class="p">)</span>

        <span class="n">X</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Lt</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Nt</span><span class="p">)</span>
        <span class="n">Y</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span> <span class="o">=</span> <span class="n">T</span><span class="p">[</span><span class="n">idx1</span><span class="p">]</span><span class="o">.</span><span class="n">T</span> <span class="o">-</span> <span class="n">T</span><span class="p">[</span><span class="n">idx2</span><span class="p">]</span><span class="o">.</span><span class="n">T</span>

        <span class="n">fig</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">Figure</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
        <span class="n">ax</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">Subplot</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
        <span class="n">Y_fit</span><span class="p">,</span> <span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">tau</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">exp_fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y_fit</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;τ*ln(100): </span><span class="si">{</span><span class="n">tau</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> (s)&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Lt</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$t$ (s)&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\Delta T$ (K)&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>
    
<div class="viewcode-block" id="ThermalDiffusionSimulation.tau_vs_c"><a class="viewcode-back" href="../../../cpystal.analysis.html#cpystal.analysis.thermal_conduction.ThermalDiffusionSimulation.tau_vs_c">[docs]</a>    <span class="k">def</span> <span class="nf">tau_vs_c</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lx1</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">lx2</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">T_init</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">Q</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">kappa</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">mode</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;Crank-Nicolson&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Visualize tau vs specific heat.</span>

<span class="sd">        Args:</span>
<span class="sd">            lx1 (float): Left side point (μm).</span>
<span class="sd">            lx2 (float): Right side point (μm).</span>
<span class="sd">            T_init (float): Initial temperature (K).</span>
<span class="sd">            Q (float): Heater power (mW).</span>
<span class="sd">            kappa (float): Thermal conductivity (W/Km).</span>
<span class="sd">            mode (str, optional): Simulation mode. Defaults to &quot;Crank-Nicolson&quot;.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">idx1</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">lx1</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">dx</span><span class="p">)</span>
        <span class="n">idx2</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">lx2</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">dx</span><span class="p">)</span>
        <span class="n">X</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Lt</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Nt</span><span class="p">)</span>
        <span class="n">c_max</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">100</span>
        <span class="n">specific_heat</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">c_max</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
        <span class="n">tau_list</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">specific_heat</span><span class="p">:</span>
            <span class="n">_</span><span class="p">,</span> <span class="n">T</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_excutor</span><span class="p">(</span><span class="n">T_init</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="n">kappa</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">mode</span><span class="p">)</span>
            <span class="n">Y</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span> <span class="o">=</span> <span class="n">T</span><span class="p">[</span><span class="n">idx1</span><span class="p">]</span><span class="o">.</span><span class="n">T</span> <span class="o">-</span> <span class="n">T</span><span class="p">[</span><span class="n">idx2</span><span class="p">]</span><span class="o">.</span><span class="n">T</span>
            <span class="n">tau</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cal_tau</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>
            <span class="n">tau_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tau_list</span><span class="p">,</span> <span class="n">tau</span><span class="p">)</span>
        
        <span class="n">fig</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">Figure</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
        <span class="n">ax</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">Subplot</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">specific_heat</span><span class="p">,</span> <span class="n">tau_list</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span>
            <span class="sa">fr</span><span class="s2">&quot;$T_</span><span class="se">{{</span><span class="s2">\mathrm</span><span class="se">{{</span><span class="s2">init</span><span class="se">}}}}</span><span class="s2">$: </span><span class="si">{</span><span class="n">T_init</span><span class="si">}</span><span class="s2">K, Q: </span><span class="si">{</span><span class="n">Q</span><span class="si">}</span><span class="s2">mW, $\kappa$: </span><span class="si">{</span><span class="n">kappa</span><span class="si">}</span><span class="s2">W/Km&quot;</span><span class="o">+</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">+</span>
            <span class="sa">fr</span><span class="s2">&quot;$L_</span><span class="se">{{</span><span class="s2">x</span><span class="se">}}</span><span class="s2">$: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">Lx</span><span class="si">}</span><span class="s2">, $L_</span><span class="se">{{</span><span class="s2">y</span><span class="se">}}</span><span class="s2">$: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">Ly</span><span class="si">}</span><span class="s2">, $L_</span><span class="se">{{</span><span class="s2">z</span><span class="se">}}</span><span class="s2">$: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">Lz</span><span class="si">}</span><span class="s2">, $L_</span><span class="se">{{</span><span class="s2">t</span><span class="se">}}</span><span class="s2">$: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">Lt</span><span class="si">}</span><span class="s2">&quot;</span><span class="o">+</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">+</span>
            <span class="sa">fr</span><span class="s2">&quot;$dx$: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">dx</span><span class="si">}</span><span class="s2">, $dt$: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">dt</span><span class="si">}</span><span class="s2">, $l_</span><span class="se">{{</span><span class="s2">x1</span><span class="se">}}</span><span class="s2">$: </span><span class="si">{</span><span class="n">lx1</span><span class="si">}</span><span class="s2">, $l_</span><span class="se">{{</span><span class="s2">x2</span><span class="se">}}</span><span class="s2">$: </span><span class="si">{</span><span class="n">lx2</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">c_max</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$c$ (J/molK)&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\tau$ (s)&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;./tau_vs_c.png&quot;</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>
    
<div class="viewcode-block" id="ThermalDiffusionSimulation.TDMA"><a class="viewcode-back" href="../../../cpystal.analysis.html#cpystal.analysis.thermal_conduction.ThermalDiffusionSimulation.TDMA">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">TDMA</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">d</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">,</span> <span class="n">u</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">,</span> <span class="n">l</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Tri-Diagonal Matrix Algorithm for linear simultaneous equation.</span>

<span class="sd">        Args:</span>
<span class="sd">            d (npt.NDArray): Diagonal elements.</span>
<span class="sd">            u (npt.NDArray): Upper diagonal elements.</span>
<span class="sd">            l (npt.NDArray): Lower diagonal elements.</span>
<span class="sd">            b (npt.NDArray): Right side vector.</span>

<span class="sd">        Returns:</span>
<span class="sd">            npt.NDArray: Answer of the linear simultaneous equation.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">n</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
        <span class="n">P</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="n">Q</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="n">x</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
            <span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">Q</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">Q</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">Q</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">Q</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">x</span></div></div>


<div class="viewcode-block" id="main"><a class="viewcode-back" href="../../../cpystal.analysis.html#cpystal.analysis.thermal_conduction.main">[docs]</a><span class="k">def</span> <span class="nf">main</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="k">pass</span>
    <span class="k">return</span></div>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>

</pre></div>

          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../../index.html">cpystal</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../cpystal.html">cpystal package</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../index.html">Documentation overview</a><ul>
  <li><a href="../../index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2023, Helve.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 5.0.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
    </div>

    

    
  </body>
</html>