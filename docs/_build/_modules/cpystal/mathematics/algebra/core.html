<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>cpystal.mathematics.algebra.core &mdash; cpystal  documentation</title>
      <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
        <script src="../../../../_static/jquery.js"></script>
        <script src="../../../../_static/underscore.js"></script>
        <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../../_static/doctools.js"></script>
    <script src="../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../../index.html" class="icon icon-home">
            cpystal
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../cpystal.html">cpystal package</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">cpystal</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../../index.html">Module code</a></li>
      <li class="breadcrumb-item active">cpystal.mathematics.algebra.core</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for cpystal.mathematics.algebra.core</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;`cpystal.math.core` is a module for mathematical objects.</span>

<span class="sd">Functions:</span>
<span class="sd">    `visualize_spherical_harmonics`</span>

<span class="sd">Classes:</span>
<span class="sd">    `REF`</span>
<span class="sd">    `MatrixREF`</span>
<span class="sd">    `IREF`</span>
<span class="sd">    `PolyInt`</span>
<span class="sd">    `CubicHarmonics`</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">annotations</span>

<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">defaultdict</span>
<span class="kn">from</span> <span class="nn">fractions</span> <span class="kn">import</span> <span class="n">Fraction</span>
<span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">reduce</span>
<span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">product</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">factorial</span><span class="p">,</span> <span class="n">gcd</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">,</span> <span class="n">Iterator</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">overload</span><span class="p">,</span> <span class="n">TypeVar</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span> <span class="c1"># type: ignore</span>
<span class="kn">from</span> <span class="nn">matplotlib.widgets</span> <span class="kn">import</span> <span class="n">Slider</span><span class="p">,</span> <span class="n">Button</span> <span class="c1"># type: ignore</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">numpy.typing</span> <span class="k">as</span> <span class="nn">npt</span>
<span class="kn">from</span> <span class="nn">scipy.special</span> <span class="kn">import</span> <span class="n">sph_harm</span> <span class="c1"># type: ignore</span>


<span class="n">REFchild</span> <span class="o">=</span> <span class="n">TypeVar</span><span class="p">(</span><span class="s2">&quot;REFchild&quot;</span><span class="p">,</span> <span class="n">bound</span><span class="o">=</span><span class="s2">&quot;REF&quot;</span><span class="p">)</span>
<span class="n">MatrixREFchild</span> <span class="o">=</span> <span class="n">TypeVar</span><span class="p">(</span><span class="s2">&quot;MatrixREFchild&quot;</span><span class="p">,</span> <span class="n">bound</span><span class="o">=</span><span class="s2">&quot;MatrixREF&quot;</span><span class="p">)</span>

<div class="viewcode-block" id="REF"><a class="viewcode-back" href="../../../../cpystal.mathematics.algebra.html#cpystal.mathematics.algebra.core.REF">[docs]</a><span class="k">class</span> <span class="nc">REF</span><span class="p">:</span> <span class="c1"># 有理数体Qに√pを添加した単純拡大体Q(√p)のclass REF(Rational Extension Field)</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Rational Extension Field.</span>

<span class="sd">    This class represents an algebraic simple Rational Extension Field with a root of a polynomial: x^2-p, </span>
<span class="sd">    where p is an integer, and negative values are allowed. </span>
<span class="sd">    Depending on the value of p, it may not be an extension field (e.g. p=4), </span>
<span class="sd">    but it can be formally defined even in such cases.</span>

<span class="sd">    Mathematically, an instance of this class is equivalent to an element of the set described as follows:</span>
<span class="sd">        Q(√p)={a+b√p|a,b∈Q}</span>
<span class="sd">    where Q is the field of rational numbers.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        p (int): Square of the generator of simple extension Q(√p).</span>
<span class="sd">        a (Fraction): Rational number. (definition: see above)</span>
<span class="sd">        b (Fraction): Rational number. (definition: see above)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">REFchild</span><span class="p">,</span> <span class="n">p</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">a</span><span class="p">:</span> <span class="n">Fraction</span> <span class="o">=</span> <span class="n">Fraction</span><span class="p">(),</span> <span class="n">b</span><span class="p">:</span> <span class="n">Fraction</span> <span class="o">=</span> <span class="n">Fraction</span><span class="p">())</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">p</span> <span class="c1"># Q[√p]の生成元の2乗</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">:</span> <span class="n">Fraction</span> <span class="o">=</span> <span class="n">a</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="p">:</span> <span class="n">Fraction</span> <span class="o">=</span> <span class="n">b</span>
    
    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">REFchild</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">==</span> <span class="n">Fraction</span><span class="p">()</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span> <span class="o">==</span> <span class="n">Fraction</span><span class="p">():</span>
            <span class="k">return</span> <span class="s2">&quot;0&quot;</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">==</span> <span class="n">Fraction</span><span class="p">():</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="si">}</span><span class="s2">√</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span> <span class="o">==</span> <span class="n">Fraction</span><span class="p">():</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">)</span><span class="si">}</span><span class="s2">+</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="p">)</span><span class="si">}</span><span class="s2">√</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="c1"># return f&quot;({str(self.a)}, {str(self.b)})&quot;</span>
    
    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">REFchild</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">)</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span>

    <span class="k">def</span> <span class="fm">__neg__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">REFchild</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">REFchild</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">REFchild</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">REF</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">p</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">a</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">b</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="fm">__ne__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">REFchild</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__eq__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__lt__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">REFchild</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">REFchild</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">REF</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_float</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">other</span><span class="o">.</span><span class="n">to_float</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&#39;&lt;&#39; not supported between instances of &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39; and &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="fm">__le__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">REFchild</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">REFchild</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">REF</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_float</span><span class="p">()</span> <span class="o">&lt;=</span> <span class="n">other</span><span class="o">.</span><span class="n">to_float</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&#39;&lt;=&#39; not supported between instances of &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39; and &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="fm">__gt__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">REFchild</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">REFchild</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">REF</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_float</span><span class="p">()</span> <span class="o">&gt;</span> <span class="n">other</span><span class="o">.</span><span class="n">to_float</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&#39;&gt;&#39; not supported between instances of &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39; and &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__ge__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">REFchild</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">REFchild</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">REF</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_float</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="n">other</span><span class="o">.</span><span class="n">to_float</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&#39;&gt;=&#39; not supported between instances of &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39; and &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">REFchild</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">REFchild</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">int</span> <span class="ow">or</span> <span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="ow">is</span> <span class="n">Fraction</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">+</span><span class="n">other</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">REF</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">p</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">+</span><span class="n">other</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="o">+</span><span class="n">other</span><span class="o">.</span><span class="n">b</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;REF generator is not same&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;unsupported operand type(s) for +: &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39; and &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__radd__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">REFchild</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">REFchild</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">int</span> <span class="ow">or</span> <span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="ow">is</span> <span class="n">Fraction</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">+</span><span class="n">other</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">REF</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">p</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">+</span><span class="n">other</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="o">+</span><span class="n">other</span><span class="o">.</span><span class="n">b</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;REF generator is not same&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;unsupported operand type(s) for +: &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39; and &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="fm">__iadd__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">REFchild</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">REFchild</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">int</span> <span class="ow">or</span> <span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="ow">is</span> <span class="n">Fraction</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">+=</span> <span class="n">other</span>
            <span class="k">return</span> <span class="bp">self</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">REF</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">p</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">+=</span> <span class="n">other</span><span class="o">.</span><span class="n">a</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">b</span> <span class="o">+=</span> <span class="n">other</span><span class="o">.</span><span class="n">b</span>
                <span class="k">return</span> <span class="bp">self</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;REF generator is not same&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;unsupported operand type(s) for +: &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39; and &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="fm">__sub__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">REFchild</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">REFchild</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">int</span> <span class="ow">or</span> <span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="ow">is</span> <span class="n">Fraction</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">-</span><span class="n">other</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">REF</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">p</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">-</span><span class="n">other</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="o">-</span><span class="n">other</span><span class="o">.</span><span class="n">b</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;REF generator is not same&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;unsupported operand type(s) for -: &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39; and &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="fm">__rsub__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">REFchild</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">REFchild</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">int</span> <span class="ow">or</span> <span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="ow">is</span> <span class="n">Fraction</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">-</span><span class="n">other</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">REF</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">p</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">-</span><span class="n">other</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="o">-</span><span class="n">other</span><span class="o">.</span><span class="n">b</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;REF generator is not same&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;unsupported operand type(s) for -: &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39; and &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="fm">__isub__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">REFchild</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">REFchild</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">int</span> <span class="ow">or</span> <span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="ow">is</span> <span class="n">Fraction</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">-=</span> <span class="n">other</span>
            <span class="k">return</span> <span class="bp">self</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">REF</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">p</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">-=</span> <span class="n">other</span><span class="o">.</span><span class="n">a</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">b</span> <span class="o">-=</span> <span class="n">other</span><span class="o">.</span><span class="n">b</span>
                <span class="k">return</span> <span class="bp">self</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;REF generator is not same&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;unsupported operand type(s) for -: &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39; and &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__mul__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">REFchild</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">REFchild</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">int</span> <span class="ow">or</span> <span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="ow">is</span> <span class="n">Fraction</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">*</span><span class="n">other</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="o">*</span><span class="n">other</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">REF</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">p</span><span class="p">:</span>
                <span class="n">p</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span>
                <span class="n">a</span><span class="p">:</span> <span class="n">Fraction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span>
                <span class="n">b</span><span class="p">:</span> <span class="n">Fraction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span>
                <span class="n">c</span><span class="p">:</span> <span class="n">Fraction</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">a</span>
                <span class="n">d</span><span class="p">:</span> <span class="n">Fraction</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">b</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span> <span class="n">a</span><span class="o">*</span><span class="n">c</span> <span class="o">+</span> <span class="n">p</span><span class="o">*</span><span class="n">b</span><span class="o">*</span><span class="n">d</span><span class="p">,</span> <span class="n">a</span><span class="o">*</span><span class="n">d</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">c</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;REF generator is not same&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;unsupported operand type(s) for *: &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39; and &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__rmul__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">REFchild</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">REFchild</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">int</span> <span class="ow">or</span> <span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="ow">is</span> <span class="n">Fraction</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">*</span><span class="n">other</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="o">*</span><span class="n">other</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">REF</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">p</span><span class="p">:</span>
                <span class="n">p</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span>
                <span class="n">a</span><span class="p">:</span> <span class="n">Fraction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span>
                <span class="n">b</span><span class="p">:</span> <span class="n">Fraction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span>
                <span class="n">c</span><span class="p">:</span> <span class="n">Fraction</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">a</span>
                <span class="n">d</span><span class="p">:</span> <span class="n">Fraction</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">b</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span> <span class="n">a</span><span class="o">*</span><span class="n">c</span> <span class="o">+</span> <span class="n">p</span><span class="o">*</span><span class="n">b</span><span class="o">*</span><span class="n">d</span><span class="p">,</span> <span class="n">a</span><span class="o">*</span><span class="n">d</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">c</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;REF generator is not same&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;unsupported operand type(s) for *: &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39; and &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__imul__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">REFchild</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">REFchild</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">int</span> <span class="ow">or</span> <span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="ow">is</span> <span class="n">Fraction</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">*=</span> <span class="n">other</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">b</span> <span class="o">*=</span> <span class="n">other</span>
            <span class="k">return</span> <span class="bp">self</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">REF</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">p</span><span class="p">:</span>
                <span class="n">p</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span>
                <span class="n">a</span><span class="p">:</span> <span class="n">Fraction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span>
                <span class="n">b</span><span class="p">:</span> <span class="n">Fraction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span>
                <span class="n">c</span><span class="p">:</span> <span class="n">Fraction</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">a</span>
                <span class="n">d</span><span class="p">:</span> <span class="n">Fraction</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">b</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="n">c</span> <span class="o">+</span> <span class="n">p</span><span class="o">*</span><span class="n">b</span><span class="o">*</span><span class="n">d</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="n">d</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">c</span>
                <span class="k">return</span> <span class="bp">self</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;REF generator is not same&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;unsupported operand type(s) for *: &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39; and &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="fm">__truediv__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">REFchild</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">REFchild</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">int</span> <span class="ow">or</span> <span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="ow">is</span> <span class="n">Fraction</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">/</span><span class="n">other</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="o">/</span><span class="n">other</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">REF</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">p</span><span class="p">:</span>
                <span class="n">p</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span>
                <span class="n">a</span><span class="p">:</span> <span class="n">Fraction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span>
                <span class="n">b</span><span class="p">:</span> <span class="n">Fraction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span>
                <span class="n">c</span><span class="p">:</span> <span class="n">Fraction</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">a</span>
                <span class="n">d</span><span class="p">:</span> <span class="n">Fraction</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">b</span>
                <span class="n">aa</span><span class="p">:</span> <span class="n">Fraction</span> <span class="o">=</span> <span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">c</span> <span class="o">-</span> <span class="n">p</span><span class="o">*</span><span class="n">b</span><span class="o">*</span><span class="n">d</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">c</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">p</span> <span class="o">*</span> <span class="n">d</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
                <span class="n">bb</span><span class="p">:</span> <span class="n">Fraction</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">a</span><span class="o">*</span><span class="n">d</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">c</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">c</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">p</span> <span class="o">*</span> <span class="n">d</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">aa</span><span class="p">,</span> <span class="n">bb</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;REF generator is not same&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;unsupported operand type(s) for /: &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39; and &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__rtruediv__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">REFchild</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">REFchild</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">int</span> <span class="ow">or</span> <span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="ow">is</span> <span class="n">Fraction</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">/</span><span class="n">other</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="o">/</span><span class="n">other</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">REF</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">p</span><span class="p">:</span>
                <span class="n">p</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span>
                <span class="n">a</span><span class="p">:</span> <span class="n">Fraction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span>
                <span class="n">b</span><span class="p">:</span> <span class="n">Fraction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span>
                <span class="n">c</span><span class="p">:</span> <span class="n">Fraction</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">a</span>
                <span class="n">d</span><span class="p">:</span> <span class="n">Fraction</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">b</span>
                <span class="n">aa</span><span class="p">:</span> <span class="n">Fraction</span> <span class="o">=</span> <span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">c</span> <span class="o">-</span> <span class="n">p</span><span class="o">*</span><span class="n">b</span><span class="o">*</span><span class="n">d</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">c</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">p</span> <span class="o">*</span> <span class="n">d</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
                <span class="n">bb</span><span class="p">:</span> <span class="n">Fraction</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">a</span><span class="o">*</span><span class="n">d</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">c</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">c</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">p</span> <span class="o">*</span> <span class="n">d</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">aa</span><span class="p">,</span> <span class="n">bb</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;REF generator is not same&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;unsupported operand type(s) for /: &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39; and &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__itruediv__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">REFchild</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">REFchild</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">int</span> <span class="ow">or</span> <span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="ow">is</span> <span class="n">Fraction</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">/=</span> <span class="n">other</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">b</span> <span class="o">/=</span> <span class="n">other</span>
            <span class="k">return</span> <span class="bp">self</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">REF</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">p</span><span class="p">:</span>
                <span class="n">p</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span>
                <span class="n">a</span><span class="p">:</span> <span class="n">Fraction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span>
                <span class="n">b</span><span class="p">:</span> <span class="n">Fraction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span>
                <span class="n">c</span><span class="p">:</span> <span class="n">Fraction</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">a</span>
                <span class="n">d</span><span class="p">:</span> <span class="n">Fraction</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">b</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">c</span> <span class="o">-</span> <span class="n">p</span><span class="o">*</span><span class="n">b</span><span class="o">*</span><span class="n">d</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">c</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">p</span> <span class="o">*</span> <span class="n">d</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">a</span><span class="o">*</span><span class="n">d</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">c</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">c</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">p</span> <span class="o">*</span> <span class="n">d</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
                <span class="k">return</span> <span class="bp">self</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;REF generator is not same&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;unsupported operand type(s) for /: &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39; and &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__copy__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">REFchild</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">REFchild</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span>
    
<div class="viewcode-block" id="REF.copy"><a class="viewcode-back" href="../../../../cpystal.mathematics.algebra.html#cpystal.mathematics.algebra.core.REF.copy">[docs]</a>    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">REFchild</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">REFchild</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span></div>

    <span class="k">def</span> <span class="nf">__deepcopy__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">REFchild</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">REFchild</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="p">)</span>

<div class="viewcode-block" id="REF.deepcopy"><a class="viewcode-back" href="../../../../cpystal.mathematics.algebra.html#cpystal.mathematics.algebra.core.REF.deepcopy">[docs]</a>    <span class="k">def</span> <span class="nf">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">REFchild</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">REFchild</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="REF.zero"><a class="viewcode-back" href="../../../../cpystal.mathematics.algebra.html#cpystal.mathematics.algebra.core.REF.zero">[docs]</a>    <span class="k">def</span> <span class="nf">zero</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">REFchild</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">REFchild</span><span class="p">:</span> <span class="c1"># 加法単位元 乗法零元</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span> <span class="n">Fraction</span><span class="p">(),</span> <span class="n">Fraction</span><span class="p">())</span></div>
    
<div class="viewcode-block" id="REF.inv"><a class="viewcode-back" href="../../../../cpystal.mathematics.algebra.html#cpystal.mathematics.algebra.core.REF.inv">[docs]</a>    <span class="k">def</span> <span class="nf">inv</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">REFchild</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">REFchild</span><span class="p">:</span> <span class="c1"># 乗法逆元</span>
        <span class="n">p</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span>
        <span class="n">a</span><span class="p">:</span> <span class="n">Fraction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span>
        <span class="n">b</span><span class="p">:</span> <span class="n">Fraction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">a</span><span class="o">/</span><span class="p">(</span><span class="n">a</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">p</span><span class="o">*</span><span class="n">b</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span> <span class="o">-</span><span class="n">b</span><span class="o">/</span><span class="p">(</span><span class="n">a</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">p</span><span class="o">*</span><span class="n">b</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span></div>

<div class="viewcode-block" id="REF.swap"><a class="viewcode-back" href="../../../../cpystal.mathematics.algebra.html#cpystal.mathematics.algebra.core.REF.swap">[docs]</a>    <span class="k">def</span> <span class="nf">swap</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">REFchild</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">REFchild</span><span class="p">:</span> <span class="c1"># 有理部と無理部を入れ替えたREFを生成</span>
        <span class="n">p</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span>
        <span class="n">a</span><span class="p">:</span> <span class="n">Fraction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span>
        <span class="n">b</span><span class="p">:</span> <span class="n">Fraction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span></div>

<div class="viewcode-block" id="REF.conjugate"><a class="viewcode-back" href="../../../../cpystal.mathematics.algebra.html#cpystal.mathematics.algebra.core.REF.conjugate">[docs]</a>    <span class="k">def</span> <span class="nf">conjugate</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">REFchild</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">REFchild</span><span class="p">:</span> <span class="c1"># 一般化した共役(p=-1のとき複素共役に一致)</span>
        <span class="n">p</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span>
        <span class="n">a</span><span class="p">:</span> <span class="n">Fraction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span>
        <span class="n">b</span><span class="p">:</span> <span class="n">Fraction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="o">-</span><span class="n">b</span><span class="p">)</span></div>

<div class="viewcode-block" id="REF.to_float"><a class="viewcode-back" href="../../../../cpystal.mathematics.algebra.html#cpystal.mathematics.algebra.core.REF.to_float">[docs]</a>    <span class="k">def</span> <span class="nf">to_float</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">REFchild</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="n">p</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span>
        <span class="k">if</span> <span class="n">p</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;negative `REF.p`: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="si">}</span><span class="s2">; to get the value of this REF instance, use &#39;to_complex&#39;&quot;</span><span class="p">)</span>
        <span class="n">a</span><span class="p">:</span> <span class="n">Fraction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span>
        <span class="n">b</span><span class="p">:</span> <span class="n">Fraction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span>
        <span class="k">return</span> <span class="n">a</span><span class="o">.</span><span class="n">numerator</span><span class="o">/</span><span class="n">a</span><span class="o">.</span><span class="n">denominator</span> <span class="o">+</span> <span class="n">b</span><span class="o">.</span><span class="n">numerator</span><span class="o">/</span><span class="n">b</span><span class="o">.</span><span class="n">denominator</span><span class="o">*</span><span class="p">(</span><span class="n">p</span><span class="o">**</span><span class="mf">0.5</span><span class="p">)</span> <span class="c1"># float</span></div>

<div class="viewcode-block" id="REF.to_complex"><a class="viewcode-back" href="../../../../cpystal.mathematics.algebra.html#cpystal.mathematics.algebra.core.REF.to_complex">[docs]</a>    <span class="k">def</span> <span class="nf">to_complex</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">REFchild</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">complex</span><span class="p">:</span>
        <span class="n">p</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span>
        <span class="n">a</span><span class="p">:</span> <span class="n">Fraction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span>
        <span class="n">b</span><span class="p">:</span> <span class="n">Fraction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span>
        <span class="k">return</span> <span class="nb">complex</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">numerator</span><span class="o">/</span><span class="n">a</span><span class="o">.</span><span class="n">denominator</span> <span class="o">+</span> <span class="n">b</span><span class="o">.</span><span class="n">numerator</span><span class="o">/</span><span class="n">b</span><span class="o">.</span><span class="n">denominator</span><span class="o">*</span><span class="p">(</span><span class="n">p</span><span class="o">**</span><span class="mf">0.5</span><span class="p">))</span> <span class="c1"># complex</span></div></div>

<span class="c1"># 型エイリアス</span>
<span class="n">Matrix</span> <span class="o">=</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">]]</span>

<div class="viewcode-block" id="MatrixREF"><a class="viewcode-back" href="../../../../cpystal.mathematics.algebra.html#cpystal.mathematics.algebra.core.MatrixREF">[docs]</a><span class="k">class</span> <span class="nc">MatrixREF</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Matrix of `REF` instance.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        p (int): Square of the generator of simple extension Q(√p).</span>
<span class="sd">        mat (list[list[REF]]): 2-dimension matrix of `REF` instance.</span>
<span class="sd">        shape (tuple[int, int]): Shape of `MatrixREF.mat`. First element is the number of row, second is the number of column.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">MatrixREFchild</span><span class="p">,</span> <span class="n">p</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">mat</span><span class="p">:</span> <span class="n">Matrix</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span> <span class="c1"># p:int, mat:list[list[int/Fraction]]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">p</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mat</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="n">REF</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">mat</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>         
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">mat</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">mat</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
            <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">mat</span><span class="p">:</span>
                <span class="n">now</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">REF</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">row</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">int</span> <span class="ow">or</span> <span class="nb">type</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="ow">is</span> <span class="n">Fraction</span><span class="p">:</span>
                        <span class="n">now</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">REF</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">Fraction</span><span class="p">(</span><span class="n">r</span><span class="p">)))</span>
                    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">REF</span><span class="p">):</span>
                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span> <span class="o">==</span> <span class="n">r</span><span class="o">.</span><span class="n">p</span><span class="p">:</span>
                            <span class="n">now</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">())</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;REF generator is not same&quot;</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;type of matrix components must be int/Fraction/REF&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">mat</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">now</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">MatrixREFchild</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">res</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;,</span><span class="se">\n</span><span class="s1"> &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;[&#39;</span><span class="o">+</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span> <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">row</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;]&#39;</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mat</span><span class="p">])</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;[</span><span class="si">{</span><span class="n">res</span><span class="si">}</span><span class="s2">]&quot;</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">MatrixREFchild</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">res</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;,</span><span class="se">\n</span><span class="s1"> &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;[&#39;</span><span class="o">+</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span> <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">row</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;]&#39;</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mat</span><span class="p">])</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;[</span><span class="si">{</span><span class="n">res</span><span class="si">}</span><span class="s2">]&quot;</span>
    
    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">MatrixREFchild</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mat</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">MatrixREFchild</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="n">Fraction</span> <span class="o">|</span> <span class="n">MatrixREFchild</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">bool</span><span class="p">]]:</span> <span class="c1"># type: ignore</span>
        <span class="n">m</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape</span>
        <span class="n">smat</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="n">REF</span><span class="p">]]</span> 
        <span class="n">omat</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="n">REF</span><span class="p">]]</span>
        <span class="n">res</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">bool</span><span class="p">]]</span>
        <span class="n">other_</span><span class="p">:</span> <span class="n">REF</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">int</span><span class="p">:</span>
            <span class="n">other_</span> <span class="o">=</span> <span class="n">REF</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span> <span class="n">Fraction</span><span class="p">(</span><span class="n">other</span><span class="p">))</span>
            <span class="n">smat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mat</span>
            <span class="n">res</span> <span class="o">=</span> <span class="p">[[</span><span class="n">smat</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">==</span><span class="n">other_</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">)]</span>
            <span class="k">return</span> <span class="n">res</span> <span class="c1"># list[list[bool]]</span>
        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="ow">is</span> <span class="n">Fraction</span><span class="p">:</span>
            <span class="n">other_</span> <span class="o">=</span> <span class="n">REF</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
            <span class="n">smat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mat</span>
            <span class="n">res</span> <span class="o">=</span> <span class="p">[[</span><span class="n">smat</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">==</span><span class="n">other_</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">)]</span>
            <span class="k">return</span> <span class="n">res</span> <span class="c1"># list[list[bool]]</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">MatrixREF</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">p</span><span class="p">:</span>
                <span class="n">smat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mat</span>
                <span class="n">omat</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">mat</span>
                <span class="n">res</span> <span class="o">=</span> <span class="p">[[</span><span class="n">smat</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">==</span><span class="n">omat</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">)]</span>
                <span class="k">return</span> <span class="n">res</span> <span class="c1"># list[list[bool]]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;REF generator is not same&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;incompatible type(s) for : &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39; and &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="fm">__ne__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">MatrixREFchild</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">!=</span> <span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">shape</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="n">m</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mat</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">mat</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]:</span>
                    <span class="k">return</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="fm">__neg__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">MatrixREFchild</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MatrixREFchild</span><span class="p">:</span>
        <span class="n">m</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape</span>
        <span class="n">res</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="n">REF</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[[</span><span class="n">REF</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">)]</span><span class="o">*</span><span class="n">n</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">)]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
                <span class="n">res</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">mat</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>
        <span class="n">ret</span><span class="p">:</span> <span class="n">MatrixREFchild</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span> <span class="n">mat</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
        <span class="n">ret</span><span class="o">.</span><span class="n">mat</span> <span class="o">=</span> <span class="n">res</span>
        <span class="n">ret</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ret</span>

    <span class="k">def</span> <span class="fm">__matmul__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">MatrixREFchild</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">MatrixREFchild</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MatrixREFchild</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">MatrixREF</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">p</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                    <span class="c1"># (l,m)*(m,n) -&gt; (l,n)</span>
                    <span class="n">l</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">m</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                    <span class="n">n</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                    <span class="n">smat</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="n">REF</span><span class="p">]]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mat</span>
                    <span class="n">omat</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="n">REF</span><span class="p">]]</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">mat</span>
                    <span class="n">res</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="n">REF</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[[</span><span class="n">REF</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">)]</span><span class="o">*</span><span class="n">n</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">l</span><span class="p">)]</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">l</span><span class="p">):</span>
                        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
                            <span class="n">val</span><span class="p">:</span> <span class="n">REF</span> <span class="o">=</span> <span class="n">REF</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">)</span>
                            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
                                <span class="n">val</span> <span class="o">+=</span> <span class="n">smat</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">omat</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">k</span><span class="p">]</span>
                            <span class="n">res</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>
                    <span class="n">ret</span><span class="p">:</span> <span class="n">MatrixREFchild</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span> <span class="n">mat</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
                    <span class="n">ret</span><span class="o">.</span><span class="n">mat</span> <span class="o">=</span> <span class="n">res</span>
                    <span class="n">ret</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
                    <span class="k">return</span> <span class="n">ret</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;matrix shape is inappropriate&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;REF generator is not same&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;unsupported operand type(s) for @: &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39; and &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
    
    <span class="nd">@overload</span>
    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">MatrixREFchild</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">REF</span><span class="p">]:</span>
        <span class="o">...</span>
    <span class="nd">@overload</span>
    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">MatrixREFchild</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">slice</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="n">REF</span><span class="p">]]:</span>
        <span class="o">...</span>
    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">MatrixREFchild</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">mat</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
    
    <span class="k">def</span> <span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">MatrixREFchild</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mat</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        
    <span class="k">def</span> <span class="nf">__copy__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">MatrixREFchild</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MatrixREFchild</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span>
    
<div class="viewcode-block" id="MatrixREF.copy"><a class="viewcode-back" href="../../../../cpystal.mathematics.algebra.html#cpystal.mathematics.algebra.core.MatrixREF.copy">[docs]</a>    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">MatrixREFchild</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MatrixREFchild</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span></div>

    <span class="k">def</span> <span class="nf">__deepcopy__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">MatrixREFchild</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MatrixREFchild</span><span class="p">:</span>
        <span class="n">ret</span><span class="p">:</span> <span class="n">MatrixREFchild</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">)</span>
        <span class="n">ret</span><span class="o">.</span><span class="n">mat</span> <span class="o">=</span> <span class="p">[[</span><span class="bp">self</span><span class="o">.</span><span class="n">mat</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">()</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span>
        <span class="n">ret</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape</span>
        <span class="k">return</span> <span class="n">ret</span>

<div class="viewcode-block" id="MatrixREF.deepcopy"><a class="viewcode-back" href="../../../../cpystal.mathematics.algebra.html#cpystal.mathematics.algebra.core.MatrixREF.deepcopy">[docs]</a>    <span class="k">def</span> <span class="nf">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">MatrixREFchild</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MatrixREFchild</span><span class="p">:</span>
        <span class="n">ret</span><span class="p">:</span> <span class="n">MatrixREFchild</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">)</span>
        <span class="n">ret</span><span class="o">.</span><span class="n">mat</span> <span class="o">=</span> <span class="p">[[</span><span class="bp">self</span><span class="o">.</span><span class="n">mat</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">()</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span>
        <span class="n">ret</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape</span>
        <span class="k">return</span> <span class="n">ret</span></div>

<div class="viewcode-block" id="MatrixREF.identity"><a class="viewcode-back" href="../../../../cpystal.mathematics.algebra.html#cpystal.mathematics.algebra.core.MatrixREF.identity">[docs]</a>    <span class="k">def</span> <span class="nf">identity</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">MatrixREFchild</span><span class="p">,</span> <span class="n">shape</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MatrixREFchild</span><span class="p">:</span>
        <span class="c1"># m×n単位行列</span>
        <span class="k">if</span> <span class="n">shape</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">m</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">m</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">shape</span>
        <span class="n">p</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span>
        <span class="n">res</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="n">REF</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[[</span><span class="n">REF</span><span class="p">(</span><span class="n">p</span><span class="p">)]</span><span class="o">*</span><span class="n">n</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">)]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">n</span><span class="p">)):</span>
            <span class="n">res</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">REF</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">Fraction</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">Fraction</span><span class="p">())</span>
        <span class="n">ret</span><span class="p">:</span> <span class="n">MatrixREFchild</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
        <span class="n">ret</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
        <span class="n">ret</span><span class="o">.</span><span class="n">mat</span> <span class="o">=</span> <span class="n">res</span>
        <span class="k">return</span> <span class="n">ret</span></div>
    
<div class="viewcode-block" id="MatrixREF.sum"><a class="viewcode-back" href="../../../../cpystal.mathematics.algebra.html#cpystal.mathematics.algebra.core.MatrixREF.sum">[docs]</a>    <span class="k">def</span> <span class="nf">sum</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">MatrixREFchild</span><span class="p">,</span> <span class="n">axis</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">REF</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">REF</span><span class="p">]:</span>
        <span class="n">m</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape</span>
        <span class="n">smat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mat</span>
        <span class="n">res</span><span class="p">:</span> <span class="n">REF</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">REF</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">axis</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">res</span> <span class="o">=</span> <span class="n">REF</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
                    <span class="n">res</span> <span class="o">+=</span> <span class="n">smat</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">res</span> <span class="c1"># REF</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">axis</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">axis</span> <span class="o">==</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span>
                <span class="n">res</span> <span class="o">=</span> <span class="p">[</span><span class="n">REF</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">)]</span><span class="o">*</span><span class="n">n</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
                    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
                        <span class="n">res</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+=</span> <span class="n">smat</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>
                <span class="k">return</span> <span class="n">res</span> <span class="c1"># list[REF]</span>
            <span class="k">elif</span> <span class="n">axis</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">axis</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">res</span> <span class="o">=</span> <span class="p">[</span><span class="n">REF</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">)]</span><span class="o">*</span><span class="n">m</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
                    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
                        <span class="n">res</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="n">smat</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>
                <span class="k">return</span> <span class="n">res</span> <span class="c1"># list[REF]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;axis </span><span class="si">{</span><span class="n">axis</span><span class="si">}</span><span class="s2"> is out of bounds for MatrixREF of dimension </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="MatrixREF.to_ndarray"><a class="viewcode-back" href="../../../../cpystal.mathematics.algebra.html#cpystal.mathematics.algebra.core.MatrixREF.to_ndarray">[docs]</a>    <span class="k">def</span> <span class="nf">to_ndarray</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">MatrixREFchild</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">elem</span><span class="o">.</span><span class="n">to_float</span><span class="p">()</span> <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">row</span><span class="p">]</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mat</span><span class="p">])</span></div></div>


<div class="viewcode-block" id="IREF"><a class="viewcode-back" href="../../../../cpystal.mathematics.algebra.html#cpystal.mathematics.algebra.core.IREF">[docs]</a><span class="k">class</span> <span class="nc">IREF</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Infinite Rational Extention Field.</span>

<span class="sd">    The set of all rational numbers plus the square roots of all square-free integers </span>
<span class="sd">    forms a field with the usual addition, subtraction, and division operations.</span>
<span class="sd">    An instance of this class corresponds to an element of this Infinite Rational Extention Field (IREF).</span>

<span class="sd">    The following types of the argument of the constructor of this class `iref_number` are allowed:</span>
<span class="sd">        `int`, `Fraction`, `tuple[int, int | Fraction]`, `list[tuple[int, int | Fraction]]`, or `defaultdict[int, Fraction]`.</span>
<span class="sd">    </span>
<span class="sd">    The keys of the attribute `root_value_dict` are square roots of square-free integers in IREF.</span>
<span class="sd">    The values of the attribute `root_value_dict` are the coefficients of the keys which represent square roots of square-free integers.</span>

<span class="sd">    Examples:</span>
<span class="sd">    ```</span>
<span class="sd">    print(IREF())</span>
<span class="sd">    &gt;&gt;&gt; 0</span>
<span class="sd">    a = IREF([(2,1), (3,-1)]            # √2-√3</span>
<span class="sd">    a += IREF((-1,Fraction(4,3))) * 3   # a == √2-√3+4√-1</span>
<span class="sd">    a[5] = Fraction(1,2)                # a == √2-√3+4√-1+1/2√5</span>
<span class="sd">    b = IREF(3)                         # 3</span>
<span class="sd">    print(a * b)</span>
<span class="sd">    &gt;&gt;&gt; 3√2 + -3√3 + 12√-1 + 3/2√5</span>
<span class="sd">    print(a.root_value_dict)</span>
<span class="sd">    &gt;&gt;&gt; defaultdict(&lt;class &#39;fractions.Fraction&#39;&gt;, {2: Fraction(1, 1), 3: Fraction(-1, 1), -1: Fraction(4, 1), 5: Fraction(1, 2)})</span>
<span class="sd">    print(b.root_value_dict)</span>
<span class="sd">    &gt;&gt;&gt; defaultdict(&lt;class &#39;fractions.Fraction&#39;&gt;, {1: Fraction(3, 1)})</span>
<span class="sd">    ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__make_square_factor_list</span><span class="p">(</span><span class="n">n</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="mi">5</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]]:</span> <span class="c1"># type: ignore</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate a list of square factor.</span>

<span class="sd">        Note:</span>
<span class="sd">            Time complexity: Θ(nloglogn).</span>

<span class="sd">        Args:</span>
<span class="sd">            n (int, optional): Non-negative integer. Defaults to 10**5.</span>

<span class="sd">        Returns:</span>
<span class="sd">            tuple[list[int], list[int], list[int]]: </span>
<span class="sd">                List of smallest prime factor. The i-th element represents the smallest prime factor of i.</span>
<span class="sd">                List of square factor. The i-th element represents the square factor of i.</span>
<span class="sd">                List of prime number.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># spf[i] := Smallest Prime Factor of i. ([0,0,2,3,2,5,2,7,...])</span>
        <span class="c1"># __square_factor[i] := Square Factor of i. ([1,1,1,1,2,1,1,1,2,3,...])</span>
        <span class="k">def</span> <span class="nf">isqrt</span><span class="p">(</span><span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span> <span class="c1"># floor(sqrt(n)): Θ(logn)</span>
            <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span>
            <span class="n">ok</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">ng</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">n</span><span class="o">+</span><span class="mi">1</span>
            <span class="k">while</span> <span class="nb">abs</span><span class="p">(</span><span class="n">ok</span><span class="o">-</span><span class="n">ng</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">ng</span><span class="o">+</span><span class="n">ok</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span>
                <span class="k">if</span> <span class="n">mid</span><span class="o">**</span><span class="mi">2</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">:</span>
                    <span class="n">ok</span> <span class="o">=</span> <span class="n">mid</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">ng</span> <span class="o">=</span> <span class="n">mid</span>
            <span class="k">return</span> <span class="n">ok</span>
        <span class="n">spf</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">spf</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">spf</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">square_factor</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">primes</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">isqrt</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">spf</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">i</span><span class="p">:</span>
                <span class="n">primes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">):</span>
                    <span class="n">spf</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>
                <span class="n">k</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="k">while</span> <span class="n">i</span> <span class="o">**</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span> <span class="o">**</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="p">),</span> <span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span> <span class="o">**</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="p">)):</span>
                        <span class="n">square_factor</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">*=</span> <span class="n">i</span>
                    <span class="n">k</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">spf</span><span class="p">,</span> <span class="n">square_factor</span><span class="p">,</span> <span class="n">primes</span>
    <span class="n">__smallest_prime_factor</span><span class="p">,</span> <span class="n">__square_factor</span><span class="p">,</span> <span class="n">__primes</span> <span class="o">=</span> <span class="n">__make_square_factor_list</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">iref_number</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="n">Fraction</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span> <span class="o">|</span> <span class="n">Fraction</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span> <span class="o">|</span> <span class="n">Fraction</span><span class="p">]]</span> <span class="o">|</span> <span class="n">defaultdict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Fraction</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_d</span><span class="p">:</span> <span class="n">defaultdict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Fraction</span><span class="p">]</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="n">Fraction</span><span class="p">)</span>
        <span class="n">message</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;type of &#39;iref_number&#39; must be `int`, `Fraction`, `tuple[int, int | Fraction]`, `list[tuple[int, int | Fraction]]`, or `defaultdict[int, Fraction]`&quot;</span>
        <span class="n">sf</span><span class="p">:</span> <span class="nb">int</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">iref_number</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">iref_number</span><span class="p">,</span> <span class="n">Fraction</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_d</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">Fraction</span><span class="p">(</span><span class="n">iref_number</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">iref_number</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="n">root</span><span class="p">,</span> <span class="n">val</span> <span class="o">=</span> <span class="n">iref_number</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
                <span class="n">sf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cal_square_factor</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">root</span><span class="p">))</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_d</span><span class="p">[</span><span class="n">root</span><span class="o">//</span><span class="p">(</span><span class="n">sf</span><span class="o">**</span><span class="mi">2</span><span class="p">)]</span> <span class="o">=</span> <span class="n">Fraction</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="o">*</span> <span class="n">sf</span>
                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">Fraction</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_d</span><span class="p">[</span><span class="n">root</span><span class="o">//</span><span class="p">(</span><span class="n">sf</span><span class="o">**</span><span class="mi">2</span><span class="p">)]</span> <span class="o">=</span> <span class="n">val</span> <span class="o">*</span> <span class="n">sf</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">iref_number</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">root</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">iref_number</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
                    <span class="n">sf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cal_square_factor</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">root</span><span class="p">))</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_d</span><span class="p">[</span><span class="n">root</span><span class="o">//</span><span class="p">(</span><span class="n">sf</span><span class="o">**</span><span class="mi">2</span><span class="p">)]</span> <span class="o">=</span> <span class="n">Fraction</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="o">*</span> <span class="n">sf</span>
                    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">Fraction</span><span class="p">):</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_d</span><span class="p">[</span><span class="n">root</span><span class="o">//</span><span class="p">(</span><span class="n">sf</span><span class="o">**</span><span class="mi">2</span><span class="p">)]</span> <span class="o">=</span> <span class="n">val</span> <span class="o">*</span> <span class="n">sf</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">iref_number</span><span class="p">,</span> <span class="n">defaultdict</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">root</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">iref_number</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">sf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cal_square_factor</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">root</span><span class="p">))</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">Fraction</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_d</span><span class="p">[</span><span class="n">root</span><span class="o">//</span><span class="p">(</span><span class="n">sf</span><span class="o">**</span><span class="mi">2</span><span class="p">)]</span> <span class="o">=</span> <span class="n">val</span> <span class="o">*</span> <span class="n">sf</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">res</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">for</span> <span class="n">root</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_d</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">val</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">root</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">res</span> <span class="o">=</span> <span class="n">res</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">val</span><span class="si">}</span><span class="s2"> + &quot;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">val</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="n">res</span> <span class="o">=</span> <span class="n">res</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;√</span><span class="si">{</span><span class="n">root</span><span class="si">}</span><span class="s2"> + &quot;</span>
                    <span class="k">elif</span> <span class="n">val</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                        <span class="n">res</span> <span class="o">=</span> <span class="n">res</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;-√</span><span class="si">{</span><span class="n">root</span><span class="si">}</span><span class="s2"> + &quot;</span>
                    <span class="k">elif</span> <span class="n">val</span><span class="o">.</span><span class="n">numerator</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="n">res</span> <span class="o">=</span> <span class="n">res</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;√</span><span class="si">{</span><span class="n">root</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">val</span><span class="o">.</span><span class="n">denominator</span><span class="si">}</span><span class="s2"> + &quot;</span>
                    <span class="k">elif</span> <span class="n">val</span><span class="o">.</span><span class="n">numerator</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                        <span class="n">res</span> <span class="o">=</span> <span class="n">res</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;-√</span><span class="si">{</span><span class="n">root</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">val</span><span class="o">.</span><span class="n">denominator</span><span class="si">}</span><span class="s2"> + &quot;</span>
                    <span class="k">elif</span> <span class="n">val</span><span class="o">.</span><span class="n">denominator</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="n">res</span> <span class="o">=</span> <span class="n">res</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">val</span><span class="o">.</span><span class="n">numerator</span><span class="si">}</span><span class="s2">√</span><span class="si">{</span><span class="n">root</span><span class="si">}</span><span class="s2"> + &quot;</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">res</span> <span class="o">=</span> <span class="n">res</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">val</span><span class="o">.</span><span class="n">numerator</span><span class="si">}</span><span class="s2">√</span><span class="si">{</span><span class="n">root</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">val</span><span class="o">.</span><span class="n">denominator</span><span class="si">}</span><span class="s2"> + &quot;</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;+ &quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;+ -&quot;</span><span class="p">,</span> <span class="s2">&quot;- &quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;  &quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">res</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;0&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">res</span>
    
    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">res</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">for</span> <span class="n">root</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_d</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">val</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">root</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">res</span> <span class="o">=</span> <span class="n">res</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">val</span><span class="si">}</span><span class="s2"> + &quot;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">val</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="n">res</span> <span class="o">=</span> <span class="n">res</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;√</span><span class="si">{</span><span class="n">root</span><span class="si">}</span><span class="s2"> + &quot;</span>
                    <span class="k">elif</span> <span class="n">val</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                        <span class="n">res</span> <span class="o">=</span> <span class="n">res</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;-√</span><span class="si">{</span><span class="n">root</span><span class="si">}</span><span class="s2"> + &quot;</span>
                    <span class="k">elif</span> <span class="n">val</span><span class="o">.</span><span class="n">numerator</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="n">res</span> <span class="o">=</span> <span class="n">res</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;√</span><span class="si">{</span><span class="n">root</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">val</span><span class="o">.</span><span class="n">denominator</span><span class="si">}</span><span class="s2"> + &quot;</span>
                    <span class="k">elif</span> <span class="n">val</span><span class="o">.</span><span class="n">numerator</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                        <span class="n">res</span> <span class="o">=</span> <span class="n">res</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;-√</span><span class="si">{</span><span class="n">root</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">val</span><span class="o">.</span><span class="n">denominator</span><span class="si">}</span><span class="s2"> + &quot;</span>
                    <span class="k">elif</span> <span class="n">val</span><span class="o">.</span><span class="n">denominator</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="n">res</span> <span class="o">=</span> <span class="n">res</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">val</span><span class="o">.</span><span class="n">numerator</span><span class="si">}</span><span class="s2">√</span><span class="si">{</span><span class="n">root</span><span class="si">}</span><span class="s2"> + &quot;</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">res</span> <span class="o">=</span> <span class="n">res</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">val</span><span class="o">.</span><span class="n">numerator</span><span class="si">}</span><span class="s2">√</span><span class="si">{</span><span class="n">root</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">val</span><span class="o">.</span><span class="n">denominator</span><span class="si">}</span><span class="s2"> + &quot;</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;+ &quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;+ -&quot;</span><span class="p">,</span> <span class="s2">&quot;- &quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;  &quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">res</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;0&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">res</span>

    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">IREF</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">all</span><span class="p">([</span><span class="n">v</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">_d</span><span class="p">[</span><span class="n">root</span><span class="p">]</span> <span class="k">for</span> <span class="n">root</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_d</span><span class="o">.</span><span class="n">items</span><span class="p">()])</span> <span class="ow">and</span> \
                <span class="nb">all</span><span class="p">([</span><span class="n">v</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">_d</span><span class="p">[</span><span class="n">root</span><span class="p">]</span> <span class="k">for</span> <span class="n">root</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">other</span><span class="o">.</span><span class="n">_d</span><span class="o">.</span><span class="n">items</span><span class="p">()]):</span>
                <span class="k">return</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">False</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">float</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__le__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__ge__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="fm">__ne__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__eq__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="fm">__pos__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">IREF</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_d</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__neg__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">IREF</span><span class="p">:</span>
        <span class="n">new</span><span class="p">:</span> <span class="n">IREF</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">root</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_d</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_d</span><span class="p">[</span><span class="n">root</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">val</span>
        <span class="k">return</span> <span class="n">new</span>

    <span class="k">def</span> <span class="fm">__lt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">IREF</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_float</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">other</span><span class="o">.</span><span class="n">to_float</span><span class="p">()</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">float</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_float</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">other</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&#39;&lt;&#39; not supported between instances of &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39; and &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="fm">__le__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">IREF</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_float</span><span class="p">()</span> <span class="o">&lt;=</span> <span class="n">other</span><span class="o">.</span><span class="n">to_float</span><span class="p">()</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">float</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_float</span><span class="p">()</span> <span class="o">&lt;=</span> <span class="n">other</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&#39;&lt;=&#39; not supported between instances of &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39; and &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="fm">__gt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">IREF</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_float</span><span class="p">()</span> <span class="o">&gt;</span> <span class="n">other</span><span class="o">.</span><span class="n">to_float</span><span class="p">()</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">float</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_float</span><span class="p">()</span> <span class="o">&gt;</span> <span class="n">other</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&#39;&gt;&#39; not supported between instances of &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39; and &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="fm">__ge__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">IREF</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_float</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="n">other</span><span class="o">.</span><span class="n">to_float</span><span class="p">()</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">float</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_float</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="n">other</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&#39;&gt;=&#39; not supported between instances of &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39; and &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">IREF</span><span class="p">:</span>
        <span class="n">new</span><span class="p">:</span> <span class="n">IREF</span> <span class="o">=</span> <span class="n">IREF</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_d</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">IREF</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">root_other</span><span class="p">,</span> <span class="n">val_other</span> <span class="ow">in</span> <span class="n">other</span><span class="o">.</span><span class="n">_d</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">new</span><span class="o">.</span><span class="n">_d</span><span class="p">[</span><span class="n">root_other</span><span class="p">]</span> <span class="o">+=</span> <span class="n">val_other</span>
            <span class="k">return</span> <span class="n">new</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="n">new</span><span class="o">.</span><span class="n">_d</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">Fraction</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">new</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Fraction</span><span class="p">):</span>
            <span class="n">new</span><span class="o">.</span><span class="n">_d</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">other</span>
            <span class="k">return</span> <span class="n">new</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;unsupported operand type(s) for +: &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39; and &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="fm">__radd__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">IREF</span><span class="p">:</span>
        <span class="n">new</span><span class="p">:</span> <span class="n">IREF</span> <span class="o">=</span> <span class="n">IREF</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_d</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">IREF</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">root_other</span><span class="p">,</span> <span class="n">val_other</span> <span class="ow">in</span> <span class="n">other</span><span class="o">.</span><span class="n">_d</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">new</span><span class="o">.</span><span class="n">_d</span><span class="p">[</span><span class="n">root_other</span><span class="p">]</span> <span class="o">+=</span> <span class="n">val_other</span>
            <span class="k">return</span> <span class="n">new</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="n">new</span><span class="o">.</span><span class="n">_d</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">Fraction</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">new</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Fraction</span><span class="p">):</span>
            <span class="n">new</span><span class="o">.</span><span class="n">_d</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">other</span>
            <span class="k">return</span> <span class="n">new</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;unsupported operand type(s) for +: &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39; and &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="fm">__iadd__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">IREF</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">IREF</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">root_other</span><span class="p">,</span> <span class="n">val_other</span> <span class="ow">in</span> <span class="n">other</span><span class="o">.</span><span class="n">_d</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_d</span><span class="p">[</span><span class="n">root_other</span><span class="p">]</span> <span class="o">+=</span> <span class="n">val_other</span>
            <span class="k">return</span> <span class="bp">self</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_d</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">Fraction</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Fraction</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_d</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">other</span>
            <span class="k">return</span> <span class="bp">self</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;unsupported operand type(s) for +: &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39; and &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__sub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">IREF</span><span class="p">:</span>
        <span class="n">new</span><span class="p">:</span> <span class="n">IREF</span> <span class="o">=</span> <span class="n">IREF</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_d</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">IREF</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">root_other</span><span class="p">,</span> <span class="n">val_other</span> <span class="ow">in</span> <span class="n">other</span><span class="o">.</span><span class="n">_d</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">new</span><span class="o">.</span><span class="n">_d</span><span class="p">[</span><span class="n">root_other</span><span class="p">]</span> <span class="o">-=</span> <span class="n">val_other</span>
            <span class="k">return</span> <span class="n">new</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="n">new</span><span class="o">.</span><span class="n">_d</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-=</span> <span class="n">Fraction</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">new</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Fraction</span><span class="p">):</span>
            <span class="n">new</span><span class="o">.</span><span class="n">_d</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-=</span> <span class="n">other</span>
            <span class="k">return</span> <span class="n">new</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;unsupported operand type(s) for -: &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39; and &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="fm">__rsub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">IREF</span><span class="p">:</span>
        <span class="n">new</span><span class="p">:</span> <span class="n">IREF</span> <span class="o">=</span> <span class="n">IREF</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_d</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">IREF</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">root_other</span><span class="p">,</span> <span class="n">val_other</span> <span class="ow">in</span> <span class="n">other</span><span class="o">.</span><span class="n">_d</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">new</span><span class="o">.</span><span class="n">_d</span><span class="p">[</span><span class="n">root_other</span><span class="p">]</span> <span class="o">-=</span> <span class="n">val_other</span>
            <span class="k">return</span> <span class="n">new</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="n">new</span><span class="o">.</span><span class="n">_d</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-=</span> <span class="n">Fraction</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">new</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Fraction</span><span class="p">):</span>
            <span class="n">new</span><span class="o">.</span><span class="n">_d</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-=</span> <span class="n">other</span>
            <span class="k">return</span> <span class="n">new</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;unsupported operand type(s) for -: &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39; and &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="fm">__isub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">IREF</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">IREF</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">root_other</span><span class="p">,</span> <span class="n">val_other</span> <span class="ow">in</span> <span class="n">other</span><span class="o">.</span><span class="n">_d</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_d</span><span class="p">[</span><span class="n">root_other</span><span class="p">]</span> <span class="o">-=</span> <span class="n">val_other</span>
            <span class="k">return</span> <span class="bp">self</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_d</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-=</span> <span class="n">Fraction</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Fraction</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_d</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-=</span> <span class="n">other</span>
            <span class="k">return</span> <span class="bp">self</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;unsupported operand type(s) for -: &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39; and &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__mul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">IREF</span><span class="p">:</span>
        <span class="n">new</span><span class="p">:</span> <span class="n">IREF</span> <span class="o">=</span> <span class="n">IREF</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">IREF</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">root</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_d</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">for</span> <span class="n">root_other</span><span class="p">,</span> <span class="n">val_other</span> <span class="ow">in</span> <span class="n">other</span><span class="o">.</span><span class="n">_d</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="n">sign</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>
                    <span class="k">if</span> <span class="n">root</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">root_other</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">sign</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
                    <span class="n">g</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">gcd</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">root</span><span class="p">),</span> <span class="nb">abs</span><span class="p">(</span><span class="n">root_other</span><span class="p">))</span>
                    <span class="n">new</span><span class="o">.</span><span class="n">_d</span><span class="p">[</span><span class="n">root</span><span class="o">*</span><span class="n">root_other</span><span class="o">//</span><span class="p">(</span><span class="n">g</span><span class="o">**</span><span class="mi">2</span><span class="p">)]</span> <span class="o">+=</span> <span class="n">sign</span> <span class="o">*</span> <span class="n">g</span> <span class="o">*</span> <span class="n">val</span> <span class="o">*</span> <span class="n">val_other</span>
            <span class="k">return</span> <span class="n">new</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">root</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_d</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">new</span><span class="o">.</span><span class="n">_d</span><span class="p">[</span><span class="n">root</span><span class="p">]</span> <span class="o">+=</span> <span class="n">val</span> <span class="o">*</span> <span class="n">Fraction</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">new</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Fraction</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">root</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_d</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">new</span><span class="o">.</span><span class="n">_d</span><span class="p">[</span><span class="n">root</span><span class="p">]</span> <span class="o">+=</span> <span class="n">val</span> <span class="o">*</span> <span class="n">other</span>
            <span class="k">return</span> <span class="n">new</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;unsupported operand type(s) for *: &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39; and &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__rmul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">IREF</span><span class="p">:</span>
        <span class="n">new</span><span class="p">:</span> <span class="n">IREF</span> <span class="o">=</span> <span class="n">IREF</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">IREF</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">root</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_d</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">for</span> <span class="n">root_other</span><span class="p">,</span> <span class="n">val_other</span> <span class="ow">in</span> <span class="n">other</span><span class="o">.</span><span class="n">_d</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="n">sign</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>
                    <span class="k">if</span> <span class="n">root</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">root_other</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">sign</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
                    <span class="n">g</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">gcd</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">root</span><span class="p">),</span> <span class="nb">abs</span><span class="p">(</span><span class="n">root_other</span><span class="p">))</span>
                    <span class="n">new</span><span class="o">.</span><span class="n">_d</span><span class="p">[</span><span class="n">root</span><span class="o">*</span><span class="n">root_other</span><span class="o">//</span><span class="p">(</span><span class="n">g</span><span class="o">**</span><span class="mi">2</span><span class="p">)]</span> <span class="o">+=</span> <span class="n">sign</span> <span class="o">*</span> <span class="n">g</span> <span class="o">*</span> <span class="n">val</span> <span class="o">*</span> <span class="n">val_other</span>
            <span class="k">return</span> <span class="n">new</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">root</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_d</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">new</span><span class="o">.</span><span class="n">_d</span><span class="p">[</span><span class="n">root</span><span class="p">]</span> <span class="o">+=</span> <span class="n">val</span> <span class="o">*</span> <span class="n">Fraction</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">new</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Fraction</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">root</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_d</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">new</span><span class="o">.</span><span class="n">_d</span><span class="p">[</span><span class="n">root</span><span class="p">]</span> <span class="o">+=</span> <span class="n">val</span> <span class="o">*</span> <span class="n">other</span>
            <span class="k">return</span> <span class="n">new</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;unsupported operand type(s) for *: &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39; and &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__imul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">IREF</span><span class="p">:</span>
        <span class="n">new</span><span class="p">:</span> <span class="n">IREF</span> <span class="o">=</span> <span class="n">IREF</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">IREF</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">root</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_d</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">for</span> <span class="n">root_other</span><span class="p">,</span> <span class="n">val_other</span> <span class="ow">in</span> <span class="n">other</span><span class="o">.</span><span class="n">_d</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="n">sign</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>
                    <span class="k">if</span> <span class="n">root</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">root_other</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">sign</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
                    <span class="n">g</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">gcd</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">root</span><span class="p">),</span> <span class="nb">abs</span><span class="p">(</span><span class="n">root_other</span><span class="p">))</span>
                    <span class="n">new</span><span class="o">.</span><span class="n">_d</span><span class="p">[</span><span class="n">root</span><span class="o">*</span><span class="n">root_other</span><span class="o">//</span><span class="p">(</span><span class="n">g</span><span class="o">**</span><span class="mi">2</span><span class="p">)]</span> <span class="o">+=</span> <span class="n">sign</span> <span class="o">*</span> <span class="n">g</span> <span class="o">*</span> <span class="n">val</span> <span class="o">*</span> <span class="n">val_other</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_d</span> <span class="o">=</span> <span class="n">new</span><span class="o">.</span><span class="n">_d</span>
            <span class="k">return</span> <span class="bp">self</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">root</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_d</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">new</span><span class="o">.</span><span class="n">_d</span><span class="p">[</span><span class="n">root</span><span class="p">]</span> <span class="o">+=</span> <span class="n">val</span> <span class="o">*</span> <span class="n">Fraction</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_d</span> <span class="o">=</span> <span class="n">new</span><span class="o">.</span><span class="n">_d</span>
            <span class="k">return</span> <span class="bp">self</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Fraction</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">root</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_d</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">new</span><span class="o">.</span><span class="n">_d</span><span class="p">[</span><span class="n">root</span><span class="p">]</span> <span class="o">+=</span> <span class="n">val</span> <span class="o">*</span> <span class="n">other</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_d</span> <span class="o">=</span> <span class="n">new</span><span class="o">.</span><span class="n">_d</span>
            <span class="k">return</span> <span class="bp">self</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;unsupported operand type(s) for *: &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39; and &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__truediv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">IREF</span><span class="p">:</span>
        <span class="n">new</span><span class="p">:</span> <span class="n">IREF</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">IREF</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">root_other</span><span class="p">,</span> <span class="n">val_other</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">_d</span><span class="o">.</span><span class="n">items</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">return</span> <span class="n">IREF</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_d</span><span class="p">)</span> <span class="o">*</span> <span class="n">IREF</span><span class="p">((</span><span class="n">root_other</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">val_other</span><span class="o">/</span><span class="n">root_other</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">irefs</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">IREF</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">IREF</span><span class="p">(</span><span class="n">rv</span><span class="p">)</span> <span class="k">for</span> <span class="n">rv</span> <span class="ow">in</span> <span class="n">other</span><span class="o">.</span><span class="n">_d</span><span class="o">.</span><span class="n">items</span><span class="p">()]</span>
                <span class="n">a0</span><span class="p">:</span> <span class="n">IREF</span> <span class="o">=</span> <span class="n">irefs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">nume</span><span class="p">:</span> <span class="n">IREF</span> <span class="o">=</span> <span class="n">IREF</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_d</span><span class="p">)</span>
                <span class="n">deno</span><span class="p">:</span> <span class="n">IREF</span> <span class="o">=</span> <span class="n">IREF</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">_d</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">sign</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">product</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">repeat</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)):</span>
                    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="k">continue</span>
                    <span class="n">poly</span><span class="p">:</span> <span class="n">IREF</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">a0</span><span class="p">]</span><span class="o">+</span><span class="p">[</span><span class="n">a</span><span class="o">*</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">sign</span><span class="p">,</span> <span class="n">irefs</span><span class="p">[</span><span class="mi">1</span><span class="p">:])],</span> <span class="n">start</span><span class="o">=</span><span class="n">IREF</span><span class="p">())</span>
                    <span class="n">nume</span> <span class="o">*=</span> <span class="n">poly</span>
                    <span class="n">deno</span> <span class="o">*=</span> <span class="n">poly</span>
                <span class="n">res</span><span class="p">:</span> <span class="n">IREF</span> <span class="o">=</span> <span class="n">IREF</span><span class="p">()</span>
                <span class="k">for</span> <span class="n">root</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">nume</span><span class="o">.</span><span class="n">_d</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="n">res</span><span class="o">.</span><span class="n">_d</span><span class="p">[</span><span class="n">root</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span> <span class="o">/</span> <span class="n">deno</span><span class="o">.</span><span class="n">_d</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">return</span> <span class="n">res</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="n">new</span> <span class="o">=</span> <span class="n">IREF</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">root</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_d</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">new</span><span class="o">.</span><span class="n">_d</span><span class="p">[</span><span class="n">root</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span> <span class="o">/</span> <span class="n">Fraction</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">new</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Fraction</span><span class="p">):</span>
            <span class="n">new</span> <span class="o">=</span> <span class="n">IREF</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">root</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_d</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">new</span><span class="o">.</span><span class="n">_d</span><span class="p">[</span><span class="n">root</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span> <span class="o">/</span> <span class="n">other</span>
            <span class="k">return</span> <span class="n">new</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;unsupported operand type(s) for /: &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39; and &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__rtruediv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">IREF</span><span class="p">:</span>
        <span class="n">new</span><span class="p">:</span> <span class="n">IREF</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">IREF</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">root_other</span><span class="p">,</span> <span class="n">val_other</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">_d</span><span class="o">.</span><span class="n">items</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">return</span> <span class="n">IREF</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_d</span><span class="p">)</span> <span class="o">*</span> <span class="n">IREF</span><span class="p">((</span><span class="n">root_other</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">val_other</span><span class="o">/</span><span class="n">root_other</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">irefs</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">IREF</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">IREF</span><span class="p">(</span><span class="n">rv</span><span class="p">)</span> <span class="k">for</span> <span class="n">rv</span> <span class="ow">in</span> <span class="n">other</span><span class="o">.</span><span class="n">_d</span><span class="o">.</span><span class="n">items</span><span class="p">()]</span>
                <span class="n">a0</span><span class="p">:</span> <span class="n">IREF</span> <span class="o">=</span> <span class="n">irefs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">nume</span><span class="p">:</span> <span class="n">IREF</span> <span class="o">=</span> <span class="n">IREF</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_d</span><span class="p">)</span>
                <span class="n">deno</span><span class="p">:</span> <span class="n">IREF</span> <span class="o">=</span> <span class="n">IREF</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">_d</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">sign</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">product</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">repeat</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)):</span>
                    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="k">continue</span>
                    <span class="n">poly</span><span class="p">:</span> <span class="n">IREF</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">a0</span><span class="p">]</span><span class="o">+</span><span class="p">[</span><span class="n">a</span><span class="o">*</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">sign</span><span class="p">,</span> <span class="n">irefs</span><span class="p">[</span><span class="mi">1</span><span class="p">:])],</span> <span class="n">start</span><span class="o">=</span><span class="n">IREF</span><span class="p">())</span>
                    <span class="n">nume</span> <span class="o">*=</span> <span class="n">poly</span>
                    <span class="n">deno</span> <span class="o">*=</span> <span class="n">poly</span>
                <span class="n">res</span><span class="p">:</span> <span class="n">IREF</span> <span class="o">=</span> <span class="n">IREF</span><span class="p">()</span>
                <span class="k">for</span> <span class="n">root</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">nume</span><span class="o">.</span><span class="n">_d</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="n">res</span><span class="o">.</span><span class="n">_d</span><span class="p">[</span><span class="n">root</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span> <span class="o">/</span> <span class="n">deno</span><span class="o">.</span><span class="n">_d</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">return</span> <span class="n">res</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="n">new</span> <span class="o">=</span> <span class="n">IREF</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">root</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_d</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">new</span><span class="o">.</span><span class="n">_d</span><span class="p">[</span><span class="n">root</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span> <span class="o">/</span> <span class="n">Fraction</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">new</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Fraction</span><span class="p">):</span>
            <span class="n">new</span> <span class="o">=</span> <span class="n">IREF</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">root</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_d</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">new</span><span class="o">.</span><span class="n">_d</span><span class="p">[</span><span class="n">root</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span> <span class="o">/</span> <span class="n">other</span>
            <span class="k">return</span> <span class="n">new</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;unsupported operand type(s) for /: &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39; and &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__itruediv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">IREF</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">IREF</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">root_other</span><span class="p">,</span> <span class="n">val_other</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">_d</span><span class="o">.</span><span class="n">items</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">return</span> <span class="n">IREF</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_d</span><span class="p">)</span> <span class="o">*</span> <span class="n">IREF</span><span class="p">((</span><span class="n">root_other</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">val_other</span><span class="o">/</span><span class="n">root_other</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">irefs</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">IREF</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">IREF</span><span class="p">(</span><span class="n">rv</span><span class="p">)</span> <span class="k">for</span> <span class="n">rv</span> <span class="ow">in</span> <span class="n">other</span><span class="o">.</span><span class="n">_d</span><span class="o">.</span><span class="n">items</span><span class="p">()]</span>
                <span class="n">a0</span><span class="p">:</span> <span class="n">IREF</span> <span class="o">=</span> <span class="n">irefs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">nume</span><span class="p">:</span> <span class="n">IREF</span> <span class="o">=</span> <span class="n">IREF</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_d</span><span class="p">)</span>
                <span class="n">deno</span><span class="p">:</span> <span class="n">IREF</span> <span class="o">=</span> <span class="n">IREF</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">_d</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">sign</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">product</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">repeat</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)):</span>
                    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="k">continue</span>
                    <span class="n">poly</span><span class="p">:</span> <span class="n">IREF</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">a0</span><span class="p">]</span><span class="o">+</span><span class="p">[</span><span class="n">a</span><span class="o">*</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">sign</span><span class="p">,</span> <span class="n">irefs</span><span class="p">[</span><span class="mi">1</span><span class="p">:])],</span> <span class="n">start</span><span class="o">=</span><span class="n">IREF</span><span class="p">())</span>
                    <span class="n">nume</span> <span class="o">*=</span> <span class="n">poly</span>
                    <span class="n">deno</span> <span class="o">*=</span> <span class="n">poly</span>
                <span class="n">res</span><span class="p">:</span> <span class="n">IREF</span> <span class="o">=</span> <span class="n">IREF</span><span class="p">()</span>
                <span class="k">for</span> <span class="n">root</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">nume</span><span class="o">.</span><span class="n">_d</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="n">res</span><span class="o">.</span><span class="n">_d</span><span class="p">[</span><span class="n">root</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span> <span class="o">/</span> <span class="n">deno</span><span class="o">.</span><span class="n">_d</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_d</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">_d</span>
                <span class="k">return</span> <span class="bp">self</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">root</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_d</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_d</span><span class="p">[</span><span class="n">root</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span> <span class="o">/</span> <span class="n">other</span>
            <span class="k">return</span> <span class="bp">self</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Fraction</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">root</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_d</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_d</span><span class="p">[</span><span class="n">root</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span> <span class="o">/</span> <span class="n">other</span>
            <span class="k">return</span> <span class="bp">self</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;unsupported operand type(s) for /: &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39; and &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span> <span class="o">|</span> <span class="n">Fraction</span><span class="p">]]:</span>
        <span class="k">return</span> <span class="nb">iter</span><span class="p">([(</span><span class="n">root</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span> <span class="k">for</span> <span class="n">root</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_d</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">val</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">])</span>
    
    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">([(</span><span class="n">root</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span> <span class="k">for</span> <span class="n">root</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_d</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">val</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">])</span>
    
    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Fraction</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_d</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
    
    <span class="k">def</span> <span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Fraction</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">Fraction</span><span class="p">))):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;key must be `int` type and value must be `Fraction` type&quot;</span><span class="p">)</span>
        <span class="n">g</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cal_square_factor</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">key</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_d</span><span class="p">[</span><span class="n">key</span><span class="o">//</span><span class="p">(</span><span class="n">g</span><span class="o">**</span><span class="mi">2</span><span class="p">)]</span> <span class="o">=</span> <span class="n">g</span> <span class="o">*</span> <span class="n">Fraction</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_d</span><span class="p">[</span><span class="n">key</span><span class="o">//</span><span class="p">(</span><span class="n">g</span><span class="o">**</span><span class="mi">2</span><span class="p">)]</span> <span class="o">=</span> <span class="n">g</span> <span class="o">*</span> <span class="n">value</span>
        
    <span class="k">def</span> <span class="nf">__copy__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">IREF</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">__deepcopy__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">IREF</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_d</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">root_value_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">defaultdict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Fraction</span><span class="p">]:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_d</span>
    
<div class="viewcode-block" id="IREF.copy"><a class="viewcode-back" href="../../../../cpystal.mathematics.algebra.html#cpystal.mathematics.algebra.core.IREF.copy">[docs]</a>    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">IREF</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span></div>
    
<div class="viewcode-block" id="IREF.deepcopy"><a class="viewcode-back" href="../../../../cpystal.mathematics.algebra.html#cpystal.mathematics.algebra.core.IREF.deepcopy">[docs]</a>    <span class="k">def</span> <span class="nf">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">IREF</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_d</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="IREF.to_float"><a class="viewcode-back" href="../../../../cpystal.mathematics.algebra.html#cpystal.mathematics.algebra.core.IREF.to_float">[docs]</a>    <span class="k">def</span> <span class="nf">to_float</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="n">res</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">root</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_d</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">root</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;negative root: </span><span class="si">{</span><span class="n">root</span><span class="si">}</span><span class="s2">; to get the value of this IREF instance, use &#39;to_complex&#39;&quot;</span><span class="p">)</span>
            <span class="n">res</span> <span class="o">+=</span> <span class="n">val</span><span class="o">.</span><span class="n">numerator</span> <span class="o">/</span> <span class="n">val</span><span class="o">.</span><span class="n">denominator</span> <span class="o">*</span> <span class="p">(</span><span class="n">root</span><span class="o">**</span><span class="mf">0.5</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">res</span></div>

<div class="viewcode-block" id="IREF.to_complex"><a class="viewcode-back" href="../../../../cpystal.mathematics.algebra.html#cpystal.mathematics.algebra.core.IREF.to_complex">[docs]</a>    <span class="k">def</span> <span class="nf">to_complex</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">complex</span><span class="p">:</span>
        <span class="n">res</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">root</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_d</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">res</span> <span class="o">+=</span> <span class="n">val</span><span class="o">.</span><span class="n">numerator</span> <span class="o">/</span> <span class="n">val</span><span class="o">.</span><span class="n">denominator</span> <span class="o">*</span> <span class="p">(</span><span class="n">root</span><span class="o">**</span><span class="mf">0.5</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">complex</span><span class="p">(</span><span class="n">res</span><span class="p">)</span></div>

<div class="viewcode-block" id="IREF.isqrt"><a class="viewcode-back" href="../../../../cpystal.mathematics.algebra.html#cpystal.mathematics.algebra.core.IREF.isqrt">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">isqrt</span><span class="p">(</span><span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate floor(sqrt(n)) by binary search.</span>

<span class="sd">        Note:</span>
<span class="sd">            Time complexity: Θ(logn).</span>

<span class="sd">        Args:</span>
<span class="sd">            n (int): Non-negative integer.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: Argument `n` must be a non-negative integer.</span>

<span class="sd">        Returns:</span>
<span class="sd">            int: floor(sqrt(n)).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span>
        <span class="n">ok</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">ng</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">n</span><span class="o">+</span><span class="mi">1</span>
        <span class="k">while</span> <span class="nb">abs</span><span class="p">(</span><span class="n">ok</span><span class="o">-</span><span class="n">ng</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">ng</span><span class="o">+</span><span class="n">ok</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span>
            <span class="k">if</span> <span class="n">mid</span><span class="o">**</span><span class="mi">2</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">:</span>
                <span class="n">ok</span> <span class="o">=</span> <span class="n">mid</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ng</span> <span class="o">=</span> <span class="n">mid</span>
        <span class="k">return</span> <span class="n">ok</span></div>

<div class="viewcode-block" id="IREF.make_square_factor_list"><a class="viewcode-back" href="../../../../cpystal.mathematics.algebra.html#cpystal.mathematics.algebra.core.IREF.make_square_factor_list">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">make_square_factor_list</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="mi">5</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate a list of square factor.</span>

<span class="sd">        Note:</span>
<span class="sd">            Time complexity: Θ(nloglogn).</span>

<span class="sd">        Args:</span>
<span class="sd">            n (int, optional): Non-negative integer. Defaults to 10**5.</span>

<span class="sd">        Returns:</span>
<span class="sd">            list[int]: List of square factor. The i-th element represents the square factor of i.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># spf[i] := Smallest Prime Factor of i. ([0,0,2,3,2,5,2,7,...])</span>
        <span class="c1"># __square_factor[i] := Square Factor of i. ([1,1,1,1,2,1,1,1,2,3,...])</span>
        <span class="n">spf</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">spf</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">spf</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">__square_factor</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">cls</span><span class="o">.</span><span class="n">isqrt</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">spf</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">i</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
                    <span class="n">spf</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>
                <span class="n">k</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="k">while</span> <span class="n">i</span><span class="o">**</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="o">**</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="p">),</span> <span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="o">**</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="p">)):</span>
                        <span class="n">__square_factor</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">*=</span> <span class="n">i</span>
                    <span class="n">k</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">__square_factor</span></div>

<div class="viewcode-block" id="IREF.factorize_fast"><a class="viewcode-back" href="../../../../cpystal.mathematics.algebra.html#cpystal.mathematics.algebra.core.IREF.factorize_fast">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">factorize_fast</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">defaultdict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
        <span class="n">res</span><span class="p">:</span> <span class="n">defaultdict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">idx</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">p</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">__primes</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
        <span class="k">while</span> <span class="n">p</span><span class="o">**</span><span class="mi">2</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">:</span>
            <span class="n">e</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">while</span> <span class="n">n</span> <span class="o">%</span> <span class="n">p</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">n</span> <span class="o">//=</span> <span class="n">p</span>
                <span class="n">e</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">e</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">res</span><span class="p">[</span><span class="n">p</span><span class="p">]</span> <span class="o">=</span> <span class="n">e</span>
                <span class="n">idx</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">p</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">__primes</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">res</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">res</span></div>

<div class="viewcode-block" id="IREF.factorize"><a class="viewcode-back" href="../../../../cpystal.mathematics.algebra.html#cpystal.mathematics.algebra.core.IREF.factorize">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">factorize</span><span class="p">(</span><span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">defaultdict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
        <span class="n">p</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="n">m</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">sign</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="n">table</span><span class="p">:</span> <span class="n">defaultdict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
        <span class="k">while</span> <span class="n">p</span> <span class="o">*</span> <span class="n">p</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">:</span>
            <span class="n">e</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">while</span> <span class="n">n</span> <span class="o">%</span> <span class="n">p</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">n</span> <span class="o">//=</span> <span class="n">p</span>
                <span class="n">e</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">e</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">table</span><span class="p">[</span><span class="n">p</span><span class="p">]</span> <span class="o">=</span> <span class="n">e</span>
                
            <span class="k">if</span> <span class="n">p</span> <span class="o">&gt;=</span> <span class="mi">5</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">sign</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">m</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">sign</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span>
                <span class="n">p</span> <span class="o">=</span> <span class="mi">6</span><span class="o">*</span><span class="n">m</span> <span class="o">+</span> <span class="n">sign</span>
            <span class="k">elif</span> <span class="n">p</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span> <span class="n">p</span> <span class="o">=</span> <span class="mi">3</span>
            <span class="k">elif</span> <span class="n">p</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span> <span class="n">p</span> <span class="o">=</span> <span class="mi">5</span>
        <span class="k">if</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">table</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">table</span></div>
    
<div class="viewcode-block" id="IREF.cal_square_factor"><a class="viewcode-back" href="../../../../cpystal.mathematics.algebra.html#cpystal.mathematics.algebra.core.IREF.cal_square_factor">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">cal_square_factor</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="n">res</span><span class="p">:</span> <span class="nb">int</span>
        <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">__square_factor</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">__square_factor</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="bp">cls</span><span class="o">.</span><span class="n">__primes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">res</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">factorize_fast</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">res</span> <span class="o">*=</span> <span class="n">k</span> <span class="o">**</span> <span class="p">(</span><span class="n">v</span><span class="o">//</span><span class="mi">2</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">res</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">res</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">factorize</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">res</span> <span class="o">*=</span> <span class="n">k</span> <span class="o">**</span> <span class="p">(</span><span class="n">v</span><span class="o">//</span><span class="mi">2</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">res</span></div></div>


<div class="viewcode-block" id="PolyInt"><a class="viewcode-back" href="../../../../cpystal.mathematics.algebra.html#cpystal.mathematics.algebra.core.PolyInt">[docs]</a><span class="k">class</span> <span class="nc">PolyInt</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Polynomial with integer coefficients.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        P (list[int] | npt.NDArray, optional): List of coefficients of polynomial.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">P</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span> <span class="o">=</span> <span class="p">[]):</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Constructor.</span>

<span class="sd">        Args:</span>
<span class="sd">            P (list[int] | npt.NDArray, optional): List of coefficients of polynomial. Defaults to [].</span>
<span class="sd">        </span>
<span class="sd">        Note:</span>
<span class="sd">            P(x) := \sum_{i} P[i] * x**i</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">P</span><span class="p">)</span> <span class="c1"># P:np.ndarray[int,...] P[i]==多項式P[X]のX**iの係数</span>

    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="fm">__pos__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__neg__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">PolyInt</span><span class="p">):</span>
            <span class="k">return</span> <span class="nb">bool</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">P</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">P</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PolyInt</span><span class="p">:</span> <span class="c1"># P[X]+Q[X]: 和</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">PolyInt</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">poly1d</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">poly1d</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">P</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]))[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">float</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">other</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;unsupported operand type(s) for +: &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39; and &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__sub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PolyInt</span><span class="p">:</span> <span class="c1"># P[X]-Q[X]: 差</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">PolyInt</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">poly1d</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">poly1d</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">P</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]))[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">float</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">other</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;unsupported operand type(s) for -: &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39; and &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__mul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PolyInt</span><span class="p">:</span> <span class="c1"># P[X]*Q[X]: 積</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">PolyInt</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">poly1d</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">poly1d</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">P</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]))[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">float</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">P</span> <span class="o">*</span> <span class="n">other</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;unsupported operand type(s) for *: &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39; and &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="fm">__truediv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PolyInt</span><span class="p">:</span> <span class="c1"># P[X]/Q[X] の商を返す</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">PolyInt</span><span class="p">):</span>
            <span class="n">n</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cal_deg</span><span class="p">()</span>
            <span class="n">m</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">cal_deg</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="n">m</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">new</span><span class="p">:</span> <span class="n">PolyInt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="p">)</span>
                <span class="n">Q</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
                    <span class="n">q</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span> <span class="o">=</span> <span class="n">new</span><span class="o">.</span><span class="n">P</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="n">other</span><span class="o">.</span><span class="n">P</span><span class="p">[</span><span class="n">m</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                    <span class="n">new</span><span class="o">.</span><span class="n">P</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="n">m</span><span class="o">-</span><span class="n">i</span><span class="p">:</span><span class="n">n</span><span class="o">-</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">new</span><span class="o">.</span><span class="n">P</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="n">m</span><span class="o">-</span><span class="n">i</span><span class="p">:</span><span class="n">n</span><span class="o">-</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">q</span><span class="o">*</span><span class="n">other</span><span class="o">.</span><span class="n">P</span>
                    <span class="n">Q</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Q</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span> <span class="c1"># 商Q[X]</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">P</span> <span class="o">//</span> <span class="n">other</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;unsupported operand type(s) for /: &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39; and &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__mod__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PolyInt</span><span class="p">:</span> <span class="c1"># P[X]/Q[X] の剰余R[X]を返す</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">PolyInt</span><span class="p">):</span>
            <span class="n">n</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cal_deg</span><span class="p">()</span>
            <span class="n">m</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">cal_deg</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="n">m</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">new</span><span class="p">:</span> <span class="n">PolyInt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
                    <span class="n">q</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span> <span class="o">=</span> <span class="n">new</span><span class="o">.</span><span class="n">P</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="n">other</span><span class="o">.</span><span class="n">P</span><span class="p">[</span><span class="n">m</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                    <span class="n">new</span><span class="o">.</span><span class="n">P</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="n">m</span><span class="o">-</span><span class="n">i</span><span class="p">:</span><span class="n">n</span><span class="o">-</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">new</span><span class="o">.</span><span class="n">P</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="n">m</span><span class="o">-</span><span class="n">i</span><span class="p">:</span><span class="n">n</span><span class="o">-</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">q</span><span class="o">*</span><span class="n">other</span><span class="o">.</span><span class="n">P</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="n">new</span><span class="o">.</span><span class="n">P</span><span class="p">[:</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">new</span><span class="o">.</span><span class="n">P</span><span class="o">!=</span><span class="mi">0</span><span class="p">))</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="c1"># 剰余R[X]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;unsupported operand type(s) for %: &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39; and &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
        

    <span class="k">def</span> <span class="fm">__divmod__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">PolyInt</span><span class="p">,</span> <span class="n">PolyInt</span><span class="p">]:</span> <span class="c1"># P[X]/Q[X] の商と剰余R[X]を返す</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">PolyInt</span><span class="p">):</span>
            <span class="n">n</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cal_deg</span><span class="p">()</span>
            <span class="n">m</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">cal_deg</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="n">m</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">([</span><span class="mi">0</span><span class="p">]),</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">new</span><span class="p">:</span> <span class="n">PolyInt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="p">)</span>
                <span class="n">Q</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
                    <span class="n">q</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span> <span class="o">=</span> <span class="n">new</span><span class="o">.</span><span class="n">P</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="n">other</span><span class="o">.</span><span class="n">P</span><span class="p">[</span><span class="n">m</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                    <span class="n">new</span><span class="o">.</span><span class="n">P</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="n">m</span><span class="o">-</span><span class="n">i</span><span class="p">:</span><span class="n">n</span><span class="o">-</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">new</span><span class="o">.</span><span class="n">P</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="n">m</span><span class="o">-</span><span class="n">i</span><span class="p">:</span><span class="n">n</span><span class="o">-</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">q</span><span class="o">*</span><span class="n">other</span><span class="o">.</span><span class="n">P</span>
                    <span class="n">Q</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Q</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])),</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="n">new</span><span class="o">.</span><span class="n">P</span><span class="p">[:</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">new</span><span class="o">.</span><span class="n">P</span><span class="o">!=</span><span class="mi">0</span><span class="p">))</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="c1"># 商Q[X], 剰余R[X]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;unsupported operand type(s) for __divmod__: &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39; and &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>

<div class="viewcode-block" id="PolyInt.cal_deg"><a class="viewcode-back" href="../../../../cpystal.mathematics.algebra.html#cpystal.mathematics.algebra.core.PolyInt.cal_deg">[docs]</a>    <span class="k">def</span> <span class="nf">cal_deg</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate maximum degree of the polynomial.</span>

<span class="sd">        Returns:</span>
<span class="sd">            int: Maximum degree of the polynomial.</span>
<span class="sd">        </span>
<span class="sd">        Note:</span>
<span class="sd">            The polynomial is shortened by excuting this method to the maximum degree.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="o">!=</span><span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="n">n</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="o">!=</span><span class="mi">0</span><span class="p">))</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">P</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="p">[:</span><span class="n">n</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">n</span></div>

<div class="viewcode-block" id="PolyInt.deriv"><a class="viewcode-back" href="../../../../cpystal.mathematics.algebra.html#cpystal.mathematics.algebra.core.PolyInt.deriv">[docs]</a>    <span class="k">def</span> <span class="nf">deriv</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PolyInt</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Derivative of the polynomial.</span>

<span class="sd">        Returns:</span>
<span class="sd">            PolyInt: Derivative of the polynomial.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="p">))]))</span></div>

<div class="viewcode-block" id="PolyInt.subs"><a class="viewcode-back" href="../../../../cpystal.mathematics.algebra.html#cpystal.mathematics.algebra.core.PolyInt.subs">[docs]</a>    <span class="k">def</span> <span class="nf">subs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Substitute a value for the variable in the polynomial.</span>

<span class="sd">        Args:</span>
<span class="sd">            x (float): Value of the variable.</span>

<span class="sd">        Returns:</span>
<span class="sd">            float: Result of substituting a given value for the variable.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">([(</span><span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="p">))])</span></div>
    
<div class="viewcode-block" id="PolyInt.simplify"><a class="viewcode-back" href="../../../../cpystal.mathematics.algebra.html#cpystal.mathematics.algebra.core.PolyInt.simplify">[docs]</a>    <span class="k">def</span> <span class="nf">simplify</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">PolyInt</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Simplify the polynomial by dividing common factor.</span>

<span class="sd">        Returns:</span>
<span class="sd">            tuple[PolyInt, int]: Simplified polynomial and the common factor.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">g</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">reduce</span><span class="p">(</span><span class="n">gcd</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">P</span> <span class="o">//</span> <span class="n">g</span><span class="p">),</span> <span class="n">g</span></div>
    
<div class="viewcode-block" id="PolyInt.fac2"><a class="viewcode-back" href="../../../../cpystal.mathematics.algebra.html#cpystal.mathematics.algebra.core.PolyInt.fac2">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">fac2</span><span class="p">(</span><span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate double factorial.</span>

<span class="sd">        Args:</span>
<span class="sd">            n (int): Non-negative integer.</span>

<span class="sd">        Returns:</span>
<span class="sd">            int: Double factorial n!!.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ans</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">):</span>
            <span class="n">ans</span> <span class="o">*=</span> <span class="n">i</span>
        <span class="k">return</span> <span class="n">ans</span></div>

<div class="viewcode-block" id="PolyInt.binomial_coeff"><a class="viewcode-back" href="../../../../cpystal.mathematics.algebra.html#cpystal.mathematics.algebra.core.PolyInt.binomial_coeff">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">binomial_coeff</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">m</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Value of binomial coefficient nCm.</span>

<span class="sd">        Args:</span>
<span class="sd">            n (int): Integer.</span>
<span class="sd">            m (int): Integer.</span>

<span class="sd">        Returns:</span>
<span class="sd">            int: Binomial coefficient nCm.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="n">m</span> <span class="ow">or</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">m</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="k">return</span> <span class="n">factorial</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">//</span> <span class="n">factorial</span><span class="p">(</span><span class="n">m</span><span class="p">)</span> <span class="o">//</span> <span class="n">factorial</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="n">m</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="PolyInt.Pn_coeff"><a class="viewcode-back" href="../../../../cpystal.mathematics.algebra.html#cpystal.mathematics.algebra.core.PolyInt.Pn_coeff">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">Pn_coeff</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">m</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Integerized coefficient of x^m in Legendre polynomial P_n(x)*2**n.</span>

<span class="sd">        Args:</span>
<span class="sd">            n (int): Degree of Legendre polynomial P_n(x)*2**n.</span>
<span class="sd">            m (int): Degree of x.</span>

<span class="sd">        Returns:</span>
<span class="sd">            float: Coefficient of x^m in Legendre polynomial P_n(x)*2**n.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="n">m</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span> <span class="ow">or</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="n">m</span> <span class="ow">or</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">m</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="n">l</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="n">m</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span>
        <span class="k">return</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="n">l</span> <span class="o">*</span> <span class="n">factorial</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">n</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">l</span><span class="p">)</span> <span class="o">//</span> <span class="n">factorial</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="o">//</span> <span class="n">factorial</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="n">l</span><span class="p">)</span> <span class="o">//</span> <span class="n">factorial</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">l</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="PolyInt.Plm_coeff"><a class="viewcode-back" href="../../../../cpystal.mathematics.algebra.html#cpystal.mathematics.algebra.core.PolyInt.Plm_coeff">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">Plm_coeff</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">l</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">m</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">k</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Integerized coefficient of x^k in Associated Legendre polynomial P_l^m(x)/(1-x^2)^{\|m|/2}*2**l.</span>

<span class="sd">        Args:</span>
<span class="sd">            l (int): Degree of Legendre polynomial P_l^m(x).</span>
<span class="sd">            m (int): Order of Legendre polynomial P_l^m(x). Only non-negative values are allowed.</span>
<span class="sd">            k (int): Degree of x.</span>

<span class="sd">        Returns:</span>
<span class="sd">            int: Coefficient of x^k in Legendre polynomial P_l^m(x)/(1-x^2)^{\|m|/2}*2**l.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">m</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&#39;m&#39; must be a non-negative number&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="o">-</span><span class="n">l</span> <span class="o">&lt;=</span> <span class="n">m</span> <span class="o">&lt;=</span> <span class="n">l</span><span class="p">):</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">l</span><span class="o">-</span><span class="n">m</span><span class="o">-</span><span class="n">k</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span> <span class="ow">or</span> <span class="n">l</span> <span class="o">&lt;</span> <span class="n">k</span> <span class="ow">or</span> <span class="n">l</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">l</span><span class="o">-</span><span class="n">m</span> <span class="o">&lt;</span> <span class="n">k</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="n">j</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="p">(</span><span class="n">l</span><span class="o">-</span><span class="n">m</span><span class="o">-</span><span class="n">k</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span>
        <span class="k">return</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="n">j</span> <span class="o">*</span> <span class="n">factorial</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">l</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">j</span><span class="p">)</span> <span class="o">//</span> <span class="n">factorial</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">//</span> <span class="n">factorial</span><span class="p">(</span><span class="n">l</span><span class="o">-</span><span class="n">j</span><span class="p">)</span> <span class="o">//</span> <span class="n">factorial</span><span class="p">(</span><span class="n">l</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">j</span><span class="o">-</span><span class="n">m</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="PolyInt.Plm_coeff_float"><a class="viewcode-back" href="../../../../cpystal.mathematics.algebra.html#cpystal.mathematics.algebra.core.PolyInt.Plm_coeff_float">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">Plm_coeff_float</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">l</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">m</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">k</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Coefficient of x^k in Associated Legendre polynomial P_l^m(x)/(1-x^2)^{\|m|/2}*2**l.</span>

<span class="sd">        Args:</span>
<span class="sd">            l (int): Degree of Legendre polynomial P_l^m(x)/(1-x^2)^{\|m|/2}*2**l.</span>
<span class="sd">            m (int): Order of Legendre polynomial P_l^m(x)/(1-x^2)^{\|m|/2}*2**l.</span>
<span class="sd">            k (int): Degree of x.</span>

<span class="sd">        Returns:</span>
<span class="sd">            float: Coefficient of x^k in Legendre polynomial P_l^m(x)/(1-x^2)^{\|m|/2}*2**l.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="o">-</span><span class="n">l</span> <span class="o">&lt;=</span> <span class="n">m</span> <span class="o">&lt;=</span> <span class="n">l</span><span class="p">):</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">l</span><span class="o">-</span><span class="n">m</span><span class="o">-</span><span class="n">k</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span> <span class="ow">or</span> <span class="n">l</span> <span class="o">&lt;</span> <span class="n">k</span> <span class="ow">or</span> <span class="n">l</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">l</span><span class="o">-</span><span class="n">m</span> <span class="o">&lt;</span> <span class="n">k</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span>
        
        <span class="n">j</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="p">(</span><span class="n">l</span><span class="o">-</span><span class="n">m</span><span class="o">-</span><span class="n">k</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span>
        <span class="n">positive_m_res</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="n">j</span> <span class="o">*</span> <span class="n">factorial</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">l</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">j</span><span class="p">)</span> <span class="o">//</span> <span class="n">factorial</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">//</span> <span class="n">factorial</span><span class="p">(</span><span class="n">l</span><span class="o">-</span><span class="n">j</span><span class="p">)</span> <span class="o">//</span> <span class="n">factorial</span><span class="p">(</span><span class="n">l</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">j</span><span class="o">-</span><span class="n">m</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">m</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">c</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="nb">abs</span><span class="p">(</span><span class="n">m</span><span class="p">)</span> <span class="o">*</span> <span class="n">factorial</span><span class="p">(</span><span class="n">l</span><span class="o">-</span><span class="nb">abs</span><span class="p">(</span><span class="n">m</span><span class="p">))</span> <span class="o">/</span> <span class="n">factorial</span><span class="p">(</span><span class="n">l</span><span class="o">+</span><span class="nb">abs</span><span class="p">(</span><span class="n">m</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">c</span> <span class="o">*</span> <span class="n">m</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">positive_m_res</span></div>
    
<div class="viewcode-block" id="PolyInt.Ln_coeff"><a class="viewcode-back" href="../../../../cpystal.mathematics.algebra.html#cpystal.mathematics.algebra.core.PolyInt.Ln_coeff">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">Ln_coeff</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">m</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Coefficient of x^m in Laguerre polynomial L_n(x).</span>

<span class="sd">        Args:</span>
<span class="sd">            n (int): Degree of Laguerre polynomial L_n(x).</span>
<span class="sd">            m (int): Degree of x.</span>

<span class="sd">        Returns:</span>
<span class="sd">            int: Coefficient of x^m in Laguerre polynomial L_n(x).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">nm</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">factorial</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">//</span> <span class="n">factorial</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="n">m</span> <span class="o">*</span> <span class="n">nm</span> <span class="o">//</span> <span class="n">factorial</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="n">m</span><span class="p">)</span> <span class="o">*</span> <span class="n">nm</span></div>

<div class="viewcode-block" id="PolyInt.Hn_coeff"><a class="viewcode-back" href="../../../../cpystal.mathematics.algebra.html#cpystal.mathematics.algebra.core.PolyInt.Hn_coeff">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">Hn_coeff</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">m</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Coefficient of x^m in Hermite polynomial H_n(x).</span>

<span class="sd">        Args:</span>
<span class="sd">            n (int): Degree of Hermite polynomial H_n(x).</span>
<span class="sd">            m (int): Degree of x.</span>

<span class="sd">        Returns:</span>
<span class="sd">            int: Coefficient of x^m in Hermite polynomial H_n(x).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="n">m</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span> <span class="ow">or</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="n">m</span> <span class="ow">or</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">m</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="n">l</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="n">m</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
        <span class="k">return</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="n">l</span> <span class="o">*</span> <span class="n">factorial</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">//</span> <span class="n">factorial</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="o">//</span> <span class="n">factorial</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">l</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span><span class="o">**</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">l</span><span class="p">)</span></div>

<div class="viewcode-block" id="PolyInt.Tn_coeff"><a class="viewcode-back" href="../../../../cpystal.mathematics.algebra.html#cpystal.mathematics.algebra.core.PolyInt.Tn_coeff">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">Tn_coeff</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">m</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Coefficient of x^m in Chebyshev polynomial of the first kind T_n(x).</span>

<span class="sd">        Note:</span>
<span class="sd">            cos(n\theta) = T_n(cos(\theta)).</span>

<span class="sd">        Args:</span>
<span class="sd">            n (int): Degree of Chebyshev polynomial of the first kind T_n(x).</span>
<span class="sd">            m (int): Degree of x.</span>

<span class="sd">        Returns:</span>
<span class="sd">            int: Coefficient of x^m in Chebyshev polynomial of the first kind T_n(x).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">m</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="n">m</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span> <span class="ow">or</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="n">m</span> <span class="ow">or</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">m</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="n">l</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="n">m</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span>
        <span class="k">return</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="n">l</span> <span class="o">*</span> <span class="n">n</span> <span class="o">*</span> <span class="bp">cls</span><span class="o">.</span><span class="n">fac2</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">n</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">l</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="o">//</span> <span class="bp">cls</span><span class="o">.</span><span class="n">fac2</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">l</span><span class="p">)</span> <span class="o">//</span> <span class="n">factorial</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">l</span><span class="p">)</span></div>

<div class="viewcode-block" id="PolyInt.Un_coeff"><a class="viewcode-back" href="../../../../cpystal.mathematics.algebra.html#cpystal.mathematics.algebra.core.PolyInt.Un_coeff">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">Un_coeff</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">m</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Coefficient of x^m in Chebyshev polynomial of the second kind U_n(x).</span>

<span class="sd">        Args:</span>
<span class="sd">            n (int): Degree of Chebyshev polynomial of the second kind U_n(x).</span>
<span class="sd">            m (int): Degree of x.</span>

<span class="sd">        Returns:</span>
<span class="sd">            int: Coefficient of x^m in Chebyshev polynomial of the second kind U_n(x).</span>
<span class="sd">        </span>
<span class="sd">        Note:</span>
<span class="sd">            U_n(x) = 1/(n+1) d/dx T_n+1(x).</span>
<span class="sd">            sin(n\theta) = sin(\theta) U_{n-1}(cos(\theta)).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">Tn_coeff</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="PolyInt.Pn"><a class="viewcode-back" href="../../../../cpystal.mathematics.algebra.html#cpystal.mathematics.algebra.core.PolyInt.Pn">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">Pn</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PolyInt</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Legendre polynomial whose coefficients are integerized P_n(x)*2**n.</span>

<span class="sd">        Args:</span>
<span class="sd">            n (int): Degree of Legendre polynomial P_n(x)*2**n.</span>

<span class="sd">        Returns:</span>
<span class="sd">            PolyInt: Legendre polynomial whose coefficients are integerized P_n(x)*2**n.</span>

<span class="sd">        Note:</span>
<span class="sd">            The result of this method equals to `cls([cls.Pn_coeff(n, m) for m in range(n+1)])`.</span>

<span class="sd">            [(1-x^2)(d/dx)^2 - 2x(d/dx) + n(n+1)] P_n(x) = 0</span>
<span class="sd">            P_n(x) = 1/(n!*2**n) (d/dx)^n (x^2-1)^n</span>
<span class="sd">            Ordinary generating function: 1/(1-2tx+t^2)^{1/2} = sum P_n(x)t^n</span>
<span class="sd">            (n+1)P_{n+1}(x) = (2n+1)xP_n(x) - nP_{n-1}(x)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">coeff</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">//</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">coeff</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="n">k</span> <span class="o">*</span> <span class="n">factorial</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">n</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="p">)</span> <span class="o">//</span> <span class="n">factorial</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="n">k</span><span class="p">)</span> <span class="o">//</span> <span class="n">factorial</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">//</span> <span class="n">factorial</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">coeff</span><span class="p">)</span></div>

<div class="viewcode-block" id="PolyInt.Plm"><a class="viewcode-back" href="../../../../cpystal.mathematics.algebra.html#cpystal.mathematics.algebra.core.PolyInt.Plm">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">Plm</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">l</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">m</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PolyInt</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Associated Legendre polynomial whose coefficients are integerized P_l^m(x)/(1-x^2)^{\|m|/2}*2**l.</span>

<span class="sd">        Args:</span>
<span class="sd">            l (int): Degree of associated Legendre polynomial P_l^m(x).</span>
<span class="sd">            m (int): Order of associated Legendre polynomial P_l^m(x). Only non-negative values are allowed.</span>

<span class="sd">        Returns:</span>
<span class="sd">            PolyInt: Associated Legendre polynomial whose coefficients are integerized P_l^m(x)/(1-x^2)^{\|m|/2}*2**l.</span>
<span class="sd">        </span>
<span class="sd">        Note:</span>
<span class="sd">            [(1-x^2)(d/dx)^2 - 2x(d/dx) + n(n+1) - m^2/(1-x^2)] P_n^l(x) = 0</span>
<span class="sd">            P_l^m(x) = (-1)^m (1-x^2)^{m/2} (d/dx)^m P_l(x)</span>
<span class="sd">            P_l^{-m}(x) = (-1)^m (l-m)!/(l+m)! P_l^m(x)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">m</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&#39;m&#39; must be a non-negative number&quot;</span><span class="p">)</span>
        <span class="n">coeff</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">l</span><span class="o">-</span><span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">((</span><span class="n">l</span><span class="o">-</span><span class="n">m</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">coeff</span><span class="p">[</span><span class="n">l</span><span class="o">-</span><span class="n">m</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="n">k</span> <span class="o">*</span> <span class="n">factorial</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">l</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="p">)</span> <span class="o">//</span> <span class="n">factorial</span><span class="p">(</span><span class="n">l</span><span class="o">-</span><span class="n">k</span><span class="p">)</span> <span class="o">//</span> <span class="n">factorial</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">//</span> <span class="n">factorial</span><span class="p">(</span><span class="n">l</span><span class="o">-</span><span class="n">m</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">coeff</span><span class="p">)</span></div>

<div class="viewcode-block" id="PolyInt.Ln"><a class="viewcode-back" href="../../../../cpystal.mathematics.algebra.html#cpystal.mathematics.algebra.core.PolyInt.Ln">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">Ln</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PolyInt</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Laguerre polynomial L_n(x).</span>

<span class="sd">        Args:</span>
<span class="sd">            n (int): Degree of Laguerre polynomial L_n(x).</span>

<span class="sd">        Returns:</span>
<span class="sd">            PolyInt: Laguerre polynomial whose coefficients are integerized L_n(x).</span>
<span class="sd">        </span>
<span class="sd">        Note:</span>
<span class="sd">            The result of this method equals to `cls([cls.Ln_coeff(n, m) for m in range(n+1)])`.</span>

<span class="sd">            [x(d/dx)^2 + (1-x)(d/dx) + n] L_n(x) = 0</span>
<span class="sd">            L_n(x) = e^x (d/dx)^n (x^n e^{-x})</span>
<span class="sd">            Exponential generating function: 1/(1-t) exp(-xt(1-t)) = sum L_n(x)t^{n}/n!</span>
<span class="sd">            L_{n+1}(x) = (2n+1-x)L_n(x) - n^2 L_{n-1}(x)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">coeff</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">nm</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">factorial</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">//</span> <span class="n">factorial</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
            <span class="n">coeff</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="n">m</span> <span class="o">*</span> <span class="n">nm</span> <span class="o">//</span> <span class="n">factorial</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="n">m</span><span class="p">)</span> <span class="o">*</span> <span class="n">nm</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">coeff</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="PolyInt.Lnk"><a class="viewcode-back" href="../../../../cpystal.mathematics.algebra.html#cpystal.mathematics.algebra.core.PolyInt.Lnk">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">Lnk</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">k</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PolyInt</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Associated Laguerre polynomial L_n^k(x).</span>

<span class="sd">        Args:</span>
<span class="sd">            n (int): Degree of Laguerre polynomial L_n^k(x).</span>
<span class="sd">            k (int): Order of Laguerre polynomial L_n^k(x).</span>

<span class="sd">        Returns:</span>
<span class="sd">            PolyInt: Associated Laguerre polynomial whose coefficients are integerized L_n^k(x).</span>
<span class="sd">        </span>
<span class="sd">        Note:</span>
<span class="sd">            The result of this method equals to `cls([cls.Ln_coeff(n, m) for m in range(n+1)])`.</span>
<span class="sd">            Note that this polynomial is not L_n^{(k)}(x) = e^x x^{-k} (d/dx)^n (x^{n+k} e^{-x}).</span>

<span class="sd">            [x(d/dx)^2 + (k+1-x)(d/dx) + n-k] L_n^k(x) = 0</span>
<span class="sd">            L_n^k(x) = (d/dx)^k L_n(x)</span>
<span class="sd">            generating function: (-1)^k/(1-t)^{k+1} exp(-xt(1-t)) = sum L_n^k(x)t^{n-k}/n!</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">coeff</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">coeff</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">m</span><span class="o">+</span><span class="n">k</span><span class="p">)</span> <span class="o">*</span> <span class="n">factorial</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">//</span> <span class="n">factorial</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="n">m</span><span class="o">-</span><span class="n">k</span><span class="p">)</span> <span class="o">*</span> <span class="n">factorial</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">//</span> <span class="n">factorial</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="n">m</span><span class="p">)</span> <span class="o">//</span> <span class="n">factorial</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">coeff</span><span class="p">)</span></div>

<div class="viewcode-block" id="PolyInt.Hn"><a class="viewcode-back" href="../../../../cpystal.mathematics.algebra.html#cpystal.mathematics.algebra.core.PolyInt.Hn">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">Hn</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PolyInt</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Hermite polynomial H_n(x).</span>

<span class="sd">        Args:</span>
<span class="sd">            n (int): Degree of Hermite polynomial H_n(x).</span>

<span class="sd">        Returns:</span>
<span class="sd">            PolyInt: Hermite polynomial H_n(x).</span>
<span class="sd">        </span>
<span class="sd">        Note:</span>
<span class="sd">            The result of this method equals to `cls([cls.Hn_coeff(n, m) for m in range(n+1)])`.</span>
<span class="sd">            </span>
<span class="sd">            [(d/dx)^2 - 2x(d/dx) + 2n] H_n(x) = 0</span>
<span class="sd">            H_n(x) = (-1)^n e^{x^2} (d/dx)^n e^{-x^2}</span>
<span class="sd">            Exponential generating function: exp(2xt-t^2) = sum H_n(x)t^n/n!</span>
<span class="sd">            H_{n+1}(x) = 2xH_n(x) - 2nH_{n-1}(x) (H_0=1, H_1=2x)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">coeff</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">//</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">coeff</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="n">k</span> <span class="o">*</span> <span class="n">factorial</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">//</span> <span class="n">factorial</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">//</span> <span class="n">factorial</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span><span class="o">**</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">coeff</span><span class="p">)</span></div>

<div class="viewcode-block" id="PolyInt.Tn"><a class="viewcode-back" href="../../../../cpystal.mathematics.algebra.html#cpystal.mathematics.algebra.core.PolyInt.Tn">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">Tn</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PolyInt</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Chebyshev polynomial of the first kind T_n(x).</span>

<span class="sd">        Args:</span>
<span class="sd">            n (int): Degree of Chebyshev polynomial of the first kind T_n(x).</span>

<span class="sd">        Returns:</span>
<span class="sd">            PolyInt: Chebyshev polynomial of the first kind T_n(x).</span>
<span class="sd">        </span>
<span class="sd">        Note:</span>
<span class="sd">            The result of this method equals to `cls([cls.Tn_coeff(n, m) for m in range(n+1)])`.</span>

<span class="sd">            Ordinary generating function: (1-tx)/(1-2tx+t^2) = sum T_n(x)t^n</span>
<span class="sd">            T_{n+1}(x) = 2xT_n(x) - T_{n-1}(x) (T_0=1, T_1=x).</span>
<span class="sd">            cos(n\theta) = T_n(cos\theta).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">coeff</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">//</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">coeff</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="n">k</span> <span class="o">*</span> <span class="n">n</span> <span class="o">*</span> <span class="bp">cls</span><span class="o">.</span><span class="n">fac2</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">n</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="o">//</span> <span class="bp">cls</span><span class="o">.</span><span class="n">fac2</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="p">)</span> <span class="o">//</span> <span class="n">factorial</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">coeff</span><span class="p">)</span></div>

<div class="viewcode-block" id="PolyInt.Un"><a class="viewcode-back" href="../../../../cpystal.mathematics.algebra.html#cpystal.mathematics.algebra.core.PolyInt.Un">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">Un</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PolyInt</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Chebyshev polynomial of the second kind U_n(x).</span>

<span class="sd">        Args:</span>
<span class="sd">            n (int): Degree of Chebyshev polynomial of the second kind U_n(x).</span>

<span class="sd">        Returns:</span>
<span class="sd">            PolyInt: Chebyshev polynomial of the second kind U_n(x).</span>
<span class="sd">        </span>
<span class="sd">        Note:</span>
<span class="sd">            The result of this method equals to `cls([cls.Un_coeff(n, m) for m in range(n+1)])`.</span>
<span class="sd">            </span>
<span class="sd">            Ordinary generating function: 1/(1-2tx+t^2) = sum U_n(x)t^n</span>
<span class="sd">            U_{n+1}(x) = 2xU_n(x) - U_{n-1}(x) (U_0=1, U_1=2x).</span>
<span class="sd">            U_n(x) = 1/(n+1) d/dx T_{n+1}(x).</span>
<span class="sd">            sin(n\theta) = sin(\theta) U_{n-1}(cos(\theta)).</span>
<span class="sd">            U_n(x) = sum_{l=0}^{n} P_l(x) * P_{n-l}(x).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">coeff</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">//</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">coeff</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="n">k</span> <span class="o">*</span> <span class="n">factorial</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="n">k</span><span class="p">)</span> <span class="o">//</span> <span class="n">factorial</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">//</span> <span class="n">factorial</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span><span class="o">**</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">coeff</span><span class="p">)</span></div>

<div class="viewcode-block" id="PolyInt.Pilm"><a class="viewcode-back" href="../../../../cpystal.mathematics.algebra.html#cpystal.mathematics.algebra.core.PolyInt.Pilm">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">Pilm</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">l</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">m</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PolyInt</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Integerized z-dependent polynomial \Pi_l^m(z)*2**l in spherical harmonics.</span>

<span class="sd">        Args:</span>
<span class="sd">            l (int): Azumuthal quantum number.</span>
<span class="sd">            m (int): Magnetic quantum number.</span>

<span class="sd">        Returns:</span>
<span class="sd">            PolyInt: \Pi_l^m(z)*2**l.</span>
<span class="sd">        </span>
<span class="sd">        Note:</span>
<span class="sd">            △R_l^m(r,θ,φ) = 0</span>
<span class="sd">            R_l^m(r,θ,φ) := (4\pi/(2l+1))^{1/2} r^l Y_l^m(θ,φ)</span>
<span class="sd">            Y_l^m(θ,φ) := (-1)^{(m+\|m|)/2} ((2l+1)/4\pi)^{1/2} Q_l^{\|m|} e^{imφ}</span>
<span class="sd">            Q_l^{\|m|} := [(l-\|m|)!/(l+\|m|)!]^{1/2} P_l^{\|m|}(cosθ)</span>
<span class="sd">            P_l^{\|m|}(cosθ) := sin^{\|m|}θ sum_{k=0}^{(l-\|m|)//2} c_{lkm} cos^{l-\|m|-2k}θ</span>
<span class="sd">            c_{lkm} := (-1)^k/(2^l) (2l-2k)! / (k!(l-k)!(l-\|m|-2k)!)</span>

<span class="sd">            C_l^m := r^l Re[Q_l^{\|m|} e^{imφ}] = r^l Q_l^{\|m|} cos(mφ)</span>
<span class="sd">            S_l^m := r^l Im[Q_l^{\|m|} e^{imφ}] = r^l Q_l^{\|m|} sin(mφ)</span>
<span class="sd">            Π_l^m(z) := r^{l-\|m|} P_l^{\|m|}(cosθ) / sin^{\|m|}θ</span>
<span class="sd">                      = sum_{k=0}^{(l-\|m|)//2} c_{lkm} r^{2k} z^{l-2k-\|m|}</span>
<span class="sd">            A_m(x,y) := r^{\|m|} sin^{\|m|}θ cos(mφ)</span>
<span class="sd">                      = [(x+iy)^{\|m|} + (x-iy)^{\|m|}] / 2</span>
<span class="sd">            B_m(x,y) := r^{\|m|} sin^{\|m|}θ sin(mφ)</span>
<span class="sd">                      = [(x+iy)^{\|m|} - (x-iy)^{\|m|}] / 2i</span>
<span class="sd">            then,</span>
<span class="sd">            - C_l^m = [(l-\|m|)!/(l+\|m|)!]^{1/2} Π_l^m(z) A_m(x,y)</span>
<span class="sd">            - S_l^m = [(l-\|m|)!/(l+\|m|)!]^{1/2} Π_l^m(z) B_m(x,y)</span>
<span class="sd">            - R_l^m(r,θ,φ) = (-1)^{(m+\|m|)/2} (C_l^m + iS_l^m).</span>

<span class="sd">            Here, Condon-Shortley phase is adopted.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">Plm</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="n">m</span><span class="p">))</span></div>
    
<div class="viewcode-block" id="PolyInt.Am"><a class="viewcode-back" href="../../../../cpystal.mathematics.algebra.html#cpystal.mathematics.algebra.core.PolyInt.Am">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">Am</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">m</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PolyInt</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;(x,y)-dependent polynomial A_m(x,y) in spherical harmonics.</span>
<span class="sd">        The parity is gerade (cos-like).</span>

<span class="sd">        Args:</span>
<span class="sd">            m (int): Magnetic quantum number.</span>

<span class="sd">        Returns:</span>
<span class="sd">            PolyInt: A_m(x,y).</span>
<span class="sd">        </span>
<span class="sd">        Note:</span>
<span class="sd">            △R_l^m(r,θ,φ) = 0</span>
<span class="sd">            R_l^m(r,θ,φ) := (4\pi/(2l+1))^{1/2} r^l Y_l^m(θ,φ)</span>
<span class="sd">            Y_l^m(θ,φ) := (-1)^{(m+\|m|)/2} ((2l+1)/4\pi)^{1/2} Q_l^{\|m|} e^{imφ}</span>
<span class="sd">            Q_l^{\|m|} := [(l-\|m|)!/(l+\|m|)!]^{1/2} P_l^{\|m|}(cosθ)</span>
<span class="sd">            P_l^{\|m|}(cosθ) := sin^{\|m|}θ sum_{k=0}^{(l-\|m|)//2} c_{lkm} cos^{l-\|m|-2k}θ</span>
<span class="sd">            c_{lkm} := (-1)^k/(2^l) (2l-2k)! / (k!(l-k)!(l-\|m|-2k)!)</span>

<span class="sd">            C_l^m := r^l Re[Q_l^{\|m|} e^{imφ}] = r^l Q_l^{\|m|} cos(mφ)</span>
<span class="sd">            S_l^m := r^l Im[Q_l^{\|m|} e^{imφ}] = r^l Q_l^{\|m|} sin(mφ)</span>
<span class="sd">            Π_l^m(z) := r^{l-\|m|} P_l^{\|m|}(cosθ) / sin^{\|m|}θ</span>
<span class="sd">                      = sum_{k=0}^{(l-\|m|)//2} c_{lkm} r^{2k} z^{l-2k-\|m|}</span>
<span class="sd">            A_m(x,y) := r^{\|m|} sin^{\|m|}θ cos(mφ)</span>
<span class="sd">                      = [(x+iy)^{\|m|} + (x-iy)^{\|m|}] / 2</span>
<span class="sd">            B_m(x,y) := r^{\|m|} sin^{\|m|}θ sin(mφ)</span>
<span class="sd">                      = [(x+iy)^{\|m|} - (x-iy)^{\|m|}] / 2i</span>
<span class="sd">            then,</span>
<span class="sd">            - C_l^m = [(l-\|m|)!/(l+\|m|)!]^{1/2} Π_l^m(z) A_m(x,y)</span>
<span class="sd">            - S_l^m = [(l-\|m|)!/(l+\|m|)!]^{1/2} Π_l^m(z) B_m(x,y)</span>
<span class="sd">            - R_l^m(r,θ,φ) = (-1)^{(m+\|m|)/2} (C_l^m + iS_l^m).</span>

<span class="sd">            Here, Condon-Shortley phase is adopted.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">def</span> <span class="nf">cos_sign</span><span class="p">(</span><span class="n">i</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">2</span><span class="p">:</span>
                <span class="k">return</span> <span class="mi">0</span>
            <span class="k">elif</span> <span class="p">(</span><span class="n">i</span><span class="o">//</span><span class="mi">2</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span><span class="p">:</span>
                <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">([</span><span class="bp">cls</span><span class="o">.</span><span class="n">binomial_coeff</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span><span class="o">*</span><span class="n">cos_sign</span><span class="p">(</span><span class="n">m</span><span class="o">-</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="p">)])</span></div>
    
<div class="viewcode-block" id="PolyInt.Bm"><a class="viewcode-back" href="../../../../cpystal.mathematics.algebra.html#cpystal.mathematics.algebra.core.PolyInt.Bm">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">Bm</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">m</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PolyInt</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;(x,y)-dependent polynomial B_m(x,y) in spherical harmonics.</span>
<span class="sd">        The parity is ungerade (sin-like).</span>

<span class="sd">        Args:</span>
<span class="sd">            m (int): Magnetic quantum number.</span>

<span class="sd">        Returns:</span>
<span class="sd">            PolyInt: B_m(x,y).</span>
<span class="sd">        </span>
<span class="sd">        Note:</span>
<span class="sd">            △R_l^m(r,θ,φ) = 0</span>
<span class="sd">            R_l^m(r,θ,φ) := (4\pi/(2l+1))^{1/2} r^l Y_l^m(θ,φ)</span>
<span class="sd">            Y_l^m(θ,φ) := (-1)^{(m+\|m|)/2} ((2l+1)/4\pi)^{1/2} Q_l^{\|m|} e^{imφ}</span>
<span class="sd">            Q_l^{\|m|} := [(l-\|m|)!/(l+\|m|)!]^{1/2} P_l^{\|m|}(cosθ)</span>
<span class="sd">            P_l^{\|m|}(cosθ) := sin^{\|m|}θ sum_{k=0}^{(l-\|m|)//2} c_{lkm} cos^{l-\|m|-2k}θ</span>
<span class="sd">            c_{lkm} := (-1)^k/(2^l) (2l-2k)! / (k!(l-k)!(l-\|m|-2k)!)</span>

<span class="sd">            C_l^m := r^l Re[Q_l^{\|m|} e^{imφ}] = r^l Q_l^{\|m|} cos(mφ)</span>
<span class="sd">            S_l^m := r^l Im[Q_l^{\|m|} e^{imφ}] = r^l Q_l^{\|m|} sin(mφ)</span>
<span class="sd">            Π_l^m(z) := r^{l-\|m|} P_l^{\|m|}(cosθ) / sin^{\|m|}θ</span>
<span class="sd">                      = sum_{k=0}^{(l-\|m|)//2} c_{lkm} r^{2k} z^{l-2k-\|m|}</span>
<span class="sd">            A_m(x,y) := r^{\|m|} sin^{\|m|}θ cos(mφ)</span>
<span class="sd">                      = [(x+iy)^{\|m|} + (x-iy)^{\|m|}] / 2</span>
<span class="sd">            B_m(x,y) := r^{\|m|} sin^{\|m|}θ sin(mφ)</span>
<span class="sd">                      = [(x+iy)^{\|m|} - (x-iy)^{\|m|}] / 2i</span>
<span class="sd">            then,</span>
<span class="sd">            - C_l^m = [(l-\|m|)!/(l+\|m|)!]^{1/2} Π_l^m(z) A_m(x,y)</span>
<span class="sd">            - S_l^m = [(l-\|m|)!/(l+\|m|)!]^{1/2} Π_l^m(z) B_m(x,y)</span>
<span class="sd">            - R_l^m(r,θ,φ) = (-1)^{(m+\|m|)/2} (C_l^m + iS_l^m).</span>

<span class="sd">            Here, Condon-Shortley phase is adopted.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">def</span> <span class="nf">sin_sign</span><span class="p">(</span><span class="n">i</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">return</span> <span class="mi">0</span>
            <span class="k">elif</span> <span class="p">((</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">return</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">([</span><span class="bp">cls</span><span class="o">.</span><span class="n">binomial_coeff</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span><span class="o">*</span><span class="n">sin_sign</span><span class="p">(</span><span class="n">m</span><span class="o">-</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="p">)])</span></div>

<div class="viewcode-block" id="PolyInt.expstr"><a class="viewcode-back" href="../../../../cpystal.mathematics.algebra.html#cpystal.mathematics.algebra.core.PolyInt.expstr">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">expstr</span><span class="p">(</span><span class="n">b</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">powstr</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;^&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">e</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;&quot;</span>
        <span class="k">elif</span> <span class="n">e</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">b</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">b</span><span class="si">}{</span><span class="n">powstr</span><span class="si">}{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span></div>

<div class="viewcode-block" id="PolyInt.coeffstr"><a class="viewcode-back" href="../../../../cpystal.mathematics.algebra.html#cpystal.mathematics.algebra.core.PolyInt.coeffstr">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">coeffstr</span><span class="p">(</span><span class="n">c</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">c</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;&quot;</span>
        <span class="k">elif</span> <span class="n">c</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;-&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">c</span><span class="si">}</span><span class="s2">&quot;</span></div>
    
<div class="viewcode-block" id="PolyInt.spherical_harmonics_polynomial_expr"><a class="viewcode-back" href="../../../../cpystal.mathematics.algebra.html#cpystal.mathematics.algebra.core.PolyInt.spherical_harmonics_polynomial_expr">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">spherical_harmonics_polynomial_expr</span><span class="p">(</span>
            <span class="n">ZR</span><span class="p">:</span> <span class="n">PolyInt</span><span class="p">,</span>
            <span class="n">XY</span><span class="p">:</span> <span class="n">PolyInt</span><span class="p">,</span>
            <span class="n">l</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
            <span class="n">m</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
            <span class="n">coeff</span><span class="p">:</span> <span class="n">IREF</span> <span class="o">=</span> <span class="n">IREF</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
            <span class="n">evalable</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">coeffstr</span><span class="p">:</span> <span class="nb">callable</span> <span class="o">=</span> <span class="n">PolyInt</span><span class="o">.</span><span class="n">coeffstr</span>
        <span class="n">expstr</span><span class="p">:</span> <span class="nb">callable</span> <span class="o">=</span> <span class="n">PolyInt</span><span class="o">.</span><span class="n">expstr</span>
        <span class="k">def</span> <span class="nf">zr</span><span class="p">(</span><span class="n">i</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">c</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">l</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">m</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">evalable</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
            <span class="n">cstr</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">coeffstr</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
            <span class="n">powstr</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;^&quot;</span>
            <span class="n">op1</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="n">op2</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="k">if</span> <span class="n">evalable</span><span class="p">:</span>
                <span class="n">powstr</span> <span class="o">=</span> <span class="s2">&quot;**&quot;</span>
                <span class="n">op1</span> <span class="o">=</span> <span class="s2">&quot;*&quot;</span>
                <span class="n">op2</span> <span class="o">=</span> <span class="s2">&quot;*&quot;</span>
                <span class="n">rstr</span> <span class="o">=</span> <span class="n">expstr</span><span class="p">(</span><span class="s1">&#39;(x**2+y**2+z**2)&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">l</span><span class="o">-</span><span class="nb">abs</span><span class="p">(</span><span class="n">m</span><span class="p">)</span><span class="o">-</span><span class="n">i</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span><span class="p">,</span> <span class="n">powstr</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">rstr</span> <span class="o">=</span> <span class="n">expstr</span><span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">l</span><span class="o">-</span><span class="nb">abs</span><span class="p">(</span><span class="n">m</span><span class="p">)</span><span class="o">-</span><span class="n">i</span><span class="p">,</span> <span class="n">powstr</span><span class="p">)</span>
            <span class="n">zstr</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">expstr</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">powstr</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">cstr</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span> <span class="ow">or</span> <span class="n">cstr</span> <span class="o">==</span> <span class="s2">&quot;-&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">zstr</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="n">op1</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="k">if</span> <span class="n">zstr</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span> <span class="ow">or</span> <span class="n">rstr</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="n">op2</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">cstr</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">op1</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">zstr</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">op2</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">rstr</span><span class="si">}</span><span class="s2">&quot;</span>
        
        <span class="k">def</span> <span class="nf">xy</span><span class="p">(</span><span class="n">i</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">c</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">l</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">m</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">evalable</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
            <span class="n">cstr</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">coeffstr</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
            <span class="n">op1</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="n">op2</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="n">powstr</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;^&quot;</span>
            <span class="k">if</span> <span class="n">evalable</span><span class="p">:</span>
                <span class="n">powstr</span> <span class="o">=</span> <span class="s2">&quot;**&quot;</span>
                <span class="n">op1</span> <span class="o">=</span> <span class="s2">&quot;*&quot;</span>
                <span class="n">op2</span> <span class="o">=</span> <span class="s2">&quot;*&quot;</span>
            <span class="n">xstr</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">expstr</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">powstr</span><span class="p">)</span>
            <span class="n">ystr</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">expstr</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="n">m</span><span class="p">)</span><span class="o">-</span><span class="n">i</span><span class="p">,</span> <span class="n">powstr</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">cstr</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span> <span class="ow">or</span> <span class="n">cstr</span> <span class="o">==</span> <span class="s2">&quot;-&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">xstr</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="n">op1</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="k">if</span> <span class="n">xstr</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span> <span class="ow">or</span> <span class="n">ystr</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="n">op2</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">cstr</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">op1</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">xstr</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">op2</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">ystr</span><span class="si">}</span><span class="s2">&quot;</span>

        <span class="n">zrstr</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ZR</span><span class="o">.</span><span class="n">P</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">ZR</span><span class="o">.</span><span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">zrstr</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">zr</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">ZR</span><span class="o">.</span><span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">evalable</span><span class="o">=</span><span class="n">evalable</span><span class="p">)</span><span class="si">}</span><span class="s2"> + </span><span class="si">{</span><span class="n">zrstr</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">zrstr</span> <span class="o">=</span> <span class="n">zrstr</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39; + &#39;</span><span class="p">)</span>

        <span class="n">xystr</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">XY</span><span class="o">.</span><span class="n">P</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">XY</span><span class="o">.</span><span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">xystr</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">xy</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">XY</span><span class="o">.</span><span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">evalable</span><span class="o">=</span><span class="n">evalable</span><span class="p">)</span><span class="si">}</span><span class="s2"> + </span><span class="si">{</span><span class="n">xystr</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">xystr</span> <span class="o">=</span> <span class="n">xystr</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39; + &#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">coeff</span> <span class="o">==</span> <span class="n">IREF</span><span class="p">(</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">ZR</span><span class="o">.</span><span class="n">P</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">xystr</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">zrstr</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">zrstr</span><span class="si">}</span><span class="s2">)&quot;</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">XY</span><span class="o">.</span><span class="n">P</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">zrstr</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">xystr</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">xystr</span><span class="si">}</span><span class="s2">)&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">ZR</span><span class="o">.</span><span class="n">P</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">zrstr</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">zrstr</span><span class="si">}</span><span class="s2">)&quot;</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">XY</span><span class="o">.</span><span class="n">P</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">xystr</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">xystr</span><span class="si">}</span><span class="s2">)&quot;</span>
        <span class="n">op1</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="n">op2</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="n">cstr</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">coeffstr</span><span class="p">(</span><span class="n">coeff</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">evalable</span> <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span><span class="n">cstr</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span> <span class="ow">or</span> <span class="n">cstr</span> <span class="o">==</span> <span class="s2">&quot;-&quot;</span> <span class="ow">or</span> <span class="n">xystr</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
            <span class="n">op1</span> <span class="o">=</span> <span class="s2">&quot;*&quot;</span>
        <span class="k">if</span> <span class="n">evalable</span> <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span><span class="n">xystr</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span> <span class="ow">or</span> <span class="n">zrstr</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
            <span class="n">op2</span> <span class="o">=</span> <span class="s2">&quot;*&quot;</span>
        <span class="n">res</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">cstr</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">op1</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">xystr</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">op2</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">zrstr</span><span class="si">}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;+ -&quot;</span><span class="p">,</span> <span class="s2">&quot;- &quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\s{2,}&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="n">res</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">res</span></div>

<div class="viewcode-block" id="PolyInt.multipole_notation"><a class="viewcode-back" href="../../../../cpystal.mathematics.algebra.html#cpystal.mathematics.algebra.core.PolyInt.multipole_notation">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">multipole_notation</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">l</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">m</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Multipole represented by (x,y,z).</span>

<span class="sd">        Args:</span>
<span class="sd">            l (int): Azumuthal quantum number.</span>
<span class="sd">            m (int): Magnetic quantum number.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: Multipole represented by (x,y,z).</span>
<span class="sd">        </span>
<span class="sd">        Note:</span>
<span class="sd">            #   (l, m): result</span>
<span class="sd">                (0, 0): 1</span>
<span class="sd">                (1, -1): y</span>
<span class="sd">                (1, 0): z</span>
<span class="sd">                (1, 1): x</span>
<span class="sd">                (2, -2): x y</span>
<span class="sd">                (2, -1): y z</span>
<span class="sd">                (2, 0): 3z^2 - r^2</span>
<span class="sd">                (2, 1): x z</span>
<span class="sd">                (2, 2): x^2 - y^2</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">l</span> <span class="o">==</span> <span class="n">m</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;1&quot;</span>
        <span class="n">ZR</span><span class="p">:</span> <span class="n">PolyInt</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">Pilm</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="n">m</span><span class="p">))</span><span class="o">.</span><span class="n">simplify</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">XY</span><span class="p">:</span> <span class="n">PolyInt</span>
        <span class="k">if</span> <span class="n">m</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">XY</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">Am</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">m</span><span class="p">))</span><span class="o">.</span><span class="n">simplify</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">XY</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">Bm</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">m</span><span class="p">))</span><span class="o">.</span><span class="n">simplify</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">spherical_harmonics_polynomial_expr</span><span class="p">(</span><span class="n">ZR</span><span class="p">,</span> <span class="n">XY</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span></div>

<div class="viewcode-block" id="PolyInt.tesseral_harmonics_expr"><a class="viewcode-back" href="../../../../cpystal.mathematics.algebra.html#cpystal.mathematics.algebra.core.PolyInt.tesseral_harmonics_expr">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">tesseral_harmonics_expr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">l</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">m</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Tesseral harmonics r^l Z_{lm}^{(c,s)}(r). </span>
<span class="sd">        This is also called as Spherical tensors.</span>
<span class="sd">        See also;</span>
<span class="sd">            http://www.isc.meiji.ac.jp/~hk/documents/memo/he_as_multipole_text.pdf,</span>
<span class="sd">            『スピンと軌道の電子論』(楠瀬博明)</span>
<span class="sd">            S. Hayami, M. Yatsushiro, Y. Yanagi, and H. Kusunose, Phys. Rev. B 98, 165110 (2018).</span>

<span class="sd">        Args:</span>
<span class="sd">            l (int): Azumuthal quantum number.</span>
<span class="sd">            m (int): Magnetic quantum number.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: Tesseral harmonics represented by (x,y,z).</span>
<span class="sd">        </span>
<span class="sd">        Note:</span>
<span class="sd">            Y_{lm}^{(c)} := (-1)^m/√2 (Y_{l}^{m}+Y_{l}^{m*})</span>
<span class="sd">            Y_{lm}^{(s)} := (-1)^m/√2i (Y_{l}^{m}-Y_{l}^{m*})</span>
<span class="sd">            Z_{lm}^{(c,s)} := √4π/(2l+1) Y_{lm}^{(c,s)}</span>
<span class="sd">            O_{lm}^{(c,s)} := r^l Z_{lm}^{(c,s)}(r)</span>

<span class="sd">            This function returns</span>
<span class="sd">                O_{lm}^{(c)} (m &gt; 0)</span>
<span class="sd">                O_{lm}^{(s)} (m &lt; 0).</span>

<span class="sd">            #   (l, m): result</span>
<span class="sd">                (1, -1): y</span>
<span class="sd">                (1, 0): z</span>
<span class="sd">                (1, 1): x</span>

<span class="sd">                (2, -2): √3 x y</span>
<span class="sd">                (2, -1): √3 y z</span>
<span class="sd">                (2, 0): 1/2 (3 z^2 - r^2)</span>
<span class="sd">                (2, 1): √3 x z</span>
<span class="sd">                (2, 2): √3/2 (x^2 - y^2)</span>

<span class="sd">                (3, -3): √10/4 (3 x^2 y - y^3)</span>
<span class="sd">                (3, -2): √15 x y z</span>
<span class="sd">                (3, -1): √6/4 y (5 z^2 - r^2)</span>
<span class="sd">                (3, 0): 1/2 (5 z^3 - 3 z r^2)</span>
<span class="sd">                (3, 1): √6/4 x (5 z^2 - r^2)</span>
<span class="sd">                (3, 2): √15/2 (x^2 - y^2) z</span>
<span class="sd">                (3, 3): √10/4 (x^3 - 3 x y^2)</span>

<span class="sd">                (4, -4): √35/2 (x^3 y - x y^3)</span>
<span class="sd">                (4, -3): √70/4 (3 x^2 y - y^3) z</span>
<span class="sd">                (4, -2): √5/2 x y (7 z^2 - r^2)</span>
<span class="sd">                (4, -1): √10/4 y (7 z^3 - 3 z r^2)</span>
<span class="sd">                (4, 0): 1/8 (35 z^4 - 30 z^2 r^2 + 3 r^4)</span>
<span class="sd">                (4, 1): √10/4 x (7 z^3 - 3 z r^2)</span>
<span class="sd">                (4, 2): √5/4 (x^2 - y^2) (7 z^2 - r^2)</span>
<span class="sd">                (4, 3): √70/4 (x^3 - 3 x y^2) z</span>
<span class="sd">                (4, 4): √35/8 (x^4 - 6 x^2 y^2 + y^4)</span>

<span class="sd">                (5, -5): 3√14/16 (5 x^4 y - 10 x^2 y^3 + y^5)</span>
<span class="sd">                (5, -4): 3√35/2 (x^3 y - x y^3) z</span>
<span class="sd">                (5, -3): √70/16 (3 x^2 y - y^3) (9 z^2 - r^2)</span>
<span class="sd">                (5, -2): √105/2 x y (3 z^3 - z r^2)</span>
<span class="sd">                (5, -1): √15/8 y (21 z^4 - 14 z^2 r^2 + r^4)</span>
<span class="sd">                (5, 0): 1/8 (63 z^5 - 70 z^3 r^2 + 15 z r^4)</span>
<span class="sd">                (5, 1): √15/8 x (21 z^4 - 14 z^2 r^2 + r^4)</span>
<span class="sd">                (5, 2): √105/4 (x^2 - y^2) (3 z^3 - z r^2)</span>
<span class="sd">                (5, 3): √70/16 (x^3 - 3 x y^2) (9 z^2 - r^2)</span>
<span class="sd">                (5, 4): 3√35/8 (x^4 - 6 x^2 y^2 + y^4) z</span>
<span class="sd">                (5, 5): 3√14/16 (x^5 - 10 x^3 y^2 + 5 x y^4)</span>

<span class="sd">                (6, -6): √462/16 (3 x^5 y - 10 x^3 y^3 + 3 x y^5)</span>
<span class="sd">                (6, -5): 3√154/16 (5 x^4 y - 10 x^2 y^3 + y^5) z</span>
<span class="sd">                (6, -4): 3√7/4 (x^3 y - x y^3) (11 z^2 - r^2)</span>
<span class="sd">                (6, -3): √210/16 (3 x^2 y - y^3) (11 z^3 - 3 z r^2)</span>
<span class="sd">                (6, -2): √210/16 x y (33 z^4 - 18 z^2 r^2 + r^4)</span>
<span class="sd">                (6, -1): √21/8 y (33 z^5 - 30 z^3 r^2 + 5 z r^4)</span>
<span class="sd">                (6, 0): 1/16 (231 z^6 - 315 z^4 r^2 + 105 z^2 r^4 - 5 r^6)</span>
<span class="sd">                (6, 1): √21/8 x (33 z^5 - 30 z^3 r^2 + 5 z r^4)</span>
<span class="sd">                (6, 2): √210/32 (x^2 - y^2) (33 z^4 - 18 z^2 r^2 + r^4)</span>
<span class="sd">                (6, 3): √210/16 (x^3 - 3 x y^2) (11 z^3 - 3 z r^2)</span>
<span class="sd">                (6, 4): 3√7/16 (x^4 - 6 x^2 y^2 + y^4) (11 z^2 - r^2)</span>
<span class="sd">                (6, 5): 3√154/16 (x^5 - 10 x^3 y^2 + 5 x y^4) z</span>
<span class="sd">                (6, 6): √462/32 (x^6 - 15 x^4 y^2 + 15 x^2 y^4 - y^6)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">l</span> <span class="o">==</span> <span class="n">m</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;1&quot;</span>
        <span class="n">coeff</span><span class="p">:</span> <span class="n">IREF</span> <span class="o">=</span> <span class="n">IREF</span><span class="p">((</span><span class="n">factorial</span><span class="p">(</span><span class="n">l</span><span class="o">-</span><span class="nb">abs</span><span class="p">(</span><span class="n">m</span><span class="p">)),</span><span class="mi">1</span><span class="p">))</span> <span class="o">/</span> <span class="n">IREF</span><span class="p">((</span><span class="n">factorial</span><span class="p">(</span><span class="n">l</span><span class="o">+</span><span class="nb">abs</span><span class="p">(</span><span class="n">m</span><span class="p">)),</span><span class="mi">1</span><span class="p">))</span> <span class="o">/</span> <span class="mi">2</span><span class="o">**</span><span class="n">l</span>
        <span class="n">ZR</span><span class="p">,</span> <span class="n">g_ZR</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">Pilm</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="n">m</span><span class="p">))</span><span class="o">.</span><span class="n">simplify</span><span class="p">()</span>
        <span class="n">XY</span><span class="p">:</span> <span class="n">PolyInt</span>
        <span class="k">if</span> <span class="n">m</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">XY</span><span class="p">,</span> <span class="n">g_XY</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">Am</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">m</span><span class="p">))</span><span class="o">.</span><span class="n">simplify</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">XY</span><span class="p">,</span> <span class="n">g_XY</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">Bm</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">m</span><span class="p">))</span><span class="o">.</span><span class="n">simplify</span><span class="p">()</span>
        <span class="n">coeff</span> <span class="o">*=</span> <span class="n">g_XY</span> <span class="o">*</span> <span class="n">g_ZR</span>
        <span class="k">if</span> <span class="n">m</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">coeff</span> <span class="o">*=</span> <span class="n">IREF</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">res</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="n">spherical_harmonics_polynomial_expr</span><span class="p">(</span><span class="n">ZR</span><span class="p">,</span><span class="w"> </span><span class="n">XY</span><span class="p">,</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">coeff</span><span class="o">=</span><span class="n">coeff</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="n">res</span></div>
    
<div class="viewcode-block" id="PolyInt.tesseral_harmonics"><a class="viewcode-back" href="../../../../cpystal.mathematics.algebra.html#cpystal.mathematics.algebra.core.PolyInt.tesseral_harmonics">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">tesseral_harmonics</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">l</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">m</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">callable</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Tesseral harmonics r^l Z_{lm}^{(c,s)}(r). </span>
<span class="sd">        This is also called as Spherical tensors.</span>
<span class="sd">        See also;</span>
<span class="sd">            http://www.isc.meiji.ac.jp/~hk/documents/memo/he_as_multipole_text.pdf,</span>
<span class="sd">            『スピンと軌道の電子論』(楠瀬博明)</span>
<span class="sd">            S. Hayami, M. Yatsushiro, Y. Yanagi, and H. Kusunose, Phys. Rev. B 98, 165110 (2018).</span>

<span class="sd">        Args:</span>
<span class="sd">            l (int): Azumuthal quantum number.</span>
<span class="sd">            m (int): Magnetic quantum number.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: Tesseral harmonics represented by (x,y,z).</span>
<span class="sd">        </span>
<span class="sd">        Note:</span>
<span class="sd">            Y_{lm}^{(c)} := (-1)^m/√2 (Y_{l}^{m}+Y_{l}^{m*})</span>
<span class="sd">            Y_{lm}^{(s)} := (-1)^m/√2i (Y_{l}^{m}-Y_{l}^{m*})</span>
<span class="sd">            Z_{lm}^{(c,s)} := √4π/(2l+1) Y_{lm}^{(c,s)}</span>
<span class="sd">            O_{lm}^{(c,s)} := r^l Z_{lm}^{(c,s)}(r)</span>

<span class="sd">            This function returns</span>
<span class="sd">                O_{lm}^{(c)} (m &gt; 0)</span>
<span class="sd">                O_{lm}^{(s)} (m &lt; 0).</span>

<span class="sd">            #   (l, m): result</span>
<span class="sd">                (1, -1): y</span>
<span class="sd">                (1, 0): z</span>
<span class="sd">                (1, 1): x</span>

<span class="sd">                (2, -2): √3 x y</span>
<span class="sd">                (2, -1): √3 y z</span>
<span class="sd">                (2, 0): 1/2 (3 z^2 - r^2)</span>
<span class="sd">                (2, 1): √3 x z</span>
<span class="sd">                (2, 2): √3/2 (x^2 - y^2)</span>

<span class="sd">                (3, -3): √10/4 (3 x^2 y - y^3)</span>
<span class="sd">                (3, -2): √15 x y z</span>
<span class="sd">                (3, -1): √6/4 y (5 z^2 - r^2)</span>
<span class="sd">                (3, 0): 1/2 (5 z^3 - 3 z r^2)</span>
<span class="sd">                (3, 1): √6/4 x (5 z^2 - r^2)</span>
<span class="sd">                (3, 2): √15/2 (x^2 - y^2) z</span>
<span class="sd">                (3, 3): √10/4 (x^3 - 3 x y^2)</span>

<span class="sd">                (4, -4): √35/2 (x^3 y - x y^3)</span>
<span class="sd">                (4, -3): √70/4 (3 x^2 y - y^3) z</span>
<span class="sd">                (4, -2): √5/2 x y (7 z^2 - r^2)</span>
<span class="sd">                (4, -1): √10/4 y (7 z^3 - 3 z r^2)</span>
<span class="sd">                (4, 0): 1/8 (35 z^4 - 30 z^2 r^2 + 3 r^4)</span>
<span class="sd">                (4, 1): √10/4 x (7 z^3 - 3 z r^2)</span>
<span class="sd">                (4, 2): √5/4 (x^2 - y^2) (7 z^2 - r^2)</span>
<span class="sd">                (4, 3): √70/4 (x^3 - 3 x y^2) z</span>
<span class="sd">                (4, 4): √35/8 (x^4 - 6 x^2 y^2 + y^4)</span>

<span class="sd">                (5, -5): 3√14/16 (5 x^4 y - 10 x^2 y^3 + y^5)</span>
<span class="sd">                (5, -4): 3√35/2 (x^3 y - x y^3) z</span>
<span class="sd">                (5, -3): √70/16 (3 x^2 y - y^3) (9 z^2 - r^2)</span>
<span class="sd">                (5, -2): √105/2 x y (3 z^3 - z r^2)</span>
<span class="sd">                (5, -1): √15/8 y (21 z^4 - 14 z^2 r^2 + r^4)</span>
<span class="sd">                (5, 0): 1/8 (63 z^5 - 70 z^3 r^2 + 15 z r^4)</span>
<span class="sd">                (5, 1): √15/8 x (21 z^4 - 14 z^2 r^2 + r^4)</span>
<span class="sd">                (5, 2): √105/4 (x^2 - y^2) (3 z^3 - z r^2)</span>
<span class="sd">                (5, 3): √70/16 (x^3 - 3 x y^2) (9 z^2 - r^2)</span>
<span class="sd">                (5, 4): 3√35/8 (x^4 - 6 x^2 y^2 + y^4) z</span>
<span class="sd">                (5, 5): 3√14/16 (x^5 - 10 x^3 y^2 + 5 x y^4)</span>

<span class="sd">                (6, -6): √462/16 (3 x^5 y - 10 x^3 y^3 + 3 x y^5)</span>
<span class="sd">                (6, -5): 3√154/16 (5 x^4 y - 10 x^2 y^3 + y^5) z</span>
<span class="sd">                (6, -4): 3√7/4 (x^3 y - x y^3) (11 z^2 - r^2)</span>
<span class="sd">                (6, -3): √210/16 (3 x^2 y - y^3) (11 z^3 - 3 z r^2)</span>
<span class="sd">                (6, -2): √210/16 x y (33 z^4 - 18 z^2 r^2 + r^4)</span>
<span class="sd">                (6, -1): √21/8 y (33 z^5 - 30 z^3 r^2 + 5 z r^4)</span>
<span class="sd">                (6, 0): 1/16 (231 z^6 - 315 z^4 r^2 + 105 z^2 r^4 - 5 r^6)</span>
<span class="sd">                (6, 1): √21/8 x (33 z^5 - 30 z^3 r^2 + 5 z r^4)</span>
<span class="sd">                (6, 2): √210/32 (x^2 - y^2) (33 z^4 - 18 z^2 r^2 + r^4)</span>
<span class="sd">                (6, 3): √210/16 (x^3 - 3 x y^2) (11 z^3 - 3 z r^2)</span>
<span class="sd">                (6, 4): 3√7/16 (x^4 - 6 x^2 y^2 + y^4) (11 z^2 - r^2)</span>
<span class="sd">                (6, 5): 3√154/16 (x^5 - 10 x^3 y^2 + 5 x y^4) z</span>
<span class="sd">                (6, 6): √462/32 (x^6 - 15 x^4 y^2 + 15 x^2 y^4 - y^6)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">l</span> <span class="o">==</span> <span class="n">m</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">:</span> <span class="mf">1.</span>
        <span class="n">coeff</span><span class="p">:</span> <span class="n">IREF</span> <span class="o">=</span> <span class="n">IREF</span><span class="p">((</span><span class="n">factorial</span><span class="p">(</span><span class="n">l</span><span class="o">-</span><span class="nb">abs</span><span class="p">(</span><span class="n">m</span><span class="p">)),</span><span class="mi">1</span><span class="p">))</span> <span class="o">/</span> <span class="n">IREF</span><span class="p">((</span><span class="n">factorial</span><span class="p">(</span><span class="n">l</span><span class="o">+</span><span class="nb">abs</span><span class="p">(</span><span class="n">m</span><span class="p">)),</span><span class="mi">1</span><span class="p">))</span> <span class="o">/</span> <span class="mi">2</span><span class="o">**</span><span class="n">l</span>
        <span class="n">ZR</span><span class="p">,</span> <span class="n">g_ZR</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">Pilm</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="n">m</span><span class="p">))</span><span class="o">.</span><span class="n">simplify</span><span class="p">()</span>
        <span class="n">XY</span><span class="p">:</span> <span class="n">PolyInt</span>
        <span class="k">if</span> <span class="n">m</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">XY</span><span class="p">,</span> <span class="n">g_XY</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">Am</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">m</span><span class="p">))</span><span class="o">.</span><span class="n">simplify</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">XY</span><span class="p">,</span> <span class="n">g_XY</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">Bm</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">m</span><span class="p">))</span><span class="o">.</span><span class="n">simplify</span><span class="p">()</span>
        <span class="n">coeff</span> <span class="o">*=</span> <span class="n">g_XY</span> <span class="o">*</span> <span class="n">g_ZR</span>
        <span class="k">if</span> <span class="n">m</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">coeff</span> <span class="o">*=</span> <span class="n">IREF</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">fzr</span><span class="p">:</span> <span class="nb">callable</span> <span class="o">=</span> <span class="n">ZR</span><span class="o">.</span><span class="n">to_func</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">fxy</span><span class="p">:</span> <span class="nb">callable</span> <span class="o">=</span> <span class="n">XY</span><span class="o">.</span><span class="n">to_func</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">res</span><span class="p">:</span> <span class="nb">callable</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">:</span> <span class="n">coeff</span><span class="o">.</span><span class="n">to_float</span><span class="p">()</span> <span class="o">*</span> <span class="n">fzr</span><span class="p">(</span><span class="n">z</span><span class="p">,(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">y</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">z</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span><span class="p">)</span> <span class="o">*</span> <span class="n">fxy</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">res</span></div>
    
<div class="viewcode-block" id="PolyInt.to_func"><a class="viewcode-back" href="../../../../cpystal.mathematics.algebra.html#cpystal.mathematics.algebra.core.PolyInt.to_func">[docs]</a>    <span class="k">def</span> <span class="nf">to_func</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">is_bivariable</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">callable</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Polynomial function.</span>

<span class="sd">        Note:</span>
<span class="sd">            The return value of this function is</span>
<span class="sd">                f_{P}(x) := sum_{i=0}^{n-1} P[i] * x**i,</span>
<span class="sd">            where P is a list of polynomial coefficients and n := len(P).</span>
<span class="sd">            If `is_bivariable` is True,</span>
<span class="sd">                f_{P}(x,y) := sum_{i=0}^{n-1} P[i] * x**i * y**(n-1-i).</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; P = PolyInt([3,4,5])</span>
<span class="sd">            &gt;&gt;&gt; f = P.to_func()</span>
<span class="sd">            &gt;&gt;&gt; g = P.to_func(is_bivariable=True)</span>
<span class="sd">            &gt;&gt;&gt; print(f(2) == 3 + 4*2 + 5*2**2)</span>
<span class="sd">            &gt;&gt;&gt; True</span>
<span class="sd">            &gt;&gt;&gt; print(g(-1,2) == 3 * 2**2 + 4 * (-1) * 2 + 5 * (-1)**2)</span>
<span class="sd">            &gt;&gt;&gt; True</span>

<span class="sd">        Args:</span>
<span class="sd">            is_bivariable (bool, optional): If True, the return value is a bivariable function. Defaults to False.</span>

<span class="sd">        Returns:</span>
<span class="sd">            callable: Polynomial function.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">n</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">is_bivariable</span><span class="p">:</span>
            <span class="k">return</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">sum</span><span class="p">([</span><span class="n">c</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="n">i</span> <span class="o">*</span> <span class="n">y</span><span class="o">**</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="p">)])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">sum</span><span class="p">([</span><span class="n">c</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="p">)])</span></div>

<div class="viewcode-block" id="PolyInt.to_symbol"><a class="viewcode-back" href="../../../../cpystal.mathematics.algebra.html#cpystal.mathematics.algebra.core.PolyInt.to_symbol">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">to_symbol</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">l</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">m</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Multipole represented by (x,y,z).</span>

<span class="sd">        Args:</span>
<span class="sd">            l (int): Azumuthal quantum number.</span>
<span class="sd">            m (int): Magnetic quantum number.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: Multipole represented by (x,y,z).</span>
<span class="sd">        </span>
<span class="sd">        Note:</span>
<span class="sd">            #   (l, m): result</span>
<span class="sd">                (0, 0): 1</span>
<span class="sd">                (1, -1): y</span>
<span class="sd">                (1, 0): z</span>
<span class="sd">                (1, 1): x</span>
<span class="sd">                (2, -2): x * y</span>
<span class="sd">                (2, -1): y * z</span>
<span class="sd">                (2, 0): 3z**2 - r**2</span>
<span class="sd">                (2, 1): x * z</span>
<span class="sd">                (2, 2): x**2 - y**2</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">l</span> <span class="o">==</span> <span class="n">m</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;1&quot;</span>
        <span class="n">ZR</span><span class="p">:</span> <span class="n">PolyInt</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">Pilm</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="n">m</span><span class="p">))</span><span class="o">.</span><span class="n">simplify</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">XY</span><span class="p">:</span> <span class="n">PolyInt</span>
        <span class="k">if</span> <span class="n">m</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">XY</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">Am</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">m</span><span class="p">))</span><span class="o">.</span><span class="n">simplify</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">XY</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">Bm</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">m</span><span class="p">))</span><span class="o">.</span><span class="n">simplify</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">res</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">spherical_harmonics_polynomial_expr</span><span class="p">(</span><span class="n">ZR</span><span class="p">,</span> <span class="n">XY</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">evalable</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">res</span></div></div>


<div class="viewcode-block" id="visualize_spherical_harmonics"><a class="viewcode-back" href="../../../../cpystal.mathematics.algebra.html#cpystal.mathematics.algebra.core.visualize_spherical_harmonics">[docs]</a><span class="k">def</span> <span class="nf">visualize_spherical_harmonics</span><span class="p">(</span><span class="n">l_max</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Spherical harmonics visualizer.</span>

<span class="sd">    Note:</span>
<span class="sd">        Visualized points are calculated as below:</span>
<span class="sd">            1. absolute mode:</span>
<span class="sd">                r = |Y_l^m(theta, phi)|</span>
<span class="sd">            2. Real mode:</span>
<span class="sd">                r = |Re[Y_l^m(theta, phi)]|</span>
<span class="sd">            3. Imaginary mode:</span>
<span class="sd">                r = |Im[Y_l^m(theta, phi)]|</span>
<span class="sd">            then,</span>
<span class="sd">            x = r * sin(theta) * cos(phi)</span>
<span class="sd">            y = r * sin(theta) * sin(phi)</span>
<span class="sd">            z = r * cos(theta)</span>

<span class="sd">    Args:</span>
<span class="sd">        l_max (int, optional): Maximum azimuthal quantum number. Defaults to 10.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">spherical_harmonics_real_form</span><span class="p">(</span><span class="n">theta</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">,</span> <span class="n">phi</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">,</span> <span class="n">l</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">m</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">:</span>
        <span class="n">Y</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span> <span class="o">=</span> <span class="n">sph_harm</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">m</span><span class="p">),</span> <span class="n">l</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">theta</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">m</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="n">m</span> <span class="o">*</span> <span class="n">Y</span><span class="o">.</span><span class="n">imag</span>
        <span class="k">elif</span> <span class="n">m</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="n">m</span> <span class="o">*</span> <span class="n">Y</span><span class="o">.</span><span class="n">real</span>
        <span class="k">return</span> <span class="n">Y</span><span class="o">.</span><span class="n">real</span>
    
    <span class="k">def</span> <span class="nf">paramed_sph_harm</span><span class="p">(</span><span class="n">l</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">m</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">mode</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">,</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">,</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">,</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Spherical harmonics function.</span>

<span class="sd">        Args:</span>
<span class="sd">            l (int): Azimuthal quantum number.</span>
<span class="sd">            m (int): Magnetic quantum number.</span>
<span class="sd">            mode (int): Visualizer mode: {0: |Y_l^m|, 1: |Re(Y_l^m)|, 2: |Im(Y_l^m)|}.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: The value of mode (param[1]) must be 0, 1 or 2.</span>

<span class="sd">        Returns:</span>
<span class="sd">            tuple[npt.NDArray, npt.NDArray, npt.NDArray, npt.NDArray]: x, y, z coordination values and the color of points.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">n</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">512</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">theta</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
        <span class="n">phi</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
        <span class="n">theta</span><span class="p">,</span> <span class="n">phi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">phi</span><span class="p">)</span>
        <span class="n">r</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span>
        <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># real-form</span>
            <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">spherical_harmonics_real_form</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">m</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="c1"># abs</span>
            <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">sph_harm</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">theta</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="c1"># Re</span>
            <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">sph_harm</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">theta</span><span class="p">)))</span>
        <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="c1"># Im</span>
            <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">sph_harm</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">theta</span><span class="p">)))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span>

        <span class="n">x</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>
        <span class="n">y</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>
        <span class="n">z</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>

        <span class="n">plus_minus</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
        <span class="n">color</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">theta</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">str</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">phi</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">phi</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
                <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">spherical_harmonics_real_form</span><span class="p">(</span><span class="n">theta</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">],</span> <span class="n">phi</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">],</span> <span class="n">l</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="c1"># if spherical_harmonics_sign_tp(theta[i,j], phi[i,j], l, m) &gt;= 0:</span>
                    <span class="c1"># if spherical_harmonics_sign_xyz(x[i,j], y[i,j], z[i,j], l, m) &gt;= 0:</span>
                        <span class="n">color</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">plus_minus</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">color</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">plus_minus</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">color</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;magenta&#39;</span>
                <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="n">color</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;red&#39;</span>
                <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                    <span class="n">color</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;blue&#39;</span>
        <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">color</span>
    
    <span class="n">orbit_name</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;s&quot;</span><span class="p">,</span> <span class="s2">&quot;p&quot;</span><span class="p">,</span> <span class="s2">&quot;d&quot;</span><span class="p">,</span> <span class="s2">&quot;f&quot;</span><span class="p">,</span> <span class="s2">&quot;g&quot;</span><span class="p">,</span> <span class="s2">&quot;h&quot;</span><span class="p">,</span> <span class="s2">&quot;i&quot;</span><span class="p">,</span> <span class="s2">&quot;j&quot;</span><span class="p">,</span> <span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="s2">&quot;l&quot;</span><span class="p">,</span> <span class="s2">&quot;m&quot;</span><span class="p">,</span> <span class="s2">&quot;n&quot;</span><span class="p">,</span> <span class="s2">&quot;o&quot;</span><span class="p">]</span>

    <span class="n">fig</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">Figure</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
    <span class="c1"># 領域を小区画に分けて番号で指定できるようにする</span>
    <span class="n">gs</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">GridSpec</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_gridspec</span><span class="p">(</span><span class="mi">20</span><span class="o">+</span><span class="mi">4</span><span class="p">,</span> <span class="mi">20</span><span class="o">+</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">Subplot</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[:</span><span class="mi">21</span><span class="p">,:],</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">rf</span><span class="s1">&#39;$</span><span class="si">{</span><span class="n">orbit_name</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1">_</span><span class="se">{{</span><span class="si">{</span><span class="n">PolyInt</span><span class="o">.</span><span class="n">multipole_notation</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="si">}</span><span class="se">}}</span><span class="s1">$&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_zlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="s2">&quot;z&quot;</span><span class="p">)</span>
    <span class="n">axcolor</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;silver&#39;</span>
    <span class="c1"># グラフの下の方に4段のスライダーを設置する</span>
    <span class="n">AXS</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">plt</span><span class="o">.</span><span class="n">Subplot</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">AXS</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">21</span><span class="p">,</span> <span class="mi">9</span><span class="p">:</span><span class="mi">14</span><span class="p">],</span> <span class="n">facecolor</span><span class="o">=</span><span class="n">axcolor</span><span class="p">))</span>
    <span class="n">AXS</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">22</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span><span class="mi">20</span><span class="p">],</span> <span class="n">facecolor</span><span class="o">=</span><span class="n">axcolor</span><span class="p">))</span>
    <span class="n">AXS</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">23</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span><span class="mi">20</span><span class="p">],</span> <span class="n">facecolor</span><span class="o">=</span><span class="n">axcolor</span><span class="p">))</span>
    <span class="n">AXS</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span><span class="mi">20</span><span class="p">],</span> <span class="n">facecolor</span><span class="o">=</span><span class="n">axcolor</span><span class="p">))</span> <span class="c1"># あとで不可視化するのでどこに置いてもいい</span>

    <span class="n">mode</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1"># initial mode is real-form representation</span>
    <span class="n">l_min</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
    
    <span class="c1"># 初期値で曲面を描画</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">paramed_sph_harm</span><span class="p">(</span><span class="n">l_min</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">mode</span><span class="p">)</span>
    <span class="c1"># 曲面の描画(ここは適宜カスタマイズする)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot_surface</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">facecolors</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
    <span class="c1"># ax.plot_wireframe(X, Y, Z, color=&quot;skyblue&quot;, linewidth=0.5)</span>

    <span class="c1"># Slider(ax=plotするAxis, label=ラベル, valmin=sliderの最小値, valmax=sliderの最大値, </span>
    <span class="c1">###      valinit=sliderの初期値, valstep=sliderのstep値, </span>
    <span class="c1">###      slidermin=Sliderオブジェクト:あるSliderオブジェクトのvalをこのSliderが取れる値の下限とする,</span>
    <span class="c1">###      slidermax=Sliderオブジェクト:あるSliderオブジェクトのvalをこのSliderが取れる値の上限とする)</span>
    <span class="n">SLIDERS</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Slider</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">SLIDERS</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Slider</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">AXS</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;XYZ/Abs/Re/Im&#39;</span><span class="p">,</span> <span class="n">valmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">valmax</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">valinit</span><span class="o">=</span><span class="n">mode</span><span class="p">,</span> <span class="n">valstep</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">SLIDERS</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Slider</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">AXS</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;l&#39;</span><span class="p">,</span> <span class="n">valmin</span><span class="o">=</span><span class="n">l_min</span><span class="p">,</span> <span class="n">valmax</span><span class="o">=</span><span class="n">l_max</span><span class="p">,</span> <span class="n">valinit</span><span class="o">=</span><span class="n">l_min</span><span class="p">,</span> <span class="n">valstep</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">SLIDERS</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Slider</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">AXS</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="n">valmin</span><span class="o">=-</span><span class="n">l_max</span><span class="p">,</span> <span class="n">valmax</span><span class="o">=</span><span class="n">l_max</span><span class="p">,</span> <span class="n">valinit</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">valstep</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">slidermin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">slidermax</span><span class="o">=</span><span class="kc">None</span><span class="p">))</span>
    <span class="n">SLIDERS</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Slider</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">AXS</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;-l&#39;</span><span class="p">,</span> <span class="n">valmin</span><span class="o">=-</span><span class="n">l_max</span><span class="p">,</span> <span class="n">valmax</span><span class="o">=-</span><span class="n">l_min</span><span class="p">,</span> <span class="n">valinit</span><span class="o">=-</span><span class="n">l_min</span><span class="p">,</span> <span class="n">valstep</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span> <span class="c1"># -l &lt;= m &lt;= l に制限する用</span>
    
    <span class="c1"># mの値の上限をl,下限を-lにする</span>
    <span class="n">SLIDERS</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">slidermax</span> <span class="o">=</span> <span class="n">SLIDERS</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">SLIDERS</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">slidermin</span> <span class="o">=</span> <span class="n">SLIDERS</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
    
    <span class="c1"># AXS[3]のSliderは，裏でmの値を制御するために使うだけなので不可視化する</span>
    <span class="n">AXS</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="n">val</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># .valはSliderで新たにセットされた値を表す</span>
        <span class="n">mode_next</span><span class="p">,</span> <span class="n">l_next</span><span class="p">,</span> <span class="n">m_next</span> <span class="o">=</span> <span class="n">SLIDERS</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">val</span><span class="p">,</span> <span class="n">SLIDERS</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">val</span><span class="p">,</span> <span class="n">SLIDERS</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">val</span>
        <span class="n">SLIDERS</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">val</span> <span class="o">=</span> <span class="o">-</span><span class="n">l_next</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span> <span class="c1"># 前回の結果を削除</span>
        <span class="n">X_next</span><span class="p">,</span> <span class="n">Y_next</span><span class="p">,</span> <span class="n">Z_next</span><span class="p">,</span> <span class="n">color_next</span> <span class="o">=</span> <span class="n">paramed_sph_harm</span><span class="p">(</span><span class="n">l_next</span><span class="p">,</span> <span class="n">m_next</span><span class="p">,</span> <span class="n">mode_next</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot_surface</span><span class="p">(</span><span class="n">X_next</span><span class="p">,</span> <span class="n">Y_next</span><span class="p">,</span> <span class="n">Z_next</span><span class="p">,</span> <span class="n">facecolors</span><span class="o">=</span><span class="n">color_next</span><span class="p">)</span>
        <span class="c1"># ax.plot_wireframe(X_next, Y_next, Z_next, color=color_next, linewidth=0.5)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_zlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="s2">&quot;z&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">mode_next</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">rf</span><span class="s1">&#39;$</span><span class="si">{</span><span class="n">orbit_name</span><span class="p">[</span><span class="n">l_next</span><span class="p">]</span><span class="si">}</span><span class="s1">_</span><span class="se">{{</span><span class="si">{</span><span class="n">PolyInt</span><span class="o">.</span><span class="n">multipole_notation</span><span class="p">(</span><span class="n">l_next</span><span class="p">,</span><span class="n">m_next</span><span class="p">)</span><span class="si">}</span><span class="se">}}</span><span class="s1">$&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">mode_next</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">rf</span><span class="s1">&#39;spherical harmonics $|Y_</span><span class="si">{</span><span class="n">l_next</span><span class="si">}</span><span class="s1">^</span><span class="se">{{</span><span class="si">{</span><span class="n">m_next</span><span class="si">}</span><span class="se">}}</span><span class="s1">(\theta, \phi)|$&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">mode_next</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">rf</span><span class="s1">&#39;spherical harmonics $|\mathrm</span><span class="se">{{</span><span class="s1">Re</span><span class="se">}}</span><span class="s1">Y_</span><span class="si">{</span><span class="n">l_next</span><span class="si">}</span><span class="s1">^</span><span class="se">{{</span><span class="si">{</span><span class="n">m_next</span><span class="si">}</span><span class="se">}}</span><span class="s1">(\theta, \phi)|$&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">mode_next</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">rf</span><span class="s1">&#39;spherical harmonics $|\mathrm</span><span class="se">{{</span><span class="s1">Im</span><span class="se">}}</span><span class="s1">Y_</span><span class="si">{</span><span class="n">l_next</span><span class="si">}</span><span class="s1">^</span><span class="se">{{</span><span class="si">{</span><span class="n">m_next</span><span class="si">}</span><span class="se">}}</span><span class="s1">(\theta, \phi)|$&#39;</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw_idle</span><span class="p">()</span> <span class="c1"># ここで描画を一旦ストップ</span>

    <span class="c1"># 設定したSliderを.on_changed(update)でactivate</span>
    <span class="n">SLIDERS</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">on_changed</span><span class="p">(</span><span class="n">update</span><span class="p">)</span>
    <span class="n">SLIDERS</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">on_changed</span><span class="p">(</span><span class="n">update</span><span class="p">)</span>
    <span class="n">SLIDERS</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">on_changed</span><span class="p">(</span><span class="n">update</span><span class="p">)</span>
    
    <span class="c1"># リセットボタンの設置</span>
    <span class="c1"># 押されたら初期化</span>
    <span class="n">resetax</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">Axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">([</span><span class="mf">0.85</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">])</span>
    <span class="n">button</span><span class="p">:</span> <span class="n">Button</span> <span class="o">=</span> <span class="n">Button</span><span class="p">(</span><span class="n">resetax</span><span class="p">,</span> <span class="s1">&#39;Reset&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">axcolor</span><span class="p">,</span> <span class="n">hovercolor</span><span class="o">=</span><span class="s1">&#39;0.975&#39;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">reset</span><span class="p">(</span><span class="n">event</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
            <span class="n">SLIDERS</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
    <span class="n">button</span><span class="o">.</span><span class="n">on_clicked</span><span class="p">(</span><span class="n">reset</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>


<div class="viewcode-block" id="CubicHarmonics"><a class="viewcode-back" href="../../../../cpystal.mathematics.algebra.html#cpystal.mathematics.algebra.core.CubicHarmonics">[docs]</a><span class="k">class</span> <span class="nc">CubicHarmonics</span><span class="p">(</span><span class="n">PolyInt</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Cubic harmonics.</span>

<span class="sd">    References:</span>
<span class="sd">        S. Hayami, M. Yatsushiro, Y. Yanagi, and H. Kusunose, Phys. Rev. B 98, 165110 (2018).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">P</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span> <span class="o">=</span> <span class="p">[]):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>

<div class="viewcode-block" id="CubicHarmonics.Ou"><a class="viewcode-back" href="../../../../cpystal.mathematics.algebra.html#cpystal.mathematics.algebra.core.CubicHarmonics.Ou">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">Ou</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">z</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Q_{u}.</span>

<span class="sd">        Note:</span>
<span class="sd">            irreducible representation: E_{g}^{+}</span>
<span class="sd">            definition: 1/2 (3z^2-r^2)</span>

<span class="sd">        Args:</span>
<span class="sd">            x (float): Value of x.</span>
<span class="sd">            y (float): Value of y.</span>
<span class="sd">            z (float): Value of z.</span>

<span class="sd">        Returns:</span>
<span class="sd">            float: Q_{u}(x,y,z).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">tesseral_harmonics</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">)(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="CubicHarmonics.Ov"><a class="viewcode-back" href="../../../../cpystal.mathematics.algebra.html#cpystal.mathematics.algebra.core.CubicHarmonics.Ov">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">Ov</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">z</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Q_{v}.</span>

<span class="sd">        Note:</span>
<span class="sd">            irreducible representation: E_{g}^{+}</span>
<span class="sd">            definition: \sqrt(3)/2 (x^2-y^2)</span>

<span class="sd">        Args:</span>
<span class="sd">            x (float): Value of x.</span>
<span class="sd">            y (float): Value of y.</span>
<span class="sd">            z (float): Value of z.</span>

<span class="sd">        Returns:</span>
<span class="sd">            float: Q_{v}(x,y,z).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">tesseral_harmonics</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="CubicHarmonics.Oyz"><a class="viewcode-back" href="../../../../cpystal.mathematics.algebra.html#cpystal.mathematics.algebra.core.CubicHarmonics.Oyz">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">Oyz</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">z</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Q_{yz}.</span>

<span class="sd">        Note:</span>
<span class="sd">            irreducible representation: T_{2g}^{+}</span>
<span class="sd">            definition: \sqrt(3) y z</span>

<span class="sd">        Args:</span>
<span class="sd">            x (float): Value of x.</span>
<span class="sd">            y (float): Value of y.</span>
<span class="sd">            z (float): Value of z.</span>

<span class="sd">        Returns:</span>
<span class="sd">            float: Q_{yz}(x,y,z).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">tesseral_harmonics</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="CubicHarmonics.Ozx"><a class="viewcode-back" href="../../../../cpystal.mathematics.algebra.html#cpystal.mathematics.algebra.core.CubicHarmonics.Ozx">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">Ozx</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">z</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Q_{zx}.</span>

<span class="sd">        Note:</span>
<span class="sd">            irreducible representation: T_{2g}^{+}</span>
<span class="sd">            definition: \sqrt(3) z x</span>

<span class="sd">        Args:</span>
<span class="sd">            x (float): Value of x.</span>
<span class="sd">            y (float): Value of y.</span>
<span class="sd">            z (float): Value of z.</span>

<span class="sd">        Returns:</span>
<span class="sd">            float: Q_{zx}(x,y,z).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">tesseral_harmonics</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="CubicHarmonics.Oxy"><a class="viewcode-back" href="../../../../cpystal.mathematics.algebra.html#cpystal.mathematics.algebra.core.CubicHarmonics.Oxy">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">Oxy</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">z</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Q_{xy}.</span>

<span class="sd">        Note:</span>
<span class="sd">            irreducible representation: T_{2g}^{+}</span>
<span class="sd">            definition: \sqrt(3) x y</span>

<span class="sd">        Args:</span>
<span class="sd">            x (float): Value of x.</span>
<span class="sd">            y (float): Value of y.</span>
<span class="sd">            z (float): Value of z.</span>

<span class="sd">        Returns:</span>
<span class="sd">            float: Q_{xy}(x,y,z).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">tesseral_harmonics</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">)(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">)</span></div>

<div class="viewcode-block" id="CubicHarmonics.O4"><a class="viewcode-back" href="../../../../cpystal.mathematics.algebra.html#cpystal.mathematics.algebra.core.CubicHarmonics.O4">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">O4</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">z</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Q_{4}.</span>

<span class="sd">        Note:</span>
<span class="sd">            irreducible representation: A_{1g}^{+}</span>
<span class="sd">            definition: 5\sqrt(21)/12 (x^4 + y^4 + z^4 - 3/5 r^4)</span>

<span class="sd">        Args:</span>
<span class="sd">            x (float): Value of x.</span>
<span class="sd">            y (float): Value of y.</span>
<span class="sd">            z (float): Value of z.</span>

<span class="sd">        Returns:</span>
<span class="sd">            float: Q_{4}(x,y,z).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">O40</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">tesseral_harmonics</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">)(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">)</span>
        <span class="n">O44</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">tesseral_harmonics</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">)(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">7</span><span class="o">/</span><span class="mi">12</span><span class="p">)</span> <span class="o">*</span> <span class="n">O40</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">5</span><span class="o">/</span><span class="mi">12</span><span class="p">)</span> <span class="o">*</span> <span class="n">O44</span></div>
    
<div class="viewcode-block" id="CubicHarmonics.O4u"><a class="viewcode-back" href="../../../../cpystal.mathematics.algebra.html#cpystal.mathematics.algebra.core.CubicHarmonics.O4u">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">O4u</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">z</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Q_{4u}.</span>

<span class="sd">        Note:</span>
<span class="sd">            irreducible representation: E_{g}^{+}</span>
<span class="sd">            definition: 7\sqrt(15)/6 (z^4 - 1/2 (x^4 + y^4) - 3/7 r^2 (3z^2 - r^2))</span>

<span class="sd">        Args:</span>
<span class="sd">            x (float): Value of x.</span>
<span class="sd">            y (float): Value of y.</span>
<span class="sd">            z (float): Value of z.</span>

<span class="sd">        Returns:</span>
<span class="sd">            float: Q_{4u}(x,y,z).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">O40</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">tesseral_harmonics</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">)(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">)</span>
        <span class="n">O44</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">tesseral_harmonics</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">)(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">5</span><span class="o">/</span><span class="mi">12</span><span class="p">)</span> <span class="o">*</span> <span class="n">O40</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">7</span><span class="o">/</span><span class="mi">12</span><span class="p">)</span> <span class="o">*</span> <span class="n">O44</span></div>
    
<div class="viewcode-block" id="CubicHarmonics.O4v"><a class="viewcode-back" href="../../../../cpystal.mathematics.algebra.html#cpystal.mathematics.algebra.core.CubicHarmonics.O4v">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">O4v</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">z</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Q_{4v}.</span>

<span class="sd">        Note:</span>
<span class="sd">            irreducible representation: E_{g}^{+}</span>
<span class="sd">            definition: 7\sqrt(5)/4 (x^4 - y^4 - 6/7 r^2 (x^2 - y^2))</span>

<span class="sd">        Args:</span>
<span class="sd">            x (float): Value of x.</span>
<span class="sd">            y (float): Value of y.</span>
<span class="sd">            z (float): Value of z.</span>

<span class="sd">        Returns:</span>
<span class="sd">            float: Q_{4v}(x,y,z).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">O42</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">tesseral_harmonics</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">)(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">)</span>
        <span class="k">return</span> <span class="o">-</span><span class="n">O42</span></div>
    
<div class="viewcode-block" id="CubicHarmonics.O4xa"><a class="viewcode-back" href="../../../../cpystal.mathematics.algebra.html#cpystal.mathematics.algebra.core.CubicHarmonics.O4xa">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">O4xa</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">z</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Q_{4x}^{\alpha}.</span>

<span class="sd">        Note:</span>
<span class="sd">            irreducible representation: T_{1g}^{+}</span>
<span class="sd">            definition: \sqrt(35)/2 y z (y^2 - z^2)</span>

<span class="sd">        Args:</span>
<span class="sd">            x (float): Value of x.</span>
<span class="sd">            y (float): Value of y.</span>
<span class="sd">            z (float): Value of z.</span>

<span class="sd">        Returns:</span>
<span class="sd">            float: Q_{4x}^{\alpha}(x,y,z).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">O4m1</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">tesseral_harmonics</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">)</span>
        <span class="n">O4m3</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">tesseral_harmonics</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">)(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">)</span>
        <span class="k">return</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">8</span><span class="p">)</span> <span class="o">*</span> <span class="n">O4m3</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">7</span><span class="o">/</span><span class="mi">8</span><span class="p">)</span> <span class="o">*</span> <span class="n">O4m1</span></div>
    
<div class="viewcode-block" id="CubicHarmonics.O4ya"><a class="viewcode-back" href="../../../../cpystal.mathematics.algebra.html#cpystal.mathematics.algebra.core.CubicHarmonics.O4ya">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">O4ya</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">z</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Q_{4y}^{\alpha}.</span>

<span class="sd">        Note:</span>
<span class="sd">            irreducible representation: T_{1g}^{+}</span>
<span class="sd">            definition: \sqrt(35)/2 z x (z^2 - x^2)</span>

<span class="sd">        Args:</span>
<span class="sd">            x (float): Value of x.</span>
<span class="sd">            y (float): Value of y.</span>
<span class="sd">            z (float): Value of z.</span>

<span class="sd">        Returns:</span>
<span class="sd">            float: Q_{4y}^{\alpha}(x,y,z).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">O41</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">tesseral_harmonics</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">)(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">)</span>
        <span class="n">O43</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">tesseral_harmonics</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">)(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">)</span>
        <span class="k">return</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">8</span><span class="p">)</span> <span class="o">*</span> <span class="n">O43</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">7</span><span class="o">/</span><span class="mi">8</span><span class="p">)</span> <span class="o">*</span> <span class="n">O41</span></div>
    
<div class="viewcode-block" id="CubicHarmonics.O4za"><a class="viewcode-back" href="../../../../cpystal.mathematics.algebra.html#cpystal.mathematics.algebra.core.CubicHarmonics.O4za">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">O4za</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">z</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Q_{4z}^{\alpha}.</span>

<span class="sd">        Note:</span>
<span class="sd">            irreducible representation: T_{1g}^{+}</span>
<span class="sd">            definition: \sqrt(35)/2 x y (x^2 - y^2)</span>

<span class="sd">        Args:</span>
<span class="sd">            x (float): Value of x.</span>
<span class="sd">            y (float): Value of y.</span>
<span class="sd">            z (float): Value of z.</span>

<span class="sd">        Returns:</span>
<span class="sd">            float: Q_{4z}^{\alpha}(x,y,z).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">tesseral_harmonics</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="o">-</span><span class="mi">4</span><span class="p">)(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="CubicHarmonics.O4xb"><a class="viewcode-back" href="../../../../cpystal.mathematics.algebra.html#cpystal.mathematics.algebra.core.CubicHarmonics.O4xb">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">O4xb</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">z</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Q_{4x}^{\beta}.</span>

<span class="sd">        Note:</span>
<span class="sd">            irreducible representation: T_{2g}^{+}</span>
<span class="sd">            definition: \sqrt(5)/2 y z (7x^2 - r^2)</span>

<span class="sd">        Args:</span>
<span class="sd">            x (float): Value of x.</span>
<span class="sd">            y (float): Value of y.</span>
<span class="sd">            z (float): Value of z.</span>

<span class="sd">        Returns:</span>
<span class="sd">            float: Q_{4x}^{\beta}(x,y,z).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">O4m1</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">tesseral_harmonics</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">)</span>
        <span class="n">O4m3</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">tesseral_harmonics</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">)(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">)</span>
        <span class="k">return</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">8</span><span class="p">)</span> <span class="o">*</span> <span class="n">O4m1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">7</span><span class="o">/</span><span class="mi">8</span><span class="p">)</span> <span class="o">*</span> <span class="n">O4m3</span></div>
    
<div class="viewcode-block" id="CubicHarmonics.O4yb"><a class="viewcode-back" href="../../../../cpystal.mathematics.algebra.html#cpystal.mathematics.algebra.core.CubicHarmonics.O4yb">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">O4yb</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">z</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Q_{4y}^{\beta}.</span>

<span class="sd">        Note:</span>
<span class="sd">            irreducible representation: T_{2g}^{+}</span>
<span class="sd">            definition: \sqrt(5)/2 z x (7y^2 - r^2)</span>

<span class="sd">        Args:</span>
<span class="sd">            x (float): Value of x.</span>
<span class="sd">            y (float): Value of y.</span>
<span class="sd">            z (float): Value of z.</span>

<span class="sd">        Returns:</span>
<span class="sd">            float: Q_{4y}^{\beta}(x,y,z).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">O41</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">tesseral_harmonics</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">)(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">)</span>
        <span class="n">O43</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">tesseral_harmonics</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">)(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">)</span>
        <span class="k">return</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">8</span><span class="p">)</span> <span class="o">*</span> <span class="n">O41</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">7</span><span class="o">/</span><span class="mi">8</span><span class="p">)</span> <span class="o">*</span> <span class="n">O43</span></div>
    
<div class="viewcode-block" id="CubicHarmonics.O4zb"><a class="viewcode-back" href="../../../../cpystal.mathematics.algebra.html#cpystal.mathematics.algebra.core.CubicHarmonics.O4zb">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">O4zb</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">z</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Q_{4z}^{\beta}.</span>

<span class="sd">        Note:</span>
<span class="sd">            irreducible representation: T_{2g}^{+}</span>
<span class="sd">            definition: \sqrt(5)/2 x y (7z^2 - r^2)</span>

<span class="sd">        Args:</span>
<span class="sd">            x (float): Value of x.</span>
<span class="sd">            y (float): Value of y.</span>
<span class="sd">            z (float): Value of z.</span>

<span class="sd">        Returns:</span>
<span class="sd">            float: Q_{4z}^{\beta}(x,y,z).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">tesseral_harmonics</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">)(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">)</span></div>

<div class="viewcode-block" id="CubicHarmonics.O6"><a class="viewcode-back" href="../../../../cpystal.mathematics.algebra.html#cpystal.mathematics.algebra.core.CubicHarmonics.O6">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">O6</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">z</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Q_{6}.</span>

<span class="sd">        Note:</span>
<span class="sd">            irreducible representation: A_{1g}^{+}</span>
<span class="sd">            definition: 231\sqrt(2)/8 (x^2 y^2 z^2 + 1/22 r^2(x^4 + y^4 + z^4 - 3/5 r^4) - 1/105 r^6)</span>

<span class="sd">        Args:</span>
<span class="sd">            x (float): Value of x.</span>
<span class="sd">            y (float): Value of y.</span>
<span class="sd">            z (float): Value of z.</span>

<span class="sd">        Returns:</span>
<span class="sd">            float: Q_{6}(x,y,z).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">O60</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">tesseral_harmonics</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">0</span><span class="p">)(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">)</span>
        <span class="n">O64</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">tesseral_harmonics</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">4</span><span class="p">)(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">8</span><span class="p">)</span> <span class="o">*</span> <span class="n">O60</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">7</span><span class="o">/</span><span class="mi">8</span><span class="p">)</span> <span class="o">*</span> <span class="n">O64</span></div>

<div class="viewcode-block" id="CubicHarmonics.O6t"><a class="viewcode-back" href="../../../../cpystal.mathematics.algebra.html#cpystal.mathematics.algebra.core.CubicHarmonics.O6t">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">O6t</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">z</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Q_{6t}.</span>

<span class="sd">        Note:</span>
<span class="sd">            irreducible representation: A_{2g}^{+}</span>
<span class="sd">            definition: \sqrt(2310)/8 (x^4 (y^2 - z^2) + y^4 (z^2 - x^2) +z^4 (x^2 - y^2))</span>

<span class="sd">        Args:</span>
<span class="sd">            x (float): Value of x.</span>
<span class="sd">            y (float): Value of y.</span>
<span class="sd">            z (float): Value of z.</span>

<span class="sd">        Returns:</span>
<span class="sd">            float: Q_{6t}(x,y,z).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">O66</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">tesseral_harmonics</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">)(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">)</span>
        <span class="n">O62</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">tesseral_harmonics</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">2</span><span class="p">)(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">)</span>
        <span class="k">return</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">5</span><span class="o">/</span><span class="mi">16</span><span class="p">)</span> <span class="o">*</span> <span class="n">O66</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">11</span><span class="o">/</span><span class="mi">16</span><span class="p">)</span> <span class="o">*</span> <span class="n">O62</span></div>

<div class="viewcode-block" id="CubicHarmonics.O6u"><a class="viewcode-back" href="../../../../cpystal.mathematics.algebra.html#cpystal.mathematics.algebra.core.CubicHarmonics.O6u">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">O6u</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">z</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Q_{6u}.</span>

<span class="sd">        Note:</span>
<span class="sd">            irreducible representation: E_{g}^{+}</span>
<span class="sd">            definition: 11\sqrt(14)/4 (z^6 - 1/2 (x^6 + y^6) - 15/11 r^2 (z^4 - 1/2 (x^4 + y^4)) + 5/22 r^4 (3z^2 - r^2))</span>

<span class="sd">        Args:</span>
<span class="sd">            x (float): Value of x.</span>
<span class="sd">            y (float): Value of y.</span>
<span class="sd">            z (float): Value of z.</span>

<span class="sd">        Returns:</span>
<span class="sd">            float: Q_{6u}(x,y,z).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">O64</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">tesseral_harmonics</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">4</span><span class="p">)(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">)</span>
        <span class="n">O60</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">tesseral_harmonics</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">0</span><span class="p">)(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">7</span><span class="o">/</span><span class="mi">8</span><span class="p">)</span> <span class="o">*</span> <span class="n">O60</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">8</span><span class="p">)</span> <span class="o">*</span> <span class="n">O64</span></div>

<div class="viewcode-block" id="CubicHarmonics.O6v"><a class="viewcode-back" href="../../../../cpystal.mathematics.algebra.html#cpystal.mathematics.algebra.core.CubicHarmonics.O6v">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">O6v</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">z</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Q_{6v}.</span>

<span class="sd">        Note:</span>
<span class="sd">            irreducible representation: E_{g}^{+}</span>
<span class="sd">            definition: 11\sqrt(42)/8 (x^6 - y^6 - 15/11 r^2 (x^4-y^4) + 5/11 r^4 (x^2 - y^2))</span>

<span class="sd">        Args:</span>
<span class="sd">            x (float): Value of x.</span>
<span class="sd">            y (float): Value of y.</span>
<span class="sd">            z (float): Value of z.</span>

<span class="sd">        Returns:</span>
<span class="sd">            float: Q_{6v}(x,y,z).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">O66</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">tesseral_harmonics</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">)(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">)</span>
        <span class="n">O62</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">tesseral_harmonics</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">2</span><span class="p">)(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">11</span><span class="o">/</span><span class="mi">16</span><span class="p">)</span> <span class="o">*</span> <span class="n">O66</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">5</span><span class="o">/</span><span class="mi">16</span><span class="p">)</span> <span class="o">*</span> <span class="n">O62</span></div>
    
<div class="viewcode-block" id="CubicHarmonics.O6xa"><a class="viewcode-back" href="../../../../cpystal.mathematics.algebra.html#cpystal.mathematics.algebra.core.CubicHarmonics.O6xa">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">O6xa</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">z</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Q_{6x}^{\alpha}.</span>

<span class="sd">        Note:</span>
<span class="sd">            irreducible representation: T_{1g}^{+}</span>
<span class="sd">            definition: 3\sqrt(7)/4 y z (y^2 - z^2) (11x^2 - r^2)</span>

<span class="sd">        Args:</span>
<span class="sd">            x (float): Value of x.</span>
<span class="sd">            y (float): Value of y.</span>
<span class="sd">            z (float): Value of z.</span>

<span class="sd">        Returns:</span>
<span class="sd">            float: Q_{6x}^{\alpha}(x,y,z).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">O6m5</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">tesseral_harmonics</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">)(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">)</span>
        <span class="n">O6m3</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">tesseral_harmonics</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">)(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">)</span>
        <span class="n">O6m1</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">tesseral_harmonics</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">)</span>
        <span class="k">return</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">22</span><span class="o">/</span><span class="mi">64</span><span class="p">)</span> <span class="o">*</span> <span class="n">O6m5</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">30</span><span class="o">/</span><span class="mi">64</span><span class="p">)</span> <span class="o">*</span> <span class="n">O6m3</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">12</span><span class="o">/</span><span class="mi">64</span><span class="p">)</span> <span class="o">*</span> <span class="n">O6m1</span></div>

<div class="viewcode-block" id="CubicHarmonics.O6ya"><a class="viewcode-back" href="../../../../cpystal.mathematics.algebra.html#cpystal.mathematics.algebra.core.CubicHarmonics.O6ya">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">O6ya</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">z</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Q_{6y}^{\alpha}.</span>

<span class="sd">        Note:</span>
<span class="sd">            irreducible representation: T_{1g}^{+}</span>
<span class="sd">            definition: 3\sqrt(7)/4 z x (z^2 - x^2) (11y^2 - r^2)</span>

<span class="sd">        Args:</span>
<span class="sd">            x (float): Value of x.</span>
<span class="sd">            y (float): Value of y.</span>
<span class="sd">            z (float): Value of z.</span>

<span class="sd">        Returns:</span>
<span class="sd">            float: Q_{6y}^{\alpha}(x,y,z).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">O65</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">tesseral_harmonics</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">5</span><span class="p">)(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">)</span>
        <span class="n">O63</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">tesseral_harmonics</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">3</span><span class="p">)(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">)</span>
        <span class="n">O61</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">tesseral_harmonics</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">1</span><span class="p">)(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">22</span><span class="o">/</span><span class="mi">64</span><span class="p">)</span> <span class="o">*</span> <span class="n">O65</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">30</span><span class="o">/</span><span class="mi">64</span><span class="p">)</span> <span class="o">*</span> <span class="n">O63</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">12</span><span class="o">/</span><span class="mi">64</span><span class="p">)</span> <span class="o">*</span> <span class="n">O61</span></div>
    
<div class="viewcode-block" id="CubicHarmonics.O6za"><a class="viewcode-back" href="../../../../cpystal.mathematics.algebra.html#cpystal.mathematics.algebra.core.CubicHarmonics.O6za">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">O6za</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">z</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Q_{6z}^{\alpha}.</span>

<span class="sd">        Note:</span>
<span class="sd">            irreducible representation: T_{1g}^{+}</span>
<span class="sd">            definition: 3\sqrt(7)/4 x y (x^2 - y^2) (11z^2 - r^2)</span>

<span class="sd">        Args:</span>
<span class="sd">            x (float): Value of x.</span>
<span class="sd">            y (float): Value of y.</span>
<span class="sd">            z (float): Value of z.</span>

<span class="sd">        Returns:</span>
<span class="sd">            float: Q_{6z}^{\alpha}(x,y,z).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">tesseral_harmonics</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="o">-</span><span class="mi">4</span><span class="p">)(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">)</span></div>

<div class="viewcode-block" id="CubicHarmonics.O6xb1"><a class="viewcode-back" href="../../../../cpystal.mathematics.algebra.html#cpystal.mathematics.algebra.core.CubicHarmonics.O6xb1">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">O6xb1</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">z</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Q_{6x}^{\beta 1}.</span>

<span class="sd">        Note:</span>
<span class="sd">            irreducible representation: T_{2g}^{+}</span>
<span class="sd">            definition: \sqrt(462)/2 y z (y^4 + z^4 - 5/8 (y^2 + z^2)^2)</span>

<span class="sd">        Args:</span>
<span class="sd">            x (float): Value of x.</span>
<span class="sd">            y (float): Value of y.</span>
<span class="sd">            z (float): Value of z.</span>

<span class="sd">        Returns:</span>
<span class="sd">            float: Q_{6x}^{\beta 1}(x,y,z).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">O6m5</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">tesseral_harmonics</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">)(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">)</span>
        <span class="n">O6m3</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">tesseral_harmonics</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">)(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">)</span>
        <span class="n">O6m1</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">tesseral_harmonics</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="o">/</span><span class="mi">256</span><span class="p">)</span> <span class="o">*</span> <span class="n">O6m5</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">55</span><span class="o">/</span><span class="mi">256</span><span class="p">)</span> <span class="o">*</span> <span class="n">O6m3</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">198</span><span class="o">/</span><span class="mi">256</span><span class="p">)</span> <span class="o">*</span> <span class="n">O6m1</span></div>

<div class="viewcode-block" id="CubicHarmonics.O6yb1"><a class="viewcode-back" href="../../../../cpystal.mathematics.algebra.html#cpystal.mathematics.algebra.core.CubicHarmonics.O6yb1">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">O6yb1</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">z</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Q_{6y}^{\beta 1}.</span>

<span class="sd">        Note:</span>
<span class="sd">            irreducible representation: T_{2g}^{+}</span>
<span class="sd">            definition: \sqrt(462)/2 z x (z^4 + x^4 - 5/8 (z^2 + x^2)^2)</span>

<span class="sd">        Args:</span>
<span class="sd">            x (float): Value of x.</span>
<span class="sd">            y (float): Value of y.</span>
<span class="sd">            z (float): Value of z.</span>

<span class="sd">        Returns:</span>
<span class="sd">            float: Q_{6y}^{\beta 1}(x,y,z).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">O65</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">tesseral_harmonics</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">5</span><span class="p">)(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">)</span>
        <span class="n">O63</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">tesseral_harmonics</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">3</span><span class="p">)(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">)</span>
        <span class="n">O61</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">tesseral_harmonics</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">1</span><span class="p">)(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="o">/</span><span class="mi">256</span><span class="p">)</span> <span class="o">*</span> <span class="n">O65</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">55</span><span class="o">/</span><span class="mi">256</span><span class="p">)</span> <span class="o">*</span> <span class="n">O63</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">198</span><span class="o">/</span><span class="mi">256</span><span class="p">)</span> <span class="o">*</span> <span class="n">O61</span></div>
    
<div class="viewcode-block" id="CubicHarmonics.O6zb1"><a class="viewcode-back" href="../../../../cpystal.mathematics.algebra.html#cpystal.mathematics.algebra.core.CubicHarmonics.O6zb1">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">O6zb1</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">z</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Q_{6z}^{\beta 1}.</span>

<span class="sd">        Note:</span>
<span class="sd">            irreducible representation: T_{2g}^{+}</span>
<span class="sd">            definition: \sqrt(462)/2 x y (x^4 + y^4 - 5/8 (x^2 + y^2)^2)</span>

<span class="sd">        Args:</span>
<span class="sd">            x (float): Value of x.</span>
<span class="sd">            y (float): Value of y.</span>
<span class="sd">            z (float): Value of z.</span>

<span class="sd">        Returns:</span>
<span class="sd">            float: Q_{6z}^{\beta 1}(x,y,z).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">tesseral_harmonics</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="o">-</span><span class="mi">6</span><span class="p">)(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">)</span></div>

<div class="viewcode-block" id="CubicHarmonics.O6xb2"><a class="viewcode-back" href="../../../../cpystal.mathematics.algebra.html#cpystal.mathematics.algebra.core.CubicHarmonics.O6xb2">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">O6xb2</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">z</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Q_{6x}^{\beta 2}.</span>

<span class="sd">        Note:</span>
<span class="sd">            irreducible representation: T_{2g}^{+}</span>
<span class="sd">            definition: \sqrt(210)/16 y z (33 x^4 - 18 x^2 r^2 + r^4)</span>

<span class="sd">        Args:</span>
<span class="sd">            x (float): Value of x.</span>
<span class="sd">            y (float): Value of y.</span>
<span class="sd">            z (float): Value of z.</span>

<span class="sd">        Returns:</span>
<span class="sd">            float: Q_{6x}^{\beta 2}(x,y,z).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">O6m5</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">tesseral_harmonics</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">)(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">)</span>
        <span class="n">O6m3</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">tesseral_harmonics</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">)(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">)</span>
        <span class="n">O6m1</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">tesseral_harmonics</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">165</span><span class="o">/</span><span class="mi">256</span><span class="p">)</span> <span class="o">*</span> <span class="n">O6m5</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">81</span><span class="o">/</span><span class="mi">256</span><span class="p">)</span> <span class="o">*</span> <span class="n">O6m3</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">10</span><span class="o">/</span><span class="mi">256</span><span class="p">)</span> <span class="o">*</span> <span class="n">O6m1</span></div>

<div class="viewcode-block" id="CubicHarmonics.O6yb2"><a class="viewcode-back" href="../../../../cpystal.mathematics.algebra.html#cpystal.mathematics.algebra.core.CubicHarmonics.O6yb2">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">O6yb2</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">z</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Q_{6y}^{\beta 2}.</span>

<span class="sd">        Note:</span>
<span class="sd">            irreducible representation: T_{2g}^{+}</span>
<span class="sd">            definition: \sqrt(210)/16 z x (33 y^4 - 18 y^2 r^2 + r^4)</span>

<span class="sd">        Args:</span>
<span class="sd">            x (float): Value of x.</span>
<span class="sd">            y (float): Value of y.</span>
<span class="sd">            z (float): Value of z.</span>

<span class="sd">        Returns:</span>
<span class="sd">            float: Q_{6y}^{\beta 2}(x,y,z).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">O65</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">tesseral_harmonics</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">5</span><span class="p">)(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">)</span>
        <span class="n">O63</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">tesseral_harmonics</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">3</span><span class="p">)(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">)</span>
        <span class="n">O61</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">tesseral_harmonics</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">1</span><span class="p">)(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">165</span><span class="o">/</span><span class="mi">256</span><span class="p">)</span> <span class="o">*</span> <span class="n">O65</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">81</span><span class="o">/</span><span class="mi">256</span><span class="p">)</span> <span class="o">*</span> <span class="n">O63</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">10</span><span class="o">/</span><span class="mi">256</span><span class="p">)</span> <span class="o">*</span> <span class="n">O61</span></div>
    
<div class="viewcode-block" id="CubicHarmonics.O6zb2"><a class="viewcode-back" href="../../../../cpystal.mathematics.algebra.html#cpystal.mathematics.algebra.core.CubicHarmonics.O6zb2">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">O6zb2</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">z</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Q_{6z}^{\beta 2}.</span>

<span class="sd">        Note:</span>
<span class="sd">            irreducible representation: T_{2g}^{+}</span>
<span class="sd">            definition: \sqrt(210)/16 x y (33 z^4 - 18 z^2 r^2 + r^4)</span>

<span class="sd">        Args:</span>
<span class="sd">            x (float): Value of x.</span>
<span class="sd">            y (float): Value of y.</span>
<span class="sd">            z (float): Value of z.</span>

<span class="sd">        Returns:</span>
<span class="sd">            float: Q_{6z}^{\beta 2}(x,y,z).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">tesseral_harmonics</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">)(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="CubicHarmonics.visualize"><a class="viewcode-back" href="../../../../cpystal.mathematics.algebra.html#cpystal.mathematics.algebra.core.CubicHarmonics.visualize">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">visualize</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">def</span> <span class="nf">paramed_cubic_harm</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">,</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">,</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">,</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">]:</span>
            <span class="n">n</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">512</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="n">theta</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
            <span class="n">phi</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
            <span class="n">theta</span><span class="p">,</span> <span class="n">phi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">phi</span><span class="p">)</span>

            <span class="n">x</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>
            <span class="n">y</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>
            <span class="n">z</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
            <span class="n">u</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">name</span><span class="p">)(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">)</span>
            <span class="n">x</span> <span class="o">*=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
            <span class="n">y</span> <span class="o">*=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
            <span class="n">z</span> <span class="o">*=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>

            <span class="n">plus_minus</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
            <span class="n">color</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">theta</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">str</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
                    <span class="k">if</span> <span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">color</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">plus_minus</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">color</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">plus_minus</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">color</span>
        
        <span class="n">fig</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">Figure</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
        <span class="c1"># 領域を小区画に分けて番号で指定できるようにする</span>
        <span class="n">gs</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">GridSpec</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_gridspec</span><span class="p">(</span><span class="mi">20</span><span class="o">+</span><span class="mi">4</span><span class="p">,</span> <span class="mi">20</span><span class="o">+</span><span class="mi">4</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">Subplot</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[:</span><span class="mi">21</span><span class="p">,:],</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
        <span class="c1"># ax.set_title(rf&#39;${orbit_name[0]}_{{{PolyInt.multipole_notation(0, 0)}}}$&#39;)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_zlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="s2">&quot;z&quot;</span><span class="p">)</span>
        
        <span class="c1"># 初期値で曲面を描画</span>
        <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">paramed_cubic_harm</span><span class="p">()</span>
        <span class="c1"># 曲面の描画(ここは適宜カスタマイズする)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot_surface</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">facecolors</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
        <span class="c1"># ax.plot_wireframe(X, Y, Z, color=&quot;skyblue&quot;, linewidth=0.5)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div></div>


<span class="c1"># class ClebschGordan(object):</span>
<span class="c1">#     def __init__(self) -&gt; None:</span>
<span class="c1">#         pass</span>
<span class="c1">#     def cg_coeff(</span>
<span class="c1">#         j1: float,</span>
<span class="c1">#         m1: float,</span>
<span class="c1">#         j2: float,</span>
<span class="c1">#         m2: float,</span>
<span class="c1">#         j3: float,</span>
<span class="c1">#         m3: float</span>
<span class="c1">#     ) -&gt; float:</span>
<span class="c1">#         pass</span>
<span class="c1">#         return</span>


<div class="viewcode-block" id="main"><a class="viewcode-back" href="../../../../cpystal.mathematics.algebra.html#cpystal.mathematics.algebra.core.main">[docs]</a><span class="k">def</span> <span class="nf">main</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="k">pass</span>
    <span class="n">CubicHarmonics</span><span class="o">.</span><span class="n">visualize</span><span class="p">(</span><span class="s2">&quot;O4za&quot;</span><span class="p">)</span>

    <span class="k">return</span></div>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>

</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Helve.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>